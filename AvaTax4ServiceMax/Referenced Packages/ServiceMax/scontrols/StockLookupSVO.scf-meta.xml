<?xml version="1.0" encoding="UTF-8"?>
<Scontrol xmlns="http://soap.sforce.com/2006/04/metadata">
    <contentSource>HTML</contentSource>
    <encodingKey>UTF-8</encodingKey>
    <fileContent>Lyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBTdG9jayBMb29rdXAgUm91dGluZXMgICA9PT09PT09PT09PSovDQp2YXIgU0xLUF9Qcm9kdWN0SWQ7DQp2YXIgU0xLUF9SZXFRdHk7DQp2YXIgU0xLUF9SZWNvcmRUeXBlOw0KdmFyIFNMS1BfUmVjb3JkSWQ7DQp2YXIgU0xLUF9Vc2VySWQ7DQp2YXIgU0xLUF9nZW9jb2RlcjsNCnZhciBTTEtQX21hcDsNCnZhciBTTEtQX2RpcmVjdGlvbnNQYW5lbDsNCnZhciBTTEtQX2RpcmVjdGlvbnM7DQp2YXIgU0xLUF9Zb3VBcmVIZXJlOw0KdmFyIFNMS1BfcmFkaXVzID0gMDsNCnZhciBTTEtQX1N0YXJ0aW5nUG9pbnQ7DQp2YXIgU0xLUF9TaG93UmVzdWx0czsNCnZhciBTTEtQX1Nob3dNYXA7DQp2YXIgU0xLUF9TaG93T3B0aW9uczsNCnZhciBHTUxLUF9MYXQxOyANCnZhciBHTUxLUF9Mb24xOyANCnZhciBHTUxLUF9nZW9jb2RlcjsgDQp2YXIgU0xLUF9yb3dudW07DQp2YXIgcmVjRm91bmQ9IiI7IA0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBDYW5jZWwgUGFydHMgUmVxdWVzdCA9PT09PT09PT09PSovDQp2YXIgQ05QUl9SZXF1ZXN0SWQ7DQp2YXIgQ05QUl9Vc2VySWQ7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgQ2FuY2VsIFNoaXBtZW50IE9yZGVyID09PT09PT09PT09Ki8NCnZhciBDTlNIUF9TaGlwbWVudE9yZGVySWQ7DQp2YXIgQ05TSFBfVXNlcklkOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENyZWF0ZSBTaGlwbWVudCBPcmRlciBmcm9tIFBhcnRzIFJlcXVlc3QgPT09PT09PT09PT0qLw0KdmFyIFNIUFJfUmVxdWVzdElkOw0KdmFyIFNIUFJfVXNlcklkOw0KdmFyIFNIUFJfU2hpcG1lbnRPcmRlcklkOw0KdmFyIFNIUFJfUmVxdWVzdGVkRnJvbUlkOw0KdmFyIFNIUFJfUmVxdWlyZWRBdElkOw0KdmFyIFNIUFJfQ29tcGFueUlkOw0KdmFyIFNIUFJfT3duZXJJZDsNCnZhciBTSFBSX0FkZGxJbmZvOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENyZWF0ZSBTaGlwbWVudCBPcmRlciBmcm9tIFNWTyA9PT09PT09PT09PSovDQp2YXIgU0hTVk9fU1ZPSWQ7DQp2YXIgU0hTVk9fVXNlcklkOw0KdmFyIFNIU1ZPX0NvbXBhbnlJZDsNCnZhciBTSFNWT19DYXNlSWQ7DQp2YXIgU0hTVk9fQ29udGFjdElkOw0KdmFyIFNIU1ZPX1JlcXVpcmVkQXRJZDsNCnZhciBTSFNWT19Pd25lcklkOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENhbmNlbCBTVk8gUGFydHMgUmVxdWVzdCA9PT09PT09PT09PSovDQp2YXIgQ05TVk9QUl9TVk9JZDsNCnZhciBDTlNWT1BSX1VzZXJJZDsNCnZhciBDTlNWT1BSX1NWT0xpbmVJZDsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFBhcnRzIFJlcXVlc3QgUmVjZWlwdHMgPT09PT09PT09PT0qLw0KdmFyIFBQUlJfUmVxdWVzdElkOw0KdmFyIFBQUlJfVXNlcklkOw0KdmFyIFBQUlJfU2l0ZUlkOw0KdmFyIFBQUlJfUmVjZWlwdHM7DQp2YXIgUFBSUl9QUk51bWJlcjsNCnZhciBQUFJSX1Nlc3Npb25JZDsNCnZhciBQUFJSX1N1cHBsaWVySWQ7DQp2YXIgUFBSUl9Tb3VyY2VMb2NJZDsJCS8vIEhTIDA0LzI4LzIwMDgNCnZhciBQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZTsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFNWTyBSZWNlaXB0cyA9PT09PT09PT09PSovDQp2YXIgUFJTVk9fU1ZPSWQ7DQp2YXIgUFJTVk9fVXNlcklkOw0KdmFyIFBSU1ZPX1NWT0xpbmVJZDsNCnZhciBQUlNWT19SZXFSZWNvcmRUeXBlSWQ7DQp2YXIgUFJTVk9fUmVjZWlwdHM7DQp2YXIgUFJTVk9fU1ZPTnVtYmVyOw0KdmFyIFBSU1ZPX1Nlc3Npb25JZDsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFNoaXBtZW50cyA9PT09PT09PT09PSovDQp2YXIgUFJTSFBfU2hpcG1lbnRPcmRlcklkOw0KdmFyIFBSU0hQX1VzZXJJZDsNCnZhciBQUlNIUF9TaGlwbWVudHM7DQp2YXIgUFJTSFBfU2hpcG1lbnROdW1iZXI7DQp2YXIgUFJTSFBfU2Vzc2lvbklkOw0KdmFyIFBSU0hQX1NvdXJjZUxvY0lkOw0KdmFyIFBSU0hQX0Rlc3RMb2NJZDsNCnZhciBQUlNIUF9EZXN0TG9jU3RvY2thYmxlOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IFBvc3QgU3RvY2sgQWRqdXN0bWVudCB0byBJbnZlbnRvcnkgPT09PT09PT09PT0qLw0KdmFyIEFESklOVl9BZGp1c3RtZW50SWQ7DQp2YXIgQURKSU5WX0Fkak51bWJlcjsNCnZhciBBREpJTlZfVXNlcklkOw0KdmFyIEFESklOVl9TZXNzaW9uSWQ7DQp2YXIgQURKSU5WX1Byb2RJZDsNCnZhciBBREpJTlZfQWRqUXR5Ow0KdmFyIEFESklOVl9TaXRlSWQ7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgUG9zdCBTVk8gVXNhZ2UgdG8gSW52ZW50b3J5ID09PT09PT09PT09Ki8NCnZhciBTVk9VU0dJTlZfU1ZPSWQ7DQp2YXIgU1ZPVVNHSU5WX1VzZXJJZDsNCnZhciBTVk9VU0dJTlZfU1ZPTGluZUlkOw0KdmFyIFNWT1VTR0lOVl9TZXNzaW9uSWQ7DQp2YXIgU1ZPVVNHSU5WX1NWT051bWJlcjsNCnZhciBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IFBvc3QgU3RvY2sgVHJhbnNmZXIgdG8gSW52ZW50b3J5ID09PT09PT09PT09Ki8NCnZhciBYRlJJTlZfWGZlcklkOw0KdmFyIFhGUklOVl9Vc2VySWQ7DQp2YXIgWEZSSU5WX1Nlc3Npb25JZDsNCnZhciBYRlJJTlZfWGZlck51bWJlcjsNCnZhciBYRlJJTlZfU291cmNlTG9jSWQ7DQp2YXIgWEZSSU5WX0Rlc3RMb2NJZDsNCnZhciBYRlJJTlZfWGZlclJlY29yZHM7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgUHJvY2VzcyBSTUEgUmVjZWlwdHMgPT09PT09PT09PT0qLw0KdmFyIFBSUk1BX1JNQUlkOw0KdmFyIFBSUk1BX1VzZXJJZDsNCnZhciBQUlJNQV9STUFMaW5lSWQ7DQp2YXIgUFJSTUFfUk1BTnVtYmVyOw0KdmFyIFBSUk1BX1Nlc3Npb25JZDsNCnZhciBQUlJNQV9SZWNlaXB0czsNCnZhciBQUlJNQV9SZWNvcmRUeXBlSWQ7DQp2YXIgUFJSTUFfU291cmNlTG9jSWQ7DQp2YXIgUFJSTUFfRGVzdExvY0lkOw0KdmFyIFBSUk1BX0Rlc3RDb3N0ZWRBdFZhbHVlOw0KdmFyIFBSUk1BX1NvdXJjZVN0b2NrYWJsZTsNCnZhciBQUlJNQV9EZXN0U3RvY2thYmxlOw0KDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KDQpmdW5jdGlvbiBTVk1YQ19TZXR1cFN0b2NrTG9va3VwUGFnZShyZXFJZCwgcmVxVHlwZSwgdUlkKQ0Kew0KCVNWTVhJX0luaXRNZXNzYWdlTGlzdCgiU0xLUFNDMSIpOyANCglTVk1YSV9TZXRMYWJlbHMoIlN0b2NrTG9va3VwUFIiKTsgDQoNCiAgICB2YXIgUHJvZE5hbWU7DQoNCiAgICBTTEtQX1VzZXJJZCA9IHVJZDsNCiAgICBTTEtQX1JlY29yZFR5cGUgPSByZXFUeXBlOw0KDQogICAgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnU1ZPJykNCiAgICAJew0KCXZhciBzb3FsMSA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYywgIiArDQoJCSAgICAiU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgV0hFUkUgSWQgPSAnIiArIHJlcUlkICsgIiciOw0KCXZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQoJaWYgKHFyMS5zaXplIDw9IDApDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCglyZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQoJU0xLUF9Qcm9kdWN0SWQgPSByZWMxWzBdLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2ROYW1lID0gcmVjMVswXS5TVk1YQ19fUHJvZHVjdF9fYyA/IHJlYzFbMF0uU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIjsNCglTTEtQX1JlcVF0eSA9IHJlYzFbMF0uU1ZNWENfX1JlcXVlc3RlZF9RdWFudGl0eTJfX2M7DQoJU0xLUF9SZWNvcmRJZCA9IHJlYzFbMF0uSWQ7DQoJU0xLUF9TaXRlSWQgPSByZWMxWzBdLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2M7DQoJaWYgKFNMS1BfU2l0ZUlkID09IG51bGwpDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl9DQogICAgZWxzZSBpZiAocmVxVHlwZSA9PSAnUFInKQ0KICAgIAl7DQoJdmFyIHNvcWwyID0gIlNFTEVDVCBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19RdWFudGl0eV9SZXF1aXJlZDJfX2MsICIgKw0KCQkgICAgIlNWTVhDX19QYXJ0c19SZXF1ZXN0X19yLlNWTVhDX19SZXF1aXJlZF9BdF9Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgV0hFUkUgSWQgPSAnIiArIHJlcUlkICsgIiciOw0KCXZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQoJaWYgKHFyMi5zaXplIDw9IDApDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCglyZWMyID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQoJU0xLUF9Qcm9kdWN0SWQgPSByZWMyWzBdLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2ROYW1lID0gcmVjMlswXS5TVk1YQ19fUHJvZHVjdF9fYyA/IHJlYzJbMF0uU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIjsNCglTTEtQX1JlcVF0eSA9IHJlYzJbMF0uU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYzsNCglTTEtQX1JlY29yZElkID0gcmVjMlswXS5TVk1YQ19fUGFydHNfUmVxdWVzdF9fYzsNCglTTEtQX1NpdGVJZCA9IHJlYzJbMF0uU1ZNWENfX1BhcnRzX1JlcXVlc3RfX3IuU1ZNWENfX1JlcXVpcmVkX0F0X0xvY2F0aW9uX19jOw0KCX0NCiAgICBlbHNlDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJQcm9kTmFtZSIpLmlubmVySFRNTCA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpICsgUHJvZE5hbWU7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJlcVF0eSIpLmlubmVySFRNTCA9ICAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikrIHBhcnNlRmxvYXQoU0xLUF9SZXFRdHkpOy8vIlJlcXVpcmVkIFF1YW50aXR5OiAiDQoNCiAgICB2YXIgc29xbDMgPSAiU0VMRUNUIFNWTVhDX19TdHJlZXRfX2MsIFNWTVhDX19DaXR5X19jLCBTVk1YQ19fU3RhdGVfX2MsIFNWTVhDX19aaXBfX2MsIFNWTVhDX19Db3VudHJ5X19jICIgKw0KICAgIAkJIkZST00gU1ZNWENfX1NpdGVfX2MgV0hFUkUgSWQgPSAnIiArIFNMS1BfU2l0ZUlkICsgIiciOw0KICAgIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICBpZiAocXIzLnNpemUgPD0gMCkNCgl7DQoJU0xLUF9Zb3VBcmVIZXJlID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1Iik7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVzZXJBZGRyZXNzIikuaW5uZXJIVE1MID0gIjxzdHJvbmc+IitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSsiPC8+IiAgDQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJhZGl1cyIpLmRpc2FibGVkID0gdHJ1ZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTEFCMDIwIikuZGlzYWJsZWQgPSB0cnVlOw0KCX0NCiAgICBlbHNlDQoJew0KCXJlYzMgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KCWlmIChyZWMzWzBdLlNWTVhDX19TdHJlZXRfX2MpIHZhciBteVN0cmVldCA9IHJlYzNbMF0uU1ZNWENfX1N0cmVldF9fYzsNCgllbHNlIHZhciBteVN0cmVldCA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX0NpdHlfX2MpIHZhciBteUNpdHkgPSByZWMzWzBdLlNWTVhDX19DaXR5X19jOw0KCWVsc2UgdmFyIG15Q2l0eSA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX1N0YXRlX19jKSB2YXIgbXlTdGF0ZSA9IHJlYzNbMF0uU1ZNWENfX1N0YXRlX19jOw0KCWVsc2UgdmFyIG15U3RhdGUgPSAiIjsNCg0KCWlmIChyZWMzWzBdLlNWTVhDX19aaXBfX2MpIHZhciBteVppcCA9IHJlYzNbMF0uU1ZNWENfX1ppcF9fYzsNCgllbHNlIHZhciBteVppcCA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX0NvdW50cnlfX2MpIHZhciBteUNvdW50cnkgPSByZWMzWzBdLlNWTVhDX19Db3VudHJ5X19jOw0KCWVsc2UgdmFyIG15Q291bnRyeSA9ICIiOw0KDQoJU0xLUF9Zb3VBcmVIZXJlID0gbXlTdHJlZXQgKyAiICIgKyBteUNpdHkgKyAiICIgKyBteVN0YXRlICsgIiAiICsgbXlaaXAgKyAiICIgKyBteUNvdW50cnk7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVzZXJBZGRyZXNzIikuaW5uZXJIVE1MID0gbXlTdHJlZXQgKyAiPGJyPiIgKyBteUNpdHkgKyAiICIgKyBteVN0YXRlICsgIiAiICsgbXlaaXAgKyAiPGJyPiIgKyBteUNvdW50cnk7DQoJfQ0KICAgIFNWTVhJX1Nob3dNYXAoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Db21wdXRlRGlzdGFuY2UocG9pbnQpIA0Kew0KICAgIGlmICghU0xLUF9TdGFydGluZ1BvaW50KSB7IHJldHVybiAwOyB9DQogICAgdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOyAgDQogICAgdmFyIHJhd0Rpc3RhbmNlID0gU0xLUF9TdGFydGluZ1BvaW50LmRpc3RhbmNlRnJvbShwb2ludCk7DQogICAgdmFyIGtpbG9tZXRlcnMgPSByYXdEaXN0YW5jZS8xMDAwOw0KICAgIHZhciBtaWxlcyA9IGtpbG9tZXRlcnMgKiAwLjYyMTM3MTE5MjsNCiAgICBpZiAodW5pdHMgPT0gIk1pbGVzIikgeyByZXR1cm4gTWF0aC5yb3VuZChtaWxlcyk7IH0NCiAgICBlbHNlIHsgcmV0dXJuIChNYXRoLnJvdW5kKGtpbG9tZXRlcnMpKTsgfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8gDQovLyBUaGlzIGZ1bmN0aW9uIHVzZXMgdGhlIGhhdmVyc2luZSAoaGFsZi12ZXJzZWQtc2luZSkgbWV0aG9kIHRvIGNhbGN1bGF0ZSANCi8vIGRpc3RhbmNlIGJldHdlZW4gdHdvICdwb2ludHMnIA0KZnVuY3Rpb24gU1ZNWElfQ2FsY3VsYXRlRGlzdGFuY2UobGF0MSwgbG9uMSwgbGF0MiwgbG9uMiwgdW5pdHMpIA0KeyANCgl2YXIgUiA9IDYzNzE7IC8vIGttIA0KCS8vdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOw0KCXZhciBkTGF0ID0gKGxhdDItbGF0MSkgKiBNYXRoLlBJIC8gMTgwOyANCgl2YXIgZExvbiA9IChsb24yLWxvbjEpICogTWF0aC5QSSAvIDE4MDsgDQoJdmFyIGEgPSBNYXRoLnNpbihkTGF0LzIpICogTWF0aC5zaW4oZExhdC8yKSArIA0KCU1hdGguY29zKGxhdDEgKiBNYXRoLlBJIC8gMTgwKSAqIE1hdGguY29zKGxhdDIgKiBNYXRoLlBJIC8gMTgwKSAqIA0KCU1hdGguc2luKGRMb24vMikgKiBNYXRoLnNpbihkTG9uLzIpOyANCgl2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyANCgl2YXIgZGttID0gUiAqIGM7DQoJdmFyIGRtaWxlcyA9IGRrbSAqIDAuNjIxMzcxMTkyOyANCglpZiAodW5pdHMgPT0gIk1pbGVzIikNCgl7DQoJCXJldHVybiBNYXRoLnJvdW5kKGRtaWxlcyk7DQoJfQ0KCWVsc2Uge3JldHVybiBNYXRoLnJvdW5kKGRrbSk7fQ0KfSANCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX1Nob3dEaXJlY3Rpb25zKEZyb21BZGRyZXNzLCBUb0FkZHJlc3MpDQp7DQogICAgU0xLUF9kaXJlY3Rpb25zUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2Um91dGUiKTsgIA0KICAgIGlmICghU0xLUF9kaXJlY3Rpb25zKQ0KCVNMS1BfZGlyZWN0aW9ucyA9IG5ldyBHRGlyZWN0aW9ucyhTTEtQX21hcCwgU0xLUF9kaXJlY3Rpb25zUGFuZWwpOyAgDQogICAgZWxzZQ0KCVNMS1BfZGlyZWN0aW9ucy5jbGVhcigpOw0KICAgIFNMS1BfZGlyZWN0aW9ucy5sb2FkKEZyb21BZGRyZXNzICsgIiB0byAiICsgVG9BZGRyZXNzKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX1NldFJlcXVlc3RGcm9tTG9jYXRpb24oU2l0ZUlkLCBUYWcpDQp7DQogICAgdmFyIGFucyA9IGNvbmZpcm0oVGFnICsgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikpOw0KICAgIGlmICghYW5zKSB7IHJldHVybjsgfQ0KDQogICAgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnU1ZPJykNCiAgICAJew0KCQkJdmFyIGNPYmogPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCgkJCWNPYmouSWQgPSBTTEtQX1JlY29yZElkOw0KCQkJLy9jT2JqLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MgPSBTaXRlSWQ7DQoJCQljT2JqLlNWTVhDX19Gcm9tX0xvY2F0aW9uX19jPSBTaXRlSWQ7DQoJCQl0cnkgew0KCQkJICAgICAgICANCgkJCQkJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbY09ial0pOyAgICAgICAgICAgICAgICAgICAgICAgIA0KCQkJCQlpZiAocmV0WzBdLnN1Y2Nlc3MhPSd0cnVlJykNCgkJCQkJew0KCQkJCQkgICAgYWxlcnQoJ2ZhaWxlZCBmb3Igd2QnKTsNCgkJCQkJCWFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQoJCQkJCX0NCgkJCQkJZWxzZQ0KCQkJCQl7DQoJCQkJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTciKSk7DQoJCQkJCQl3aW5kb3cub3BlbmVyLmxvY2F0aW9uID0gIi8iICsgU0xLUF9SZWNvcmRJZDsNCgkJCQkJCUNsb3NlV2luZG93KCk7DQoJCQkJCX0NCgkJCSAgIH0NCiAgICAgICAgICAgICAgICBjYXRjaChlcnJvcikgew0KCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxOCIpKyJcbiIgKyAiMTIzIiArIGVycm9yKTsNCgkJCX0NCgkJfQ0KICAgIGVsc2UgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnUFInKQ0KICAgIAl7DQoJdmFyIGNPYmogPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X19jIik7DQoJY09iai5JZCA9IFNMS1BfUmVjb3JkSWQ7DQoJY09iai5TVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2MgPSBTaXRlSWQ7DQoJdHJ5IHsNCgkgICAgdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbY09ial0pOw0KCQkNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIwIikpOwkNCgkgICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbiA9ICIvIiArIFNMS1BfUmVjb3JkSWQ7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIH0NCgljYXRjaChlcnJvcikgew0KCQ0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTgiKSsiXG4iICsgIjQ1NiIrIGVycm9yKTsNCgkgICAgfQ0KCX0NCiAgICBlbHNlDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxOSIpKyJcbiIpOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZExvY2F0aW9uVG9NYXAoU3RvY2tSZWMsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBRdHlBdmxibCwgU2l0ZUlkLGN1cnJjbnQsdG90Y250KQ0Kew0KICAgIHZhciBhZGRfcm93X3RvX2dyaWQgPSB0cnVlOw0KICAgIHZhciBhZGRyID0gU3RyZWV0ICsgIiwgIiArIENpdHkgKyAiLCAiICsgU3RhdGUgKyAiICIgKyBaaXAgKyAiLCAiICsgQ291bnRyeTsNCiAgICB2YXIgRGlzdGFuY2UgPSAiVW5rbm93biI7DQoJDQoJLy9Db21tZW50ZWQgYnkgU3VtaXQgYW5kIE1hbmlzaCBkdWUgdG8gR29vZ2xlIE1hcCBBUEkgdXBkYXRpb24gZnJvbSB2MiB0byB2My4NCiAgIC8qIFNMS1BfZ2VvY29kZXIuZ2V0TGF0TG5nDQogICAgKGFkZHIsIA0KCWZ1bmN0aW9uKHBvaW50KQ0KCXsNCglpZiAocG9pbnQpDQoJICAgIHsNCgkJCURpc3RhbmNlID0gU1ZNWElfQ29tcHV0ZURpc3RhbmNlKHBvaW50KTsNCgkJCWlmIChEaXN0YW5jZSA8PSBTTEtQX3JhZGl1cyB8fCBTTEtQX3JhZGl1cyA9PSAwKQ0KCQkJew0KCQkJCXJlY0ZvdW5kID0iWUVTIjsNCgkJCQl2YXIgU3RvY2tUYWcgPSAiPGI+IiArIFNpdGVOYW1lICsgIjwvYj48YnI+IiArIA0KCQkJCQkJICBTdHJlZXQgKyAiPGJyPiIgKyBDaXR5ICsgIiwgIiArIFN0YXRlICsgIiAiICsgWmlwICsgIiwgIiArIENvdW50cnkgKyAiPGJyPiIgKyANCgkJCQkJCSAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikgKyBQaG9uZSArICI8YnI+IiArIA0KCQkJCQkJICAiPGI+ICIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikgKyBwYXJzZUZsb2F0KFN0b2NrUmVjLlNWTVhDX19RdWFudGl0eTJfX2MpICsgIjwvYj4iICsNCgkJCQkJCSAgIjxicj4iK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpOw0KDQoJCQkJdmFyIG15SWNvbiA9IG5ldyBHSWNvbihHX0RFRkFVTFRfSUNPTik7DQoJCQkJaWYgKHBhcnNlRmxvYXQoUXR5QXZsYmwpID49IHBhcnNlRmxvYXQoU0xLUF9SZXFRdHkpKSANCgkJCQkJew0KCQkJCQkJbXlJY29uLmltYWdlID0gImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMva21sL3BhbDIvaWNvbjUucG5nIjsgDQoJCQkJCX0NCgkJCQllbHNlIA0KCQkJCQl7DQoJCQkJCQlteUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsNC9pY29uNTMucG5nIjsgDQoJCQkJCX0NCg0KCQkJCW15SWNvbi5pY29uU2l6ZT1uZXcgR1NpemUoMzIsMzIpOw0KCQkJCW15SWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7DQoJCQkJbXlJY29uLmljb25BbmNob3I9bmV3IEdQb2ludCgxNiwzMik7DQoJCQkJbXlJY29uLmluZm9XaW5kb3dBbmNob3I9bmV3IEdQb2ludCgxNiwwKTsNCgkJCQltYXJrZXJPcHRpb25zMiA9IHsgaWNvbjpteUljb24gfTsNCgkJCQl2YXIgbWFya2VyID0gbmV3IEdNYXJrZXIocG9pbnQsIG1hcmtlck9wdGlvbnMyKTsNCgkJCQlTTEtQX21hcC5zZXRDZW50ZXIocG9pbnQsIDgpOw0KCQkJCVNMS1BfbWFwLmFkZE92ZXJsYXkobWFya2VyKTsNCgkJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU3RvY2tUYWcpOyB9KSA7DQoJCQkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3V0IiwgZnVuY3Rpb24oKSB7IG1hcmtlci5jbG9zZUluZm9XaW5kb3coKTsgfSkgOw0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJjbGljayIsIGZ1bmN0aW9uKCkgeyBTVk1YSV9TTEtQX1Nob3dEaXJlY3Rpb25zKFNMS1BfWW91QXJlSGVyZSwgYWRkcik7IH0pOw0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJkYmxjbGljayIsIGZ1bmN0aW9uKCkgeyBTVk1YSV9TTEtQX1NldFJlcXVlc3RGcm9tTG9jYXRpb24oU2l0ZUlkLCBTaXRlTmFtZSk7IH0pOw0KCQkJCVNWTVhJX1NMS1BfQWRkUmVzdWx0Um93KFN0b2NrUmVjLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgU2l0ZUlkLCBEaXN0YW5jZSk7DQoJCQl9DQoJCQllbHNlIGlmIChEaXN0YW5jZSA+IFNMS1BfcmFkaXVzKQ0KCQkJew0KCQkJCWlmKHBhcnNlSW50KGN1cnJjbnQpPT1wYXJzZUludCh0b3RjbnQpICYmIHJlY0ZvdW5kID09Ik5PIikNCgkJCQl7DQoJCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAyMiIpKTsNCgkJCQkJdHJ5ew0KCQkJCQkJdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCgkJCQkJCWNsZWFyX3RhYmxlKHRib2R5KTsNCgkJCQkJfWNhdGNoKGUpe30NCgkJCQl9DQoJCQl9DQoJICAgfQ0KCWVsc2UNCgkJew0KCSAgICBTVk1YSV9TTEtQX0FkZFJlc3VsdFJvdyhTdG9ja1JlYywgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFNpdGVJZCwgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIxIikpOyAgDQoJCX0NCiAgICAgfQ0KICAgICk7IA0KCSovDQoJDQoJU0xLUF9nZW9jb2Rlci5nZW9jb2RlKCB7J2FkZHJlc3MnOiBhZGRyIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykgew0KCQlpZiAoc3RhdHVzID09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7DQoJCQl2YXIgcG9pbnQgPSByZXN1bHRzLmdlb21ldHJ5LmxvY2F0aW9uOw0KCQkJaWYgKHBvaW50KQ0KCQkJew0KCQkJCWFsZXJ0KCdzdW1pdCcpOw0KCQkJCURpc3RhbmNlID0gU1ZNWElfQ29tcHV0ZURpc3RhbmNlKHBvaW50KTsNCgkJCQlpZiAoRGlzdGFuY2UgPD0gU0xLUF9yYWRpdXMgfHwgU0xLUF9yYWRpdXMgPT0gMCkNCgkJCQl7DQoJCQkJCXJlY0ZvdW5kID0iWUVTIjsNCgkJCQkJdmFyIFN0b2NrVGFnID0gIjxiPiIgKyBTaXRlTmFtZSArICI8L2I+PGJyPiIgKyANCgkJCQkJCSAgU3RyZWV0ICsgIjxicj4iICsgQ2l0eSArICIsICIgKyBTdGF0ZSArICIgIiArIFppcCArICIsICIgKyBDb3VudHJ5ICsgIjxicj4iICsgDQoJCQkJCQkgIFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMyIpICsgUGhvbmUgKyAiPGJyPiIgKyANCgkJCQkJCSAgIjxiPiAiK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNCIpICsgcGFyc2VGbG9hdChTdG9ja1JlYy5TVk1YQ19fUXVhbnRpdHkyX19jKSArICI8L2I+IiArDQoJCQkJCQkgICI8YnI+IitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKTsNCgkJCQkNCgkJCQkJdmFyIG15SWNvbiA9IHsNCgkJCQkJCXNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDMyLCAzMiksIA0KCQkJCQkJYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTYsIDMyKQ0KCQkJCQl9DQoJCQkJCQ0KCQkJCQlpZiAocGFyc2VGbG9hdChRdHlBdmxibCkgPj0gcGFyc2VGbG9hdChTTEtQX1JlcVF0eSkpIA0KCQkJCQl7DQoJCQkJCQlteUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMi9pY29uNS5wbmciOyANCgkJCQkJfQ0KCQkJCQllbHNlIA0KCQkJCQl7DQoJCQkJCQlteUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsNC9pY29uNTMucG5nIjsgDQoJCQkJCX0NCgkJCQkJbWFya2VyT3B0aW9uczIgPSB7IA0KCQkJCQkJbWFwOiBTTEtQX21hcCwNCgkJCQkJCWljb246IG15SWNvbiwgDQoJCQkJCQlwb3NpdGlvbjogcG9pbnQsIA0KCQkJCQkJc2hhZG93OiB7IHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDU2LCAzMil9CQ0KCQkJCQl9Ow0KCQkJCQl2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zMik7DQoJCQkJCVNMS1BfbWFwLnNldENlbnRlcihtYXJrZXIuUG9zaXRpb24pOw0KCQkJCQlTTEtQX21hcC5zZXRab29tKDgpDQoJCQkJCVNMS1BfbWFwLnBhblRvKHBvaW50KTsNCgkJCQkJdmFyIGluZm9fd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coU3RvY2tUYWcpOw0KCQkJCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW92ZXIiLCBmdW5jdGlvbigpIHsgaW5mb193aW5kb3cub3BlbihTTEtQX21hcCwgbWFya2VyKTsgfSkgOw0KCQkJCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW91dCIsIGZ1bmN0aW9uKCkgeyBpbmZvX3dpbmRvdy5jbG9zZSgpO30pIDsNCgkJCQkJZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAiY2xpY2siLCBmdW5jdGlvbigpIHsgU1ZNWElfU0xLUF9TaG93RGlyZWN0aW9ucyhTTEtQX1lvdUFyZUhlcmUsIGFkZHIpOyB9KTsNCgkJCQkJZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAiZGJsY2xpY2siLCBmdW5jdGlvbigpIHsgU1ZNWElfU0xLUF9TZXRSZXF1ZXN0RnJvbUxvY2F0aW9uKFNpdGVJZCwgU2l0ZU5hbWUpOyB9KTsNCgkJCQkJU1ZNWElfU0xLUF9BZGRSZXN1bHRSb3coU3RvY2tSZWMsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBTaXRlSWQsIERpc3RhbmNlKTsNCgkJCQl9DQoJCQkJZWxzZSBpZiAoRGlzdGFuY2UgPiBTTEtQX3JhZGl1cykNCgkJCQl7DQoJCQkJCWlmKHBhcnNlSW50KGN1cnJjbnQpPT1wYXJzZUludCh0b3RjbnQpICYmIHJlY0ZvdW5kID09Ik5PIikNCgkJCQkJew0KCQkJCQkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIyIikpOw0KCQkJCQkJdHJ5ew0KCQkJCQkJCXZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoJCQkJCQkJY2xlYXJfdGFibGUodGJvZHkpOw0KCQkJCQkJfWNhdGNoKGUpe30NCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQlTVk1YSV9TTEtQX0FkZFJlc3VsdFJvdyhTdG9ja1JlYywgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFNpdGVJZCwgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIxIikpOyAgDQoJCQl9DQoJCX0NCgl9KQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Nob3dNYXAoKSANCnsNCiAgICBpZiAod2luZG93LnNjcmVlbikNCiAgICB7DQoJd2luZG93Lm1vdmVUbygwLDApOw0KCXdpbmRvdy5yZXNpemVUbyhzY3JlZW4ud2lkdGgsIHNjcmVlbi5oZWlnaHQpOw0KICAgIH0NCgkNCgkvL0NvbW1lbnRlZCBieSBTdW1pdCBhbmQgTWFuaXNoIGR1ZSB0byBHb29nbGUgTWFwIEFQSSB1cGRhdGlvbiBmcm9tIHYyIHRvIHYzLg0KICAvKiAgU0xLUF9tYXAgPSBuZXcgR01hcDIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdk1hcCIpKTsNCiAgICBTTEtQX21hcC5hZGRDb250cm9sKG5ldyBHTGFyZ2VNYXBDb250cm9sKCkpOw0KICAgIFNMS1BfbWFwLmFkZENvbnRyb2wobmV3IEdNYXBUeXBlQ29udHJvbCgpKTsNCiAgICBTTEtQX21hcC5lbmFibGVTY3JvbGxXaGVlbFpvb20oKTsNCg0KICAgIFNMS1BfZ2VvY29kZXIgPSBuZXcgR0NsaWVudEdlb2NvZGVyKCk7DQogICAgaWYgKCFTTEtQX2dlb2NvZGVyKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCgl9DQogICBTTEtQX1N0YXJ0aW5nUG9pbnQgPSBuZXcgR0xhdExuZygpOw0KICAgU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50KCk7DQogICBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnRXaXRoTGF0TG9uZygpOw0KICAgKi8NCiAgIHZhciBtYXBPcHRpb25zID0gew0KCQl6b29tOiA4LA0KCQltYXBUeXBlQ29udHJvbDogdHJ1ZSwNCgkJbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUA0KCX0NCg0KCVNMS1BfbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2TWFwIiksIG1hcE9wdGlvbnMpOw0KCVNMS1BfZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTsgDQogICAgaWYgKCFTTEtQX2dlb2NvZGVyKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCgl9DQogICBTTEtQX1N0YXJ0aW5nUG9pbnQgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCk7DQogICBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnQoKTsNCiAgIFNWTVhJX1NMS1BfQWRkU3RhcnRpbmdQb2ludFdpdGhMYXRMb25nKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50KCkNCnsNCgkvL0NvbW1lbnRlZCBieSBTdW1pdCBhbmQgTWFuaXNoIGR1ZSB0byBHb29nbGUgTWFwIEFQSSB1cGRhdGlvbiBmcm9tIHYyIHRvIHYzLg0KICAgLyogaWYgKEdCcm93c2VySXNDb21wYXRpYmxlKCkpDQogICAgew0KCQlTTEtQX2dlb2NvZGVyLmdldExhdExuZw0KCQkoU0xLUF9Zb3VBcmVIZXJlLCANCgkJCWZ1bmN0aW9uKHBvaW50KQ0KCQkJew0KCQkJaWYgKHBvaW50KQ0KCQkJew0KCQkJU0xLUF9TdGFydGluZ1BvaW50ID0gcG9pbnQ7DQoJCQl2YXIgYmx1ZUljb24gPSBuZXcgR0ljb24oR19ERUZBVUxUX0lDT04pOw0KCQkJYmx1ZUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMy9pY29uMzgucG5nIjsNCgkJCWJsdWVJY29uLmljb25TaXplPW5ldyBHU2l6ZSgzMiwzMik7DQoJCQlibHVlSWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7DQoJCQlibHVlSWNvbi5pY29uQW5jaG9yPW5ldyBHUG9pbnQoMTYsMzIpOw0KCQkJYmx1ZUljb24uaW5mb1dpbmRvd0FuY2hvcj1uZXcgR1BvaW50KDE2LDApOw0KCQkJbWFya2VyT3B0aW9ucyA9IHsgaWNvbjpibHVlSWNvbiB9Ow0KCQkJdmFyIG1hcmtlciA9IG5ldyBHTWFya2VyKHBvaW50LCBtYXJrZXJPcHRpb25zKTsNCgkJCVNMS1BfbWFwLnNldENlbnRlcihwb2ludCwgOCk7DQoJCQlTTEtQX21hcC5hZGRPdmVybGF5KG1hcmtlcik7DQoJCQlTTEtQX21hcC5wYW5Ubyhwb2ludCk7DQoJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOyB9KSA7DQoJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgbWFya2VyLmNsb3NlSW5mb1dpbmRvdygpOyB9KSA7DQoJCQl9DQoJCQllbHNlDQoJCQl7DQoJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7DQoJCQlTVk1YSV9TTEtQX1Nob3dVbml0ZWRTdGF0ZXMoKTsNCgkJCX0NCgkJCX0NCgkJKTsNCiAgICB9DQovLwlTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnRXaXRoTGF0TG9uZygpOw0KCSovDQoJDQoJU0xLUF9nZW9jb2Rlci5nZW9jb2RlKCB7J2FkZHJlc3MnOiBTTEtQX1lvdUFyZUhlcmUgfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7DQoJCWlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHsNCgkJCXZhciBwb2ludCA9IHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb247CQkNCgkJCWlmIChwb2ludCkNCgkJCXsNCgkJCQlTTEtQX1N0YXJ0aW5nUG9pbnQgPSBwb2ludDsNCgkJCQl2YXIgYmx1ZUljb24gPSB7DQoJCQkJCQlzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgzMiwgMzIpLCANCgkJCQkJCWFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE2LCAzMiksDQoJCQkJCQl1cmw6ICJodHRwOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL2ttbC9wYWwzL2ljb24zOC5wbmciDQoJCQkJfQ0KCQkJCW1hcmtlck9wdGlvbnMgPSB7IA0KCQkJCQltYXA6IFNMS1BfbWFwLA0KCQkJCQlpY29uOiBibHVlSWNvbiwgDQoJCQkJCXBvc2l0aW9uOiBwb2ludCwgDQoJCQkJCXNoYWRvdzoge3NpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDU2LCAzMil9CQ0KCQkJCX07DQoJCQkJdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIobWFya2VyT3B0aW9ucyk7DQoJCQkJU0xLUF9tYXAuc2V0Q2VudGVyKG1hcmtlci5Qb3NpdGlvbik7DQoJCQkJU0xLUF9tYXAuc2V0Wm9vbSg4KQ0KCQkJCVNMS1BfbWFwLnBhblRvKHBvaW50KTsJCQkJDQoJCQkJdmFyIGluZm9fd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe2NvbnRlbnQ6IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpfSk7DQoJCQkJZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7aW5mb193aW5kb3cub3BlbihTTEtQX21hcCwgbWFya2VyKTt9KSA7DQoJCQkJZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHtpbmZvX3dpbmRvdy5jbG9zZSgpO30pIDsNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7DQoJCQkJU1ZNWElfU0xLUF9TaG93VW5pdGVkU3RhdGVzKCk7DQoJCQl9DQoJCX0NCgl9KQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NMS1BfU2hvd1VuaXRlZFN0YXRlcygpDQp7DQoJLy9Db21tZW50ZWQgYnkgU3VtaXQgYW5kIE1hbmlzaCBkdWUgdG8gR29vZ2xlIE1hcCBBUEkgdXBkYXRpb24gZnJvbSB2MiB0byB2My4NCiAgIC8qIFNMS1BfU3RhcnRpbmdQb2ludCA9IG5ldyBHTGF0TG5nKCk7DQogICANCglpZiAoR0Jyb3dzZXJJc0NvbXBhdGlibGUoKSkNCiAgICB7DQogICAgU0xLUF9nZW9jb2Rlci5nZXRMYXRMbmcNCgkoIlVuaXRlZCBTdGF0ZXMiLCANCgkgICAgZnVuY3Rpb24ocG9pbnQpDQoJICAgIHsNCgkgICAgaWYgKHBvaW50KQ0KCQl7DQoJCVNMS1BfU3RhcnRpbmdQb2ludCA9IHBvaW50Ow0KCQl2YXIgYmx1ZUljb24gPSBuZXcgR0ljb24oR19ERUZBVUxUX0lDT04pOw0KCQlibHVlSWNvbi5pbWFnZSA9ICJodHRwOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL2ttbC9wYWwzL2ljb24zOC5wbmciOw0KCQlibHVlSWNvbi5pY29uU2l6ZT1uZXcgR1NpemUoMzIsMzIpOw0KCQlibHVlSWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7DQoJCWJsdWVJY29uLmljb25BbmNob3I9bmV3IEdQb2ludCgxNiwzMik7DQoJCWJsdWVJY29uLmluZm9XaW5kb3dBbmNob3I9bmV3IEdQb2ludCgxNiwwKTsNCgkJbWFya2VyT3B0aW9ucyA9IHsgaWNvbjpibHVlSWNvbiB9Ow0KCQl2YXIgbWFya2VyID0gbmV3IEdNYXJrZXIocG9pbnQsIG1hcmtlck9wdGlvbnMpOw0KCQlTTEtQX21hcC5zZXRDZW50ZXIocG9pbnQsIDgpOw0KCQlTTEtQX21hcC5hZGRPdmVybGF5KG1hcmtlcik7DQoJCVNMS1BfbWFwLnBhblRvKHBvaW50KTsNCgkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIub3BlbkluZm9XaW5kb3dIdG1sKFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsgfSkgOw0KCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgbWFya2VyLmNsb3NlSW5mb1dpbmRvdygpOyB9KSA7DQoJCX0NCgkgICAgfQ0KCSk7DQogICAgfQ0KCSovDQoJDQoJU0xLUF9TdGFydGluZ1BvaW50ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZygwLDApOyANCglTTEtQX2dlb2NvZGVyLmdlb2NvZGUoIHsnYWRkcmVzcyc6ICJVbml0ZWQgU3RhdGVzIiB9LCBmdW5jdGlvbihyZXN1bHRzLCBzdGF0dXMpIHsNCgkJaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykgew0KCQkJdmFyIHBvaW50ID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbjsJCQ0KCQkJaWYgKHBvaW50KQ0KCQkJew0KCQkJCVNMS1BfU3RhcnRpbmdQb2ludCA9IHBvaW50Ow0KCQkJCXZhciBibHVlSWNvbiA9IHsNCgkJCQkJCXNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDMyLCAzMiksIA0KCQkJCQkJYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTYsIDMyKSwNCgkJCQkJCXVybDogImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMva21sL3BhbDMvaWNvbjM4LnBuZyINCgkJCQl9DQoJCQkJbWFya2VyT3B0aW9ucyA9IHsgDQoJCQkJCW1hcDogU0xLUF9tYXAsDQoJCQkJCWljb246IGJsdWVJY29uLCANCgkJCQkJcG9zaXRpb246IHBvaW50LCANCgkJCQkJc2hhZG93OiB7c2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoNTYsIDMyKX0JDQoJCQkJfTsNCgkJCQl2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTsNCgkJCQlTTEtQX21hcC5zZXRDZW50ZXIobWFya2VyLlBvc2l0aW9uKTsNCgkJCQlTTEtQX21hcC5zZXRab29tKDgpDQoJCQkJU0xLUF9tYXAucGFuVG8ocG9pbnQpOwkJCQkNCgkJCQl2YXIgaW5mb193aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7Y29udGVudDogU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIil9KTsNCgkJCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW92ZXIiLCBmdW5jdGlvbigpIHtpbmZvX3dpbmRvdy5vcGVuKFNMS1BfbWFwLCBtYXJrZXIpO30pIDsNCgkJCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW91dCIsIGZ1bmN0aW9uKCkge2luZm9fd2luZG93LmNsb3NlKCk7fSkgOw0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsNCgkJCQlTVk1YSV9TTEtQX1Nob3dVbml0ZWRTdGF0ZXMoKTsNCgkJCX0NCgkJfQ0KCX0pDQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLyANCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovIA0KZnVuY3Rpb24gU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50V2l0aExhdExvbmcoKSANCnsgDQoJLy9Db21tZW50ZWQgYnkgU3VtaXQgYW5kIE1hbmlzaCBkdWUgdG8gR29vZ2xlIE1hcCBBUEkgdXBkYXRpb24gZnJvbSB2MiB0byB2My4NCiAgIC8qCUdNTEtQX1N0YXJ0aW5nUG9pbnQgPSBuZXcgR0xhdExuZygpOyANCglHTUxLUF9nZW9jb2RlciA9IG5ldyBHQ2xpZW50R2VvY29kZXIoKTsgDQoJaWYgKCFHTUxLUF9nZW9jb2RlcikgDQoJeyANCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIzIikpOw0KCQkvL2FsZXJ0KCdVbmFibGUgdG8gbGF1bmNoIEdlb2NvZGVyIHRvIGNhbGN1bGF0ZSBjb29yZGluYXRlcy5QbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5zaXRyYXRvci4nKTsNCgkJLy8gU1ZNWERDX0Nsb3NlV2luZG93KCk7IA0KCQl3aW5kb3cuY2xvc2UoKTsgDQoJfSANCglpZiAoR0Jyb3dzZXJJc0NvbXBhdGlibGUoKSkgDQoJeyANCgkJR01MS1BfZ2VvY29kZXIuZ2V0TG9jYXRpb25zIA0KCQkoU0xLUF9Zb3VBcmVIZXJlLCANCgkJZnVuY3Rpb24ocmVzcG9uc2UpIA0KCQl7IA0KCQkJaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLlN0YXR1cy5jb2RlID09IDIwMCkgDQoJCQl7IA0KCQkJCXZhciBwbGFjZSA9IHJlc3BvbnNlLlBsYWNlbWFya1swXTsgDQoJCQkJdmFyIHBvaW50ID0gbmV3IEdMYXRMbmcocGxhY2UuUG9pbnQuY29vcmRpbmF0ZXNbMV0sIHBsYWNlLlBvaW50LmNvb3JkaW5hdGVzWzBdKTsgDQoJCQkJR01MS1BfTGF0MSA9IHBsYWNlLlBvaW50LmNvb3JkaW5hdGVzWzFdOyANCgkJCQlHTUxLUF9Mb24xID0gcGxhY2UuUG9pbnQuY29vcmRpbmF0ZXNbMF07IA0KDQovKgkJCQlHTUxLUF9TdGFydGluZ1BvaW50ID0gcG9pbnQ7IA0KCQkJCXZhciBibHVlSWNvbiA9IG5ldyBHSWNvbihHX0RFRkFVTFRfSUNPTik7IA0KCQkJCWJsdWVJY29uLmltYWdlID0gImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMva21sL3BhbDMvaWNvbjM4LnBuZyI7IA0KCQkJCWJsdWVJY29uLmljb25TaXplPW5ldyBHU2l6ZSgzMiwzMik7IA0KCQkJCWJsdWVJY29uLnNoYWRvd1NpemU9bmV3IEdTaXplKDU2LDMyKTsgDQoJCQkJYmx1ZUljb24uaWNvbkFuY2hvcj1uZXcgR1BvaW50KDE2LDMyKTsgDQoJCQkJYmx1ZUljb24uaW5mb1dpbmRvd0FuY2hvcj1uZXcgR1BvaW50KDE2LDApOyANCgkJCQltYXJrZXJPcHRpb25zID0geyBpY29uOmJsdWVJY29uIH07IA0KCQkJCXZhciBtYXJrZXIgPSBuZXcgR01hcmtlcihwb2ludCwgbWFya2VyT3B0aW9ucyk7IA0KCQkJCVNMS1BfbWFwLnNldENlbnRlcihwb2ludCwgOCk7IA0KCQkJCVNMS1BfbWFwLmFkZE92ZXJsYXkobWFya2VyKTsgDQoJCQkJU0xLUF9tYXAucGFuVG8ocG9pbnQpOyANCgkJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU0xLUF9Zb3VBcmVIZXJlKTsgfSkgOyANCgkJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgbWFya2VyLmNsb3NlSW5mb1dpbmRvdygpOyB9KSA7ICovDQoJCS8qCX0gDQoJCQllbHNlIA0KCQkJeyANCi8vCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsNCi8vCQkJCVNWTVhJX1NMS1BfU2hvd1VuaXRlZFN0YXRlcygpOw0KCQkJCW51bGw7DQoJCQl9IA0KCQl9IA0KCQkpOyANCgl9IA0KCSovDQoJDQoJR01MS1BfU3RhcnRpbmdQb2ludCA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMCwwKTsgDQoJR01MS1BfZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTsgDQoJaWYgKCFHTUxLUF9nZW9jb2RlcikgDQoJeyANCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIzIikpOw0KCQkvL2FsZXJ0KCdVbmFibGUgdG8gbGF1bmNoIEdlb2NvZGVyIHRvIGNhbGN1bGF0ZSBjb29yZGluYXRlcy5QbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5zaXRyYXRvci4nKTsNCgkJLy8gU1ZNWERDX0Nsb3NlV2luZG93KCk7IA0KCQl3aW5kb3cuY2xvc2UoKTsgDQoJfSANCgkJR01MS1BfZ2VvY29kZXIuZ2VvY29kZSggeyAnYWRkcmVzcyc6IFNMS1BfWW91QXJlSGVyZX0sCQkNCgkJZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKQ0KCQl7IA0KCQkJaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykgDQoJCQl7IA0KCQkJCUdNTEtQX0xhdDEgPSByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpOyANCgkJCQlHTUxLUF9Mb24xID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTsgDQoNCi8qCQkJCUdNTEtQX1N0YXJ0aW5nUG9pbnQgPSBwb2ludDsgDQoJCQkJdmFyIGJsdWVJY29uID0gbmV3IEdJY29uKEdfREVGQVVMVF9JQ09OKTsgDQoJCQkJYmx1ZUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMy9pY29uMzgucG5nIjsgDQoJCQkJYmx1ZUljb24uaWNvblNpemU9bmV3IEdTaXplKDMyLDMyKTsgDQoJCQkJYmx1ZUljb24uc2hhZG93U2l6ZT1uZXcgR1NpemUoNTYsMzIpOyANCgkJCQlibHVlSWNvbi5pY29uQW5jaG9yPW5ldyBHUG9pbnQoMTYsMzIpOyANCgkJCQlibHVlSWNvbi5pbmZvV2luZG93QW5jaG9yPW5ldyBHUG9pbnQoMTYsMCk7IA0KCQkJCW1hcmtlck9wdGlvbnMgPSB7IGljb246Ymx1ZUljb24gfTsgDQoJCQkJdmFyIG1hcmtlciA9IG5ldyBHTWFya2VyKHBvaW50LCBtYXJrZXJPcHRpb25zKTsgDQoJCQkJU0xLUF9tYXAuc2V0Q2VudGVyKHBvaW50LCA4KTsgDQoJCQkJU0xLUF9tYXAuYWRkT3ZlcmxheShtYXJrZXIpOyANCgkJCQlTTEtQX21hcC5wYW5Ubyhwb2ludCk7IA0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW92ZXIiLCBmdW5jdGlvbigpIHsgbWFya2VyLm9wZW5JbmZvV2luZG93SHRtbChTTEtQX1lvdUFyZUhlcmUpOyB9KSA7IA0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW91dCIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIuY2xvc2VJbmZvV2luZG93KCk7IH0pIDsgKi8NCgkJCX0gDQoJCQllbHNlIA0KCQkJeyANCi8vCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsNCi8vCQkJCVNWTVhJX1NMS1BfU2hvd1VuaXRlZFN0YXRlcygpOw0KCQkJCW51bGw7DQoJCQl9IA0KCQl9IA0KCQkpOyANCn0gDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX1NMS1BfRmluZFN0b2NrKCkNCnsNCiAgICB2YXIgU2l0ZU5hbWU7DQogICAgdmFyIFN0cmVldDsNCiAgICB2YXIgQ2l0eTsNCiAgICB2YXIgU3RhdGU7DQogICAgdmFyIFppcDsNCiAgICB2YXIgQ291bnRyeTsNCiAgICB2YXIgUGhvbmU7DQoJcmVjRm91bmQgPSJOTyI7DQogICAgU0xLUF9yYWRpdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiUmFkaXVzIikudmFsdWU7DQoNCi8qICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCwgU1ZNWENfX0xvY2F0aW9uX19jLCBTVk1YQ19fUXVhbnRpdHkyX19jLCBTVk1YQ19fTG9jYXRpb25fX3IuTmFtZSwgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdHJlZXRfX2MsICIgKw0KICAgIAkgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ2l0eV9fYywgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdGF0ZV9fYywgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19aaXBfX2MsICIgKw0KCSAgICAgICAiU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Db3VudHJ5X19jLCBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1NpdGVfUGhvbmVfX2MsICIgKw0KCSAgICAgICAiU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TZXJ2aWNlX0VuZ2luZWVyX19jIEZST00gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIiArDQogICAgCSAgICAgICAiV0hFUkUgU1ZNWENfX1Byb2R1Y3RfX2MgPSAnIiArIFNMS1BfUHJvZHVjdElkICsgIicgQU5EIFNWTVhDX19TdGF0dXNfX2MgPSAnQXZhaWxhYmxlJyBBTkQgU1ZNWENfX1F1YW50aXR5Ml9fYyA+IDAiOyovDQoJIHZhciBzb3FsID0gIlNFTEVDVCBJZCwgU1ZNWENfX0xvY2F0aW9uX19jLCBTVk1YQ19fUXVhbnRpdHkyX19jLCBTVk1YQ19fTG9jYXRpb25fX3IuTmFtZSwgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdHJlZXRfX2MsICIgKw0KICAgIAkgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ2l0eV9fYywgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdGF0ZV9fYywgICBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1ppcF9fYywgIiArDQoJICAgICAgICAgICAiU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Db3VudHJ5X19jLCBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1NpdGVfUGhvbmVfX2MsICIgKw0KCQkgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTG9uZ2l0dWRlX19jLCAiICsNCgkgICAgICAgICAgICJTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2MgRlJPTSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyAiICsNCiAgICAJICAgICAgICJXSEVSRSBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xhdGl0dWRlX19jIDw+IG51bGwgYW5kIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTG9uZ2l0dWRlX19jIDw+IG51bGwgYW5kIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyBTTEtQX1Byb2R1Y3RJZCArICInIEFORCBTVk1YQ19fU3RhdHVzX19jID0gJ0F2YWlsYWJsZScgQU5EIFNWTVhDX19RdWFudGl0eTJfX2MgPiAwIE9yZGVyIEJ5IFNWTVhDX19Mb2NhdGlvbl9fci5OYW1lIiA7DQoNCiAgICB2YXIgcXVlcnlSZXN1bHQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQogICAgaWYgKHF1ZXJ5UmVzdWx0LnNpemUgPD0gMCkNCgkJew0KCQkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDExIikpOwkgICAJCQ0KCQl9DQoJCQ0KCS8vIENvbW1lbnRlZCBieSBTdW1pdCBhbmQgTWFuaXNoIGR1ZSB0byBHb29nbGUgTWFwIEFQSSB1cGRhdGlvbiBmcm9tIHYyIHRvIHYzLg0KCS8vIFNMS1BfbWFwLmNsZWFyT3ZlcmxheXMoKTsNCiAgICBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnQoKTsNCiAJU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50V2l0aExhdExvbmcoKTsNCg0KICAgIFNMS1Bfcm93bnVtID0gMDsNCiAgICB2YXIgaGVhZGVyID0gZmFsc2U7DQogICAgdmFyIHN0b2NrcmVjb3JkcyA9IHF1ZXJ5UmVzdWx0LmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RvY2tyZWNvcmRzLmxlbmd0aDsgaSsrKQ0KCXsNCgkJdmFyIHJlYyA9IHN0b2NrcmVjb3Jkc1tpXTsNCgkJaWYocmVjLlNWTVhDX19Mb2NhdGlvbl9fYyAhPSBudWxsKQ0KCQl7DQoJCQl2YXIgU3ZjRW5ncklkID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYzsNCgkJCWlmIChTdmNFbmdySWQgPT1udWxsIHx8IFN2Y0VuZ3JJZC5zdWJzdHIoMCwxNSkgIT0gU0xLUF9Vc2VySWQpCS8vIFNraXAgY3VycmVudCB1c2VyJ3Mgc2l0ZXMNCgkJCXsNCgkJCQlpZiAoIXJlYy5TVk1YQ19fTG9jYXRpb25fX3IuTmFtZSkgU2l0ZU5hbWUgPSAiIjsNCgkJCQllbHNlIFNpdGVOYW1lID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5OYW1lOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdHJlZXRfX2MpIFN0cmVldCA9ICIiOw0KCQkJCWVsc2UgU3RyZWV0ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RyZWV0X19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19DaXR5X19jKSBDaXR5ID0gIiI7DQoJCQkJZWxzZSBDaXR5ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ2l0eV9fYzsNCg0KCQkJCWlmICghcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RhdGVfX2MpIFN0YXRlID0gIiI7DQoJCQkJZWxzZSBTdGF0ZSA9IHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1N0YXRlX19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19aaXBfX2MpIFppcCA9ICIiOw0KCQkJCWVsc2UgWmlwID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fWmlwX19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Db3VudHJ5X19jKSBDb3VudHJ5ID0gIiI7DQoJCQkJZWxzZSBDb3VudHJ5ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ291bnRyeV9fYzsNCg0KCQkJCWlmICghcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2l0ZV9QaG9uZV9fYykgUGhvbmUgPSAiIjsNCgkJCQllbHNlIFBob25lID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2l0ZV9QaG9uZV9fYzsNCg0KCQkJCWlmICghaGVhZGVyKSB7DQoJCQkJU1ZNWElfU0xLUF9EcmF3SGVhZGVyKHRib2R5KTsNCgkJCQloZWFkZXIgPSB0cnVlOw0KCQkJCX0NCgkJCQ0KCQkJLy9Db21tZW50ZWQgYnkgU3VtaXQgYW5kIE1hbmlzaCBkdWUgdG8gR29vZ2xlIE1hcCBBUEkgdXBkYXRpb24gZnJvbSB2MiB0byB2My4NCgkJCS8vCXZhciBwb2ludCA9IG5ldyBHTGF0TG5nKHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xhdGl0dWRlX19jLCByZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MpOw0KCQkJCXZhciBwb2ludCA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MsIHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xvbmdpdHVkZV9fYyk7IAkJDQogCQkJCVNWTVhJX1NMS1BfQWRkUG9pbnRUb01hcChyZWMscG9pbnQscmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MscmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTG9uZ2l0dWRlX19jLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgcGFyc2VGbG9hdChyZWMuU1ZNWENfX1F1YW50aXR5Ml9fYyksIHJlYy5TVk1YQ19fTG9jYXRpb25fX2MsaSxzdG9ja3JlY29yZHMubGVuZ3RoKTsNCg0KDQoJCQkvKglpZiAocmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MgIT0gbnVsbCAmJiByZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MgIT0gbnVsbCkNCgkJCQl7DQoJCQkJCXZhciBwb2ludCA9IG5ldyBHTGF0TG5nKHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xhdGl0dWRlX19jLCByZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MpOyAJCQkJU1ZNWElfU0xLUF9BZGRQb2ludFRvTWFwKHJlYyxwb2ludCxyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19MYXRpdHVkZV9fYyxyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBwYXJzZUZsb2F0KHJlYy5TVk1YQ19fUXVhbnRpdHkyX19jKSwgcmVjLlNWTVhDX19Mb2NhdGlvbl9fYyxpLHN0b2NrcmVjb3Jkcy5sZW5ndGgpOw0KCQkJCSANCgkJCQl9DQoJCQkJZWxzZQ0KCQkJCXsNCgkJCQkJU1ZNWElfU0xLUF9BZGRMb2NhdGlvblRvTWFwKHJlYyxTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgcGFyc2VGbG9hdChyZWMuU1ZNWENfX1F1YW50aXR5Ml9fYyksIHJlYy5TVk1YQ19fTG9jYXRpb25fX2MsaSxzdG9ja3JlY29yZHMubGVuZ3RoKTsNCgkJCQl9Ki8NCgkJCQlTTEtQX3Jvd251bSArPSAxOw0KCQkJfQ0KCQl9DQoJfQ0KDQogICAgdmFyIHJ2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAxOSIpLnZhbHVlOw0KICAgIGlmIChydiA9PSAiTWFwIikgeyBTTEtQX1Nob3dNYXAgPSBmYWxzZTsgU0xLUF9TaG93UmVzdWx0cyA9IHRydWU7IH0NCiAgICBpZiAocnYgPT0gIkdyaWQiKSB7IFNMS1BfU2hvd1Jlc3VsdHMgPSBmYWxzZTsgU0xLUF9TaG93TWFwID0gdHJ1ZTsgfQ0KICAgIGlmIChydiA9PSAiQm90aCIpIHsgU0xLUF9TaG93UmVzdWx0cyA9IGZhbHNlOyBTTEtQX1Nob3dNYXAgPSBmYWxzZTsgfQ0KDQogICAgU1ZNWENfU0xLUF9Ub2dnbGVNYXAoKTsNCiAgICBTVk1YQ19TTEtQX1RvZ2dsZVJlc3VsdHMoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZFBvaW50VG9NYXAoU3RvY2tSZWMsIFBvaW50LGxhdGl0dWRlLGxvbmdpdHV0ZSwgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFF0eUF2bGJsLCBTaXRlSWQsY3VycmNudCx0b3RjbnQpIA0KeyANCgkvL0NvbW1lbnRlZCBieSBTdW1pdCBhbmQgTWFuaXNoIGR1ZSB0byBHb29nbGUgTWFwIEFQSSB1cGRhdGlvbiBmcm9tIHYyIHRvIHYzLg0KICAgLyoJdmFyIG15SWNvbiA9IG5ldyBHSWNvbihHX0RFRkFVTFRfSUNPTik7IA0KCW15SWNvbi5pbWFnZSA9ICJodHRwOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL2ttbC9wYWwyL2ljb241LnBuZyI7IA0KCXZhciBTdG9ja1RhZyA9ICI8Yj4iICsgU2l0ZU5hbWUgKyAiPC9iPjxicj4iICsgDQoJCQkJCQkJCQkgIFN0cmVldCArICI8YnI+IiArIENpdHkgKyAiLCAiICsgU3RhdGUgKyAiICIgKyBaaXAgKyAiLCAiICsgQ291bnRyeSArICI8YnI+IiArIA0KCQkJCQkJCQkJICBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSArIFBob25lICsgIjxicj4iICsgDQoJCQkJCQkJCQkgICI8Yj4gIitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTQiKSArIHBhcnNlRmxvYXQoU3RvY2tSZWMuU1ZNWENfX1F1YW50aXR5Ml9fYykgKyAiPC9iPiIgKw0KCQkJCQkJCQkJICAiPGJyPiIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIik7DQoJdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOyANCglEaXN0YW5jZSA9IFNWTVhJX0NhbGN1bGF0ZURpc3RhbmNlKEdNTEtQX0xhdDEsR01MS1BfTG9uMSxsYXRpdHVkZSxsb25naXR1dGUsdW5pdHMpOw0KCWlmKERpc3RhbmNlID09IDApDQoJew0KCQlTVk1YSV9TTEtQX0FkZExvY2F0aW9uVG9NYXAoU3RvY2tSZWMsU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFF0eUF2bGJsLCBTaXRlSWQsY3VycmNudCx0b3RjbnQpOw0KCX0NCgllbHNlIGlmIChEaXN0YW5jZSA8PSBTTEtQX3JhZGl1cyB8fCBTTEtQX3JhZGl1cyA9PSAwKQ0KCXsNCgkJcmVjRm91bmQgPT0iWUVTIg0KCQlteUljb24uaWNvblNpemU9bmV3IEdTaXplKDMyLDMyKTsgDQoJCW15SWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7IA0KCQlteUljb24uaWNvbkFuY2hvcj1uZXcgR1BvaW50KDE2LDMyKTsgDQoJCW15SWNvbi5pbmZvV2luZG93QW5jaG9yPW5ldyBHUG9pbnQoMTYsMCk7IA0KCQl2YXIgbWFya2VyT3B0aW9uczIgPSB7IGljb246bXlJY29uIH07IA0KCQl2YXIgbWFya2VyID0gbmV3IEdNYXJrZXIoUG9pbnQsIG1hcmtlck9wdGlvbnMyKTsNCgkJU0xLUF9tYXAuYWRkT3ZlcmxheShtYXJrZXIpOyANCgkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIub3BlbkluZm9XaW5kb3dIdG1sKFN0b2NrVGFnKTt9KSA7IA0KCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgbWFya2VyLmNsb3NlSW5mb1dpbmRvdygpOyB9KSA7IA0KCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAiZGJsY2xpY2siLCBmdW5jdGlvbigpIHsgU1ZNWElfU0xLUF9TZXRSZXF1ZXN0RnJvbUxvY2F0aW9uKFNpdGVJZCwgU2l0ZU5hbWUpOyB9KTsgDQoJCVNWTVhJX1NMS1BfQWRkUmVzdWx0Um93KFN0b2NrUmVjLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgU2l0ZUlkLCBEaXN0YW5jZSk7DQoJfQ0KCWVsc2UgaWYgKERpc3RhbmNlID4gU0xLUF9yYWRpdXMpDQoJew0KCQlpZihwYXJzZUludChjdXJyY250KT09cGFyc2VJbnQodG90Y250KSAmJiByZWNGb3VuZCA9PSJOTyIpDQoJCXsNCgkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAyMiIpKTsNCgkJCXRyeXsNCgkJCQl2YXIgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KCQkJCWNsZWFyX3RhYmxlKHRib2R5KTsNCgkJCX1jYXRjaChlKXt9DQoJCX0NCgl9DQoJKi8NCgkNCgl2YXIgbXlJY29uID0gew0KCQlzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgzMiwgMzIpLCANCgkJYW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoMTYsIDMyKSwNCgkJdXJsOiAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMi9pY29uNS5wbmciDQoJfQ0KCXZhciBTdG9ja1RhZyA9ICI8Yj4iICsgU2l0ZU5hbWUgKyAiPC9iPjxicj4iICsgDQoJCQkJCQkJCQkgIFN0cmVldCArICI8YnI+IiArIENpdHkgKyAiLCAiICsgU3RhdGUgKyAiICIgKyBaaXAgKyAiLCAiICsgQ291bnRyeSArICI8YnI+IiArIA0KCQkJCQkJCQkJICBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSArIFBob25lICsgIjxicj4iICsgDQoJCQkJCQkJCQkgICI8Yj4gIitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTQiKSArIHBhcnNlRmxvYXQoU3RvY2tSZWMuU1ZNWENfX1F1YW50aXR5Ml9fYykgKyAiPC9iPiIgKw0KCQkJCQkJCQkJICAiPGJyPiIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIik7DQoJdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOyANCglEaXN0YW5jZSA9IFNWTVhJX0NhbGN1bGF0ZURpc3RhbmNlKEdNTEtQX0xhdDEsR01MS1BfTG9uMSxsYXRpdHVkZSxsb25naXR1dGUsdW5pdHMpOw0KCWlmKERpc3RhbmNlID09IDApDQoJew0KCQlTVk1YSV9TTEtQX0FkZExvY2F0aW9uVG9NYXAoU3RvY2tSZWMsU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFF0eUF2bGJsLCBTaXRlSWQsY3VycmNudCx0b3RjbnQpOw0KCX0NCgllbHNlIGlmIChEaXN0YW5jZSA8PSBTTEtQX3JhZGl1cyB8fCBTTEtQX3JhZGl1cyA9PSAwKQ0KCXsNCgkJcmVjRm91bmQgPT0iWUVTIg0KCQlteUljb24uc2l6ZSA9IGdvb2dsZS5tYXBzLlNpemUoMzIsIDMyKTsNCgkJbXlJY29uLmFuY2hvciA9IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNiwgMzIpOw0KCQltYXJrZXJPcHRpb25zMiA9IHsgDQoJCQltYXA6IFNMS1BfbWFwLA0KCQkJaWNvbjogbXlJY29uLCANCgkJCXBvc2l0aW9uOiBQb2ludCwgDQoJCQlzaGFkb3c6IHsgc2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoNTYsIDMyKX0JDQoJCX07DQoJCXZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKG1hcmtlck9wdGlvbnMyKTsNCgkJdmFyIGluZm9fd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe2NvbnRlbnQ6IFN0b2NrVGFnfSk7DQoJCWdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkge2luZm9fd2luZG93Lm9wZW4oU0xLUF9tYXAsIG1hcmtlcik7fSkgOw0KCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW91dCIsIGZ1bmN0aW9uKCkge2luZm9fd2luZG93LmNsb3NlKCk7fSkgOw0KCQlnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJkYmxjbGljayIsIGZ1bmN0aW9uKCkgeyBTVk1YSV9TTEtQX1NldFJlcXVlc3RGcm9tTG9jYXRpb24oU2l0ZUlkLCBTaXRlTmFtZSk7IH0pOyANCgkJU1ZNWElfU0xLUF9BZGRSZXN1bHRSb3coU3RvY2tSZWMsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBTaXRlSWQsIERpc3RhbmNlKTsNCgl9DQoJZWxzZSBpZiAoRGlzdGFuY2UgPiBTTEtQX3JhZGl1cykNCgl7DQoJCWlmKHBhcnNlSW50KGN1cnJjbnQpPT1wYXJzZUludCh0b3RjbnQpICYmIHJlY0ZvdW5kID09Ik5PIikNCgkJew0KCQkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIyIikpOw0KCQkJdHJ5ew0KCQkJCXZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoJCQkJY2xlYXJfdGFibGUodGJvZHkpOw0KCQkJfWNhdGNoKGUpe30NCgkJfQ0KCX0NCn0gDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NMS1BfQWRkUmVzdWx0Um93KFN0b2NrUmVjLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgU2l0ZUlkLCBEaXN0YW5jZSkNCnsNCiAgICB2YXIgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KICAgIHZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKFNMS1Bfcm93bnVtLHRib2R5KSk7DQogICAgdHIuc29iamVjdCA9IFN0b2NrUmVjOw0KICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCSAgICAvLyBDb2wgMS4gTG9jYXRpb24gTmFtZQ0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaWQ9XCIiICsgU3RvY2tSZWMuSWQgKyAiU2l0ZU5hbWVcIiBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgU2l0ZU5hbWUgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDIuIFN0cmVldA0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgU3RvY2tSZWMuSWQgKyAiXCI+IiArIFN0cmVldCArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgMy4gQ2l0eQ0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgU3RvY2tSZWMuSWQgKyAiXCI+IiArIENpdHkgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDQuIFN0YXRlDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgU3RhdGUgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDUuIFppcA0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgU3RvY2tSZWMuSWQgKyAiXCI+IiArIFppcCArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgNi4gQ291bnRyeQ0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgU3RvY2tSZWMuSWQgKyAiXCI+IiArIENvdW50cnkgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDcuIFBob25lDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgUGhvbmUgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDguIEF2YWlsYWJsZSBRdWFudGl0eQ0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3ciLCAiYWxpZ24iOiJyaWdodCJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgU3RvY2tSZWMuU1ZNWENfX1F1YW50aXR5Ml9fYyArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgOS4gRGlzdGFuY2UNCiAgICBjcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93IiwgImFsaWduIjoicmlnaHQifSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgU3RvY2tSZWMuSWQgKyAiXCI+IiArIERpc3RhbmNlICsgIjwvYT4iOw0KDQoJICAgIC8vIENvbCAxMC4gUmFkaW8gYnV0dG9uDQogICAgY3JlYXRlVGFnKHRyLCJ0ZCIsW10pLmlubmVySFRNTCA9DQoJIjxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwicmFkaW9cIiB2YWx1ZT1cIiIgKyBTdG9ja1JlYy5JZCArICJcIj48L2lucHV0PiI7DQoNCgkgICAgLy8gQ29sIDExLiBIaWRkZW4gU2l0ZSBJZA0KICAgIGNyZWF0ZVRhZyh0ciwidGQiLFtdKS5pbm5lckhUTUwgPQ0KCSI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGlkPVwiIiArIFN0b2NrUmVjLklkICsgIlNpdGVJZFwiIHZhbHVlPVwiIiArIFN0b2NrUmVjLlNWTVhDX19Mb2NhdGlvbl9fYyArICJcIj48L2lucHV0PiI7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU0xLUF9EcmF3SGVhZGVyKHRhKQ0Kew0KICAgIGNsZWFyX3RhYmxlKHRhKTsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGEuYXBwZW5kQ2hpbGQodHIpOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA5IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDEwIikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDExIikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDEyIikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDEzIikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDE0IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDE1IikrIiAjPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDE2IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAxNyIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J2NlbnRlcid9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDE4IikrIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX1NMS1BfVG9nZ2xlTWFwKCkNCnsNCiAgICBpZiAoU0xLUF9TaG93TWFwKQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdk1hcCIpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdlJvdXRlIikuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCglTTEtQX1Nob3dNYXAgPSBmYWxzZTsNCgl9DQogICAgZWxzZQ0KCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2TWFwIikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdlJvdXRlIikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJU0xLUF9TaG93TWFwID0gdHJ1ZTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfU0xLUF9Ub2dnbGVSZXN1bHRzKCkNCnsNCiAgICBpZiAoU0xLUF9TaG93UmVzdWx0cykNCgl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdlJlc3VsdHMiKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KCVNMS1BfU2hvd1Jlc3VsdHMgPSBmYWxzZTsNCgl9DQogICAgZWxzZQ0KCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2UmVzdWx0cyIpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KCVNMS1BfU2hvd1Jlc3VsdHMgPSB0cnVlOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19TTEtQX1RvZ2dsZU9wdGlvbnMoKQ0Kew0KICAgIGlmIChTTEtQX1Nob3dPcHRpb25zKQ0KCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2T3B0aW9ucyIpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoJU0xLUF9TaG93T3B0aW9ucyA9IGZhbHNlOw0KCX0NCiAgICBlbHNlDQoJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXZPcHRpb25zIikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJU0xLUF9TaG93T3B0aW9ucyA9IHRydWU7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIGNyZWF0ZVRhZyhwYXJlbnQsIG5hbWUsIGtleXZhbFBhaXJzKQ0Kew0KICAgIHZhciByZXQ7DQogICAgdmFyIGJyb3dzZXIgPSBuYXZpZ2F0b3IuYXBwTmFtZTsNCiAgICBpZiAoYnJvd3NlciA9PSAiTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyIikgew0KCSAgICB2YXIgdHJUYWcgPSAiPCIrbmFtZSsiICI7DQoJICAgIGZvciAoa2V5IGluIGtleXZhbFBhaXJzKSB7DQoJCQkgICAgdHJUYWcgKz0ga2V5ICsgIj1cIiIgKyBrZXl2YWxQYWlyc1trZXldICsgIlwiIjsNCgkgICAgfQ0KCSAgICB0clRhZyArPSAiPiI7DQoJICAgIHJldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHJUYWcpOw0KICAgIH0gZWxzZSB7DQoJICAgIHJldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7DQoJICAgIGZvciAoa2V5IGluIGtleXZhbFBhaXJzKSB7DQoJCSAgICByZXQuc2V0QXR0cmlidXRlKGtleSwga2V5dmFsUGFpcnNba2V5XSk7DQoJICAgIH0NCiAgICB9DQogICAgcGFyZW50LmFwcGVuZENoaWxkKHJldCk7DQogICAgcmV0dXJuIHJldDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19TTEtQX1JlcXVlc3RTdG9jaygpDQp7DQogICAgdmFyIGNoZWNrZWQgPSBmYWxzZTsNCiAgICB2YXIgcmxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgicmFkaW8iKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJsaXN0Lmxlbmd0aDsgaSsrKQ0KICAgIAl7DQoJaWYgKHJsaXN0W2ldLmNoZWNrZWQpDQoJICAgIHsNCgkgICAgY2hlY2tlZCA9IHRydWU7DQoJICAgIGJyZWFrOw0KCSAgICB9DQoJfQ0KICAgIGlmICghY2hlY2tlZCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciBzaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChybGlzdFtpXS52YWx1ZSsiU2l0ZUlkIikudmFsdWU7DQogICAgdmFyIHNuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmxpc3RbaV0udmFsdWUrIlNpdGVOYW1lIikuaW5uZXJIVE1MOw0KICAgIFNWTVhJX1NMS1BfU2V0UmVxdWVzdEZyb21Mb2NhdGlvbihzaWQsIHNuKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19DYW5jZWxQYXJ0c1JlcXVlc3QocmVxSWQsIHVJZCkNCnsNCiAgICBTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlBSRVFTQzEiKTsNCiAgICBTVk1YSV9TZXRMYWJlbHMoImNhbmNlbHBhcnRzcmVxdWVzdCIpOw0KDQogICAgdmFyIGFucyA9IGNvbmZpcm0oU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KICAgIGlmICghYW5zKSB7IHJldHVybjsgfQ0KDQogICAgQ05QUl9SZXF1ZXN0SWQgPSByZXFJZDsNCiAgICBDTlBSX1VzZXJJZCA9IHVJZDsNCg0KICAgIC8vIEdldCBQYXJ0cyBSZXF1ZXN0IGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fU3RhdHVzX19jIEZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgV0hFUkUgSWQgPSAnIiArIENOUFJfUmVxdWVzdElkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDb21wbGV0ZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KDQogICAgLy8gR2V0IG9wZW4gUGFydHMgUmVxdWVzdCBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsICIgKw0KICAgIAkJIlNWTVhDX19RdWFudGl0eV9SZWNlaXZlZDJfX2MsIFNWTVhDX19MaW5lX1N0YXR1c19fYyAiICsNCgkJIkZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgQ05QUl9SZXF1ZXN0SWQgKyAiJyI7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICByZWNzID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgcmVxbGluZXMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHJlY3MubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gcmVjc1trXTsNCg0KCWlmIChyZWMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID09ICJDb21wbGV0ZWQiIHx8IHJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYyA+IDAgfHwNCgkJCQlyZWMuU1ZNWENfX1F1YW50aXR5X1JlY2VpdmVkMl9fYyA+IDAgfHwgcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYyA+IDApDQoJICAgIHsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIGJyZWFrOw0KCSAgICB9DQoJdmFyIHJlcWxpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MiKTsNCglyZXFsaW5lLklkID0gcmVjLklkOw0KCXJlcWxpbmUuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCglyZXFsaW5lLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJcmVxbGluZS5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBDTlBSX1VzZXJJZDsNCglyZXFsaW5lcy5wdXNoKHJlcWxpbmUpOw0KCX0NCg0KICAgIGlmIChpbnZhbGlkKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikrIlxuIitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUocmVxbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgdmFyIHJlcWhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MiKTsNCiAgICByZXFoZHIuSWQgPSBDTlBSX1JlcXVlc3RJZDsNCiAgICByZXFoZHIuU1ZNWENfX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQogICAgcmVxaGRyLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQogICAgcmVxaGRyLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IENOUFJfVXNlcklkOw0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtyZXFoZHJdKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfQ2FuY2VsU2hpcG1lbnRPcmRlcihzaHBJZCwgdUlkKQ0Kew0KCVNWTVhJX0luaXRNZXNzYWdlTGlzdCgiUE9SRFNDMSIpOw0KCVNWTVhJX1NldExhYmVscygiQ2FuY2VsU2hpcG1lbnRvcmRlciIpOw0KCQ0KICAgIENOU0hQX1NoaXBtZW50T3JkZXJJZCA9IHNocElkOw0KICAgIENOU0hQX1VzZXJJZCA9IHVJZDsNCg0KICAgIC8vIEdldCBTaGlwbWVudCBvcmRlciBoZWFkZXIgaW5mbw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX09yZGVyX1N0YXR1c19fYyBGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgV0hFUkUgSWQgPSAnIiArIENOU0hQX1NoaXBtZW50T3JkZXJJZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDIiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2xvc2VkIikNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIC8vIEdldCBvcGVuIHNoaXBtZW50IG9yZGVyIGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX0xpbmVfU3RhdHVzX19jLCBTVk1YQ19fQWN0dWFsX1F1YW50aXR5Ml9fYyBGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBDTlNIUF9TaGlwbWVudE9yZGVySWQgKyAiJyI7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICByZWNzID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc2hwbGluZXMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHJlY3MubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gcmVjc1trXTsNCg0KCWlmIChyZWMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID09ICJDb21wbGV0ZWQiIHx8IHJlYy5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPT0gIkNhbmNlbGVkIiB8fCBwYXJzZUZsb2F0KHJlYy5TVk1YQ19fQWN0dWFsX1F1YW50aXR5Ml9fYykgPiAwKQ0KCSAgICB7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICBicmVhazsNCgkgICAgfQ0KCXZhciBzaHBsaW5lID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MiKTsNCglzaHBsaW5lLklkID0gcmVjLklkOw0KCXNocGxpbmUuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCglzaHBsaW5lLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJc2hwbGluZS5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBDTlNIUF9Vc2VySWQ7DQoJc2hwbGluZXMucHVzaChzaHBsaW5lKTsNCgl9DQoNCiAgICBpZiAoaW52YWxpZCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKyJcbiIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHNocGxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHZhciBzaHBoZHIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MiKTsNCiAgICBzaHBoZHIuSWQgPSBDTlNIUF9TaGlwbWVudE9yZGVySWQ7DQogICAgc2hwaGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KICAgIHNocGhkci5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KICAgIHNocGhkci5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBDTlNIUF9Vc2VySWQ7DQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3NocGhkcl0pOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7DQogICAgQ2xvc2VXaW5kb3coKTsNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9QUlNocF9TaG93UFJUb0JlU2hpcHBlZChyZXFJZCwgdUlkKQ0Kew0KDQoJU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJQUkVRU0MyIik7DQoJU1ZNWElfU2V0TGFiZWxzKCJDcmVhdGVTaGlwbWVudEZyb21QUiIpOw0KDQogICAgU0hQUl9SZXF1ZXN0SWQgPSByZXFJZDsNCiAgICBTSFBSX1VzZXJJZCA9IHVJZDsNCg0KICAgIC8vIEdldCBQYXJ0cyBSZXF1ZXN0IGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBPd25lcklkLCBTVk1YQ19fQ29tcGFueV9fYywgU1ZNWENfX1N0YXR1c19fYywgU1ZNWENfX1JlcXVlc3RlZF9Gcm9tX19jLCAiICsNCiAgICAJCSJTVk1YQ19fUmVxdWlyZWRfQXRfTG9jYXRpb25fX2MsIFNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyBXSEVSRSBJZCA9ICciICsgU0hQUl9SZXF1ZXN0SWQgKyAiJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikgKyAiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX1N0YXR1c19fYyA9PSAiQ29tcGxldGVkIikNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBTSFBSX0NvbXBhbnlJZCA9IHJlYzFbMF0uU1ZNWENfX0NvbXBhbnlfX2M7DQogICAgU0hQUl9SZXF1ZXN0ZWRGcm9tSWQgPSByZWMxWzBdLlNWTVhDX19SZXF1ZXN0ZWRfRnJvbV9fYzsNCiAgICBTSFBSX1JlcXVpcmVkQXRJZCA9IHJlYzFbMF0uU1ZNWENfX1JlcXVpcmVkX0F0X0xvY2F0aW9uX19jOw0KICAgIFNIUFJfT3duZXJJZCA9IHJlYzFbMF0uT3duZXJJZDsNCiAgICBTSFBSX0FkZGxJbmZvID0gcmVjMVswXS5TVk1YQ19fQWRkaXRpb25hbF9JbmZvcm1hdGlvbl9fYzsNCg0KICAgIC8vIEdldCBvcGVuIFBhcnRzIFJlcXVlc3QgbGluZXMNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkLCBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19RdWFudGl0eV9SZXF1aXJlZDJfX2MsICIgKw0KICAgIAkJIlNWTVhDX19EYXRlX1JlcXVpcmVkX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYywgU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jLCBTVk1YQ19fQWRkaXRpb25hbF9JbmZvcm1hdGlvbl9fYyxTVk1YQ19fVW5pdF9QcmljZTJfX2MgIiArDQoJCSJGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgPSAnIiArIFNIUFJfUmVxdWVzdElkICsgIicgQU5EICIgKw0KCQkiU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ09wZW4nIjsgLy9CeSBHbSAxOGp1bjA4IGFkZGVkIGZsZCA6IFNWTVhDX19Vbml0X1ByaWNlMl9fYyAgDQogICAgdHJ5IHsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIH0gY2F0Y2ggKGUpIHsgYWxlcnQoZSk7IH0NCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVxcmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjIpOw0KDQogICAgdmFyIHJvd2NudCA9IDA7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIFNWTVhJX1BSU2hwX0RyYXdIZWFkZXIodGJvZHkpOw0KDQogICAgd2hpbGUocmVxcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciByZXFyZWMgPSByZXFyZWNzLm5leHQoKTsNCgl2YXIgcmVxaWQgPSByZXFyZWMuSWQ7DQoJdmFyIHByb2RpZCA9IHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgUmVxUXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYyk7DQoNCglpZiAocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKSkNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKTsNCg0KCXZhciBSZW1RdHkgPSBSZXFRdHktU2hpcEluaXRRdHk7DQoNCglpZiAoUmVtUXR5ID4gMCkNCgkgICAgew0KCSAgICB2YXIgdHIgPSBtYWtlUm93KG1ha2VBdHRycyhyb3djbnQsdGJvZHkpICk7DQoJICAgIHRyLnNvYmplY3QgPSByZXFyZWM7DQoJICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCQkgICAgLy8gQ29sIDEuIFByb2R1Y3QgTmFtZQ0KCSAgICBjcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBwcm9kaWQgKyAiXCI+IiArIHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lICsgIjwvYT4iOw0KDQoJCSAgICAvLyBDb2wgMi4gUmVtYWluaW5nIFF1YW50aXR5DQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSZW1RdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJlbVF0eVwiIHZhbHVlPVwiIiArIFJlbVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCAzLiBRdWFudGl0eSB0byBiZSBzaGlwcGVkDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJTaHBRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNocFF0eVwiIHZhbHVlPVwiIiArIFJlbVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCA0LiBRdWFudGl0eSBzaGlwbWVudCBpbml0aWF0ZWQgKGhpZGRlbiBmb3IgdXBkYXRlIGxhdGVyKQ0KCSAgICBjcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSAgICAiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBpZD1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwSW5pdFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCA1LiBTdGF0dXMgTWVzc2FnZQ0KCSAgICBjcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSAgICAiPGRpdiBpZD1cIiIgKyByZXFpZCArICJFcnJNc2dcIiBuYW1lPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCgkJICAgIC8vIENvbCA1LiBIaWRkZW4gZmllbGQgdG8gZ2V0IGEgaGFuZGxlIG9uIHRoZSBlbnRpcmUgcm93LiBObyBVSSBwdXJwb3NlDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGlkPVwicm93aWRcIiBuYW1lPVwicm93aWRcIj48L2lucHV0PiI7DQoNCgkgICAgcm93Y250ICs9IDE7DQoJICAgIH0NCgl9DQogICAgaWYgKHJvd2NudCA9PSAwKQ0KICAgIAl7DQoJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS5oZWlnaHQgPSAwOyANCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9QUlNocF9EcmF3SGVhZGVyKHRhKQ0Kew0KICAgIHZhciB0ciA9IG1ha2VSb3coeydjbGFzcyc6J2hlYWRlclJvdyd9KTsNCiAgICB0YS5hcHBlbmRDaGlsZCh0cik7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDUiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA2IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNyIpKyI8L2E+IjsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9QUlNocF9WYWxpZGF0ZUFuZFByb2Nlc3MoKQ0Kew0KICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ0NyZWF0ZVNoaXBtZW50RnJvbVBSJ107DQoNCg0KICAgIHZhciBzb2JqZWN0TGlzdCA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKQ0KCXsNCglpZiAoZm9ybS5lbGVtZW50c1tpXS5uYW1lID09ICdyb3dpZCcpCQkvLyBOZWVkIGFuIGlkZW50aWZpZXIgdG8gcHJvY2VzcyBlYWNoIHJvdyBvbmx5IG9uY2UNCgkgICAgew0KCSAgICB2YXIgcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGU7DQoJICAgIHZhciBwcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCgkgICAgaWYgKHBwbi5zb2JqZWN0KQ0KCQl7DQoJCXNvYmplY3RMaXN0LnB1c2gocHBuLnNvYmplY3QpOw0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBza2lwY250ID0gMDsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHNvYmplY3RMaXN0Lmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlY19pbnZhbGlkID0gZmFsc2U7DQoJdmFyIHJlYyA9IHNvYmplY3RMaXN0W2tdOw0KCXZhciBSZW1RdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmVtUXR5IikudmFsdWUpOw0KCXZhciBTaHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hwUXR5IikudmFsdWUpOw0KCXZhciBFcnJNc2cgPSAiIjsNCglpZiAoaXNOYU4oU2hwUXR5KSB8fCBTaHBRdHkgPCAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpOyANCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKFNocFF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNraXBjbnQgKz0gMTsNCgkgICAgfQ0KCWVsc2UgaWYoU2hwUXR5ID4gUmVtUXR5KQ0KCSAgICB7DQoJICAgIEVyck1zZyA9U1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3Iik7IA0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKHJlY19pbnZhbGlkKQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSBFcnJNc2c7DQoJICAgIH0NCgllbHNlDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gIiI7DQoJICAgIH0NCgl9DQogICAgaWYoaW52YWxpZCkgeyByZXR1cm47IH0NCg0KICAgIGlmKHNraXBjbnQgPT0gc29iamVjdExpc3QubGVuZ3RoKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCXJldHVybjsNCgl9DQoNCiAgICBpZiAoU1ZNWElfUFJTaHBfQ3JlYXRlU2hpcG1lbnRPcmRlcihzb2JqZWN0TGlzdCkpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7DQoJd2luZG93Lm9wZW5lci5sb2NhdGlvbiA9ICIvIiArIFNIUFJfU2hpcG1lbnRPcmRlcklkOw0KCUNsb3NlV2luZG93KCk7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1BSU2hwX0NyZWF0ZVNoaXBtZW50T3JkZXIoc29iamVjdExpc3QpDQp7DQogICAgLy8gR2V0IFNhbGVzZm9yY2UgaW50ZXJuYWwgUmVjb3JkIFR5cGUgSUQgZm9yIFJNQSBIZWFkZXIgIlNoaXBtZW50Ig0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYycgQU5EIE5hbWUgPSAnU2hpcG1lbnQnIg0KICAgIHZhciBxdWVyeVJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCiAgICB2YXIgcnRyZWNvcmRzID0gcXVlcnlSZXN1bHQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocnRyZWNvcmRzLmxlbmd0aCA9PSAwKSB7ICAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTAiKSk7IA0KICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICB2YXIgU2hpcG1lbnRIZHJSZWNvcmRUeXBlID0gcnRyZWNvcmRzWzBdLklkOw0KDQogICAgLy8gR2V0IFNhbGVzZm9yY2UgaW50ZXJuYWwgUmVjb3JkIFR5cGUgSUQgZm9yIFJNQSBMaW5lICJTaGlwbWVudCINCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYycgQU5EIE5hbWUgPSAnU2hpcG1lbnQnIg0KICAgIHZhciBxdWVyeVJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCiAgICB2YXIgcnRyZWNvcmRzID0gcXVlcnlSZXN1bHQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocnRyZWNvcmRzLmxlbmd0aCA9PSAwKSB7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOyANCgl3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICB2YXIgU2hpcG1lbnRMaW5lUmVjb3JkVHlwZSA9IHJ0cmVjb3Jkc1swXS5JZDsNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQoNCiAgICB2YXIgc2hwSGRyID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jIik7DQogICAgc2hwSGRyLlJlY29yZFR5cGVJZCA9IFNoaXBtZW50SGRyUmVjb3JkVHlwZTsNCiAgICBzaHBIZHIuU1ZNWENfX0NvbXBhbnlfX2MgPSBTSFBSX0NvbXBhbnlJZDsNCiAgICBzaHBIZHIuU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9ICJPcGVuIjsNCiAgICBzaHBIZHIuU1ZNWENfX0V4cGVjdGVkX0RlbGl2ZXJ5X0RhdGVfX2MgPSBzb2JqZWN0TGlzdFswXS5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYzsNCiAgICBzaHBIZHIuU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYyA9IFNIUFJfUmVxdWVzdGVkRnJvbUlkOw0KICAgIHNocEhkci5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2MgPSBTSFBSX1JlcXVpcmVkQXRJZDsNCiAgICBzaHBIZHIuU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2MgPSBTSFBSX093bmVySWQ7DQogICAgc2hwSGRyLlNWTVhDX19QYXJ0c19SZXF1ZXN0X19jID0gU0hQUl9SZXF1ZXN0SWQ7DQogICAgc2hwSGRyLlNWTVhDX19TaGlwcGluZ19SZWNlaXZpbmdfTm90ZXNfX2MgPSBTSFBSX0FkZGxJbmZvOw0KICAgIHRyeSB7DQogICAgICAgIHZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3NocEhkcl0pOyANCgkJaWYgKHJldFswXS5nZXRCb29sZWFuKCJzdWNjZXNzIikpIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm4gcmV0WzBdLmlkOyAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgIGVsc2UgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXRbMF0uZXJyb3JzLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JldHVybiBudWxsOw0KICAgICAgICAgICAgICAgIH0gIA0KCQl9DQogICAgY2F0Y2goZXJyb3IpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTEiKSsiXG4iKyBlcnJvcik7ICAgICAgICAgICAgICANCiAgICB9DQogICAgU0hQUl9TaGlwbWVudE9yZGVySWQgPSByZXRbMF0uaWQ7DQoNCiAgICAvLyBidWlsZCBhbiBhcnJheSBvZiBzaGlwbWVudCBsaW5lcw0KICAgIHZhciBzaHBsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIHZhciByZXFsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFNocFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaHBRdHkiKS52YWx1ZSk7DQoJdmFyIFJlbVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZW1RdHkiKS52YWx1ZSk7DQoJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KDQoJaWYgKFNocFF0eSA9PSAwKSB7IGNvbnRpbnVlOyB9CQkvLyBJdGVtIG5vdCBzaGlwcGVkLiBTa2lwLg0KDQoJdmFyIHNocExpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSBTSFBSX1NoaXBtZW50T3JkZXJJZDsNCiAgICAgICAgc2hwTGluZS5SZWNvcmRUeXBlSWQgPSBTaGlwbWVudExpbmVSZWNvcmRUeXBlOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19Qcm9kdWN0X19jID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19FeHBlY3RlZF9TaGlwX0RhdGVfX2MgPSByZWMuU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2M7DQoJCXNocExpbmUuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyA9IFNocFF0eTsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fU2hpcF9Mb2NhdGlvbl9fYyA9IFNIUFJfUmVxdWlyZWRBdElkOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJPcGVuIjsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fTGluZV9UeXBlX19jID0gIk91dGJvdW5kIChTaGlwbWVudCkiOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgPSByZWMuSWQ7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSBmYWxzZTsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fUGFja2luZ19JbnN0cnVjdGlvbnNfX2MgPSByZWMuU1ZNWENfX0FkZGl0aW9uYWxfSW5mb3JtYXRpb25fX2M7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2MgPSBTSFBSX093bmVySWQ7DQoJCXNocExpbmUuU1ZNWENfX0xpbmVfUHJpY2UyX19jID0gcmVjLlNWTVhDX19Vbml0X1ByaWNlMl9fYzsgLy9CeSBHbSAxOEp1bjA4IA0KCQlzaHBMaW5lLlNWTVhDX19Vc2VfUHJpY2VfRnJvbV9QcmljZWJvb2tfX2MgPSAiRmFsc2UiOyAvL0JZIEdNIDE4SnVuMDgNCglzaHBsaW5lcy5wdXNoKHNocExpbmUpOw0KDQoJdmFyIHJlcWxpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MiKTsNCglyZXFsaW5lLklkID0gcmVjLklkOw0KCXJlcWxpbmUuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPSBTaGlwSW5pdFF0eSArIFNocFF0eTsNCglyZXFsaW5lcy5wdXNoKHJlcWxpbmUpOw0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHNocGxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsJCQ0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKSsiXG4iKyBlKTsgICAgICAgICAgICAgIA0KCQlyZXR1cm4gZmFsc2U7DQogICAgCX0NCg0KICAgIC8vIFVwZGF0ZSB0aGUgcGFydHMgcmVxdWVzdCBsaW5lcyB3aXRoIHNoaXBtZW50IGluaXRpYXRlZCBxdWFudGl0eQ0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHJlcWxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TVk9TaHBfU2hvd1NjcmVlbihzZXJ2SWQsIHVJZCkNCnsNCg0KCVNWTVhJX0luaXRNZXNzYWdlTGlzdCgiV09SRFNDNSIpOw0KCVNWTVhJX1NldExhYmVscygiQ3JlYXRlU2hpcG1lbnRGcm9tU1ZPIik7DQoNCiAgICBTSFNWT19TVk9JZCA9IHNlcnZJZDsNCiAgICBTSFNWT19Vc2VySWQgPSB1SWQ7DQoNCiAgICAvLyBHZXQgU2VydmljZSBPcmRlciBoZWFkZXIgaW5mbw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgT3duZXJJZCwgU1ZNWENfX0NvbXBhbnlfX2MsIFNWTVhDX19DYXNlX19jLCBTVk1YQ19fQ29udGFjdF9fYywgU1ZNWENfX09yZGVyX1N0YXR1c19fYyBGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jIFdIRVJFIElkID0gJyIgKyBTSFNWT19TVk9JZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsJIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpICk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2xvc2VkIikNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBTSFNWT19Db21wYW55SWQgPSByZWMxWzBdLlNWTVhDX19Db21wYW55X19jOw0KICAgIFNIU1ZPX0Nhc2VJZCA9IHJlYzFbMF0uU1ZNWENfX0Nhc2VfX2M7DQogICAgU0hTVk9fQ29udGFjdElkID0gcmVjMVswXS5TVk1YQ19fQ29udGFjdF9fYzsNCiAgICBTSFNWT19Pd25lcklkID0gcmVjMVswXS5Pd25lcklkOw0KDQogICAgLy8gR2V0IFNhbGVzZm9yY2UgaW50ZXJuYWwgUmVjb3JkIFR5cGUgSUQgZm9yIFNWTyBMaW5lICJSZXF1ZXN0L1JlY2VpcHQiDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYycgQU5EIE5hbWUgPSAnUmVxdWVzdC9SZWNlaXB0JyINCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOyANCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsgICAgICAgICAgICAgIA0KICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMiA9IHFyMi5nZXRBcnJheSgicmVjb3JkcyIpOw0KDQogICAgLy8gR2V0IG9wZW4gU2VydmljZSBPcmRlciBsaW5lcw0KICAgIHZhciBzb3FsMyA9ICJTRUxFQ1QgSWQsIFNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MsU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fci5OYW1lICIgKw0KCQkiRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIFdIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBTSFNWT19TVk9JZCArICInIEFORCAiICsNCgkJIlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdPcGVuJyBBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyByZWMyWzBdLklkICsgIiciOw0KICAgIHRyeSB7DQogICAgdmFyIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICB9IGNhdGNoIChlKSB7IGFsZXJ0KGUpOyB9DQogICAgaWYgKHFyMy5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIFJlcXVpcmVkQXQgPSBmYWxzZTsNCiAgICB2YXIgcmVjY250ID0gMDsNCiAgICB2YXIgayA9IDA7DQogICAgdmFyIHJlYzMgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIzKTsNCiAgICB2YXIgTG9jTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJMb2NhdGlvbkxpc3QiKTsNCiAgICB3aGlsZShyZWMzLmhhc05leHQoKSkNCiAgICAJew0KCXZhciBzdm9saW5lID0gcmVjMy5uZXh0KCk7DQoJaWYgKHN2b2xpbmUuU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYykNCgkgICAgew0KCSAgICB2YXIgc2tpcCA9IGZhbHNlOw0KCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IExvY0xpc3QubGVuZ3RoOyBpKyspDQoJCXsNCgkJaWYgKExvY0xpc3RbaV0udmFsdWUgPT0gc3ZvbGluZS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jKQ0KCQkgICAgew0KCQkgICAgc2tpcCA9IHRydWU7DQoJCSAgICBicmVhazsNCgkJICAgIH0NCgkJfQ0KCSAgICBpZiAoIXNraXApDQoJCXsNCgkJbG9jID0gbmV3IE9wdGlvbihzdm9saW5lLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX3IuTmFtZSwgc3ZvbGluZS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jKTsNCgkJTG9jTGlzdC5vcHRpb25zW2srK10gPSBsb2M7DQoJCXJlY2NudCArPSAxOw0KCQl9DQoJICAgIH0NCglpZiAoc3ZvbGluZS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jICYmICFTSFNWT19SZXF1aXJlZEF0SWQpDQoJICAgIHsNCgkgICAgU0hTVk9fUmVxdWlyZWRBdElkID0gc3ZvbGluZS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jOw0KCSAgICBSZXF1aXJlZEF0ID0gdHJ1ZTsNCgkgICAgfQ0KCX0NCg0KICAgIGlmIChyZWNjbnQgPT0gMCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpKTsNCiAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgIHJldHVybjsNCgl9DQoNCiAgICBpZiAoIVJlcXVpcmVkQXQpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSk7DQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQoJfQ0KDQogICAgaWYgKHJlY2NudCA9PSAxKQkJLy8gSWYgb25seSBvbmUgbG9jYXRpb24gaXMgYXZhaWxhYmxlLCBwcmUtc2VsZWN0IGl0DQoJew0KCUxvY0xpc3Quc2VsZWN0ZWRJbmRleCA9IDA7DQoJU1ZNWElfU1ZPU2hwX1Nob3dQcm9kdWN0c0ZvckxvY2F0aW9uKExvY0xpc3QpOw0KCX0NCiAgICBlbHNlIHsgTG9jTGlzdC5zZWxlY3RlZEluZGV4ID0gLTE7IH0NCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOyANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLmhlaWdodCA9IDA7IA0KDQogICAgcmV0dXJuOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NWT1NocF9TaG93UHJvZHVjdHNGb3JMb2NhdGlvbihMb2NMaXN0KQ0Kew0KICAgIGlmIChMb2NMaXN0LnNlbGVjdGVkSW5kZXggPCAwKSB7IHJldHVybjsgfQkJLy8ganVzdCB0byBiZSBzYWZlDQoNCiAgICAvLyBHZXQgb3BlbiBTZXJ2aWNlIE9yZGVyIGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYywgIiArDQogICAgCQkiU1ZNWENfX0RhdGVfUmVxdWVzdGVkX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYywgU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jLCBTVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIFdIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBTSFNWT19TVk9JZCArICInIEFORCAiICsNCgkJIlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdPcGVuJyBBTkQgU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyA9ICciICsgTG9jTGlzdFtMb2NMaXN0LnNlbGVjdGVkSW5kZXhdLnZhbHVlICsgIiciOw0KICAgIHRyeSB7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICB9IGNhdGNoIChlKSB7IGFsZXJ0KGUpOyB9DQogICAgaWYgKHFyMi5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlcXJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHZhciByb3djbnQgPSAwOw0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoNCiAgICBTVk1YSV9TVk9TaHBfRHJhd0hlYWRlcih0Ym9keSk7DQoNCiAgICB3aGlsZShyZXFyZWNzLmhhc05leHQoKSkNCgl7DQoJdmFyIHJlcXJlYyA9IHJlcXJlY3MubmV4dCgpOw0KCXZhciByZXFpZCA9IHJlcXJlYy5JZDsNCgl2YXIgcHJvZGlkID0gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYyk7DQoNCglpZiAocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKSkNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKTsNCg0KCXZhciBSZW1RdHkgPSBSZXFRdHktU2hpcEluaXRRdHk7DQoNCglpZiAoUmVtUXR5ID4gMCkNCgkgICAgew0KCSAgICB2YXIgdHIgPSBtYWtlUm93KG1ha2VBdHRycyhyb3djbnQsdGJvZHkpICk7DQoJICAgIHRyLnNvYmplY3QgPSByZXFyZWM7DQoJICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCQkgICAgLy8gQ29sIDEuIFByb2R1Y3QgTmFtZQ0KCSAgICBjcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBwcm9kaWQgKyAiXCI+IiArIHByb2RpZCA/IHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lIDogIlVua25vd24iICsgIjwvYT4iOw0KDQoJCSAgICAvLyBDb2wgMi4gUmVtYWluaW5nIFF1YW50aXR5DQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSZW1RdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJlbVF0eVwiIHZhbHVlPVwiIiArIFJlbVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCAzLiBRdWFudGl0eSB0byBiZSBzaGlwcGVkDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJTaHBRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNocFF0eVwiIHZhbHVlPVwiIiArIFJlbVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCA0LiBRdWFudGl0eSBzaGlwbWVudCBpbml0aWF0ZWQgKGhpZGRlbiBmb3IgdXBkYXRlIGxhdGVyKQ0KCSAgICBjcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSAgICAiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBpZD1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwSW5pdFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJICAgIC8vIENvbCA1LiBTdGF0dXMgTWVzc2FnZQ0KCSAgICBjcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSAgICAiPGRpdiBpZD1cIiIgKyByZXFpZCArICJFcnJNc2dcIiBuYW1lPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCgkJICAgIC8vIENvbCA1LiBIaWRkZW4gZmllbGQgdG8gZ2V0IGEgaGFuZGxlIG9uIHRoZSBlbnRpcmUgcm93LiBObyBVSSBwdXJwb3NlDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGlkPVwicm93aWRcIiBuYW1lPVwicm93aWRcIj48L2lucHV0PiI7DQoNCgkgICAgcm93Y250ICs9IDE7DQoJICAgIH0NCgl9DQogICAgaWYgKHJvd2NudCA9PSAwKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TVk9TaHBfRHJhd0hlYWRlcih0YSkNCnsNCiAgICBjbGVhcl90YWJsZShudWxsKTsNCg0KICAgIHZhciB0ciA9IG1ha2VSb3coeydjbGFzcyc6J2hlYWRlclJvdyd9KTsNCiAgICB0YS5hcHBlbmRDaGlsZCh0cik7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDUiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA2IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNyIpKyI8L2E+IjsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TVk9TaHBfVmFsaWRhdGVBbmRQcm9jZXNzKCkNCnsNCiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxvY2F0aW9uTGlzdCIpLnNlbGVjdGVkSW5kZXggPCAwKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDExIikpOw0KCXJldHVybjsNCgl9DQoNCiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWydDcmVhdGVTaGlwbWVudEZyb21TVk8nXTsNCg0KICAgIHZhciBzb2JqZWN0TGlzdCA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKQ0KCXsNCglpZiAoZm9ybS5lbGVtZW50c1tpXS5uYW1lID09ICdyb3dpZCcpCQkvLyBOZWVkIGFuIGlkZW50aWZpZXIgdG8gcHJvY2VzcyBlYWNoIHJvdyBvbmx5IG9uY2UNCgkgICAgew0KCSAgICB2YXIgcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGU7DQoJICAgIHZhciBwcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCgkgICAgaWYgKHBwbi5zb2JqZWN0KQ0KCQl7DQoJCXNvYmplY3RMaXN0LnB1c2gocHBuLnNvYmplY3QpOw0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBza2lwY250ID0gMDsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHNvYmplY3RMaXN0Lmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlY19pbnZhbGlkID0gZmFsc2U7DQoJdmFyIHJlYyA9IHNvYmplY3RMaXN0W2tdOw0KCXZhciBSZW1RdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmVtUXR5IikudmFsdWUpOw0KCXZhciBTaHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hwUXR5IikudmFsdWUpOw0KCXZhciBFcnJNc2cgPSAiIjsNCglpZiAoaXNOYU4oU2hwUXR5KSB8fCBTaHBRdHkgPCAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpOyANCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKFNocFF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNraXBjbnQgKz0gMTsNCgkgICAgfQ0KCWVsc2UgaWYoU2hwUXR5ID4gUmVtUXR5KQ0KCSAgICB7DQoJICAgIEVyck1zZyA9U1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIik7IA0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKHJlY19pbnZhbGlkKQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSBFcnJNc2c7DQoJICAgIH0NCgllbHNlDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gIiI7DQoJICAgIH0NCgl9DQogICAgaWYoaW52YWxpZCkgeyByZXR1cm47IH0NCg0KICAgIGlmKHNraXBjbnQgPT0gc29iamVjdExpc3QubGVuZ3RoKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikpOw0KCXJldHVybjsNCgl9DQoNCiAgICBpZiAoU1ZNWElfU1ZPU2hwX0NyZWF0ZVNoaXBtZW50T3JkZXIoc29iamVjdExpc3QpKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikpOw0KCXdpbmRvdy5vcGVuZXIubG9jYXRpb24gPSAiLyIgKyBTaGlwbWVudE9yZGVySWQ7DQoJQ2xvc2VXaW5kb3coKTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU1ZPU2hwX0NyZWF0ZVNoaXBtZW50T3JkZXIoc29iamVjdExpc3QpDQp7DQogICAgdmFyIExvY0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTG9jYXRpb25MaXN0Iik7DQogICAgdmFyIGlkeCA9IExvY0xpc3Quc2VsZWN0ZWRJbmRleDsNCiAgICB2YXIgU291cmNlTG9jSWQgPSBMb2NMaXN0W2lkeF0udmFsdWU7DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgUk1BIEhlYWRlciAiU2hpcG1lbnQiDQogICAgdmFyIHNvcWwgPSAiU0VMRUNUIElkIEZST00gUmVjb3JkVHlwZSBXSEVSRSBTb2JqZWN0VHlwZSA9ICdTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jJyBBTkQgTmFtZSA9ICdTaGlwbWVudCciDQogICAgdmFyIHF1ZXJ5UmVzdWx0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KICAgIHZhciBydHJlY29yZHMgPSBxdWVyeVJlc3VsdC5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChydHJlY29yZHMubGVuZ3RoID09IDApIHsgICAgICAgDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOw0KICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICB2YXIgU2hpcG1lbnRIZHJSZWNvcmRUeXBlID0gcnRyZWNvcmRzWzBdLklkOw0KDQogICAgLy8gR2V0IFNhbGVzZm9yY2UgaW50ZXJuYWwgUmVjb3JkIFR5cGUgSUQgZm9yIFJNQSBMaW5lICJTaGlwbWVudCINCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYycgQU5EIE5hbWUgPSAnU2hpcG1lbnQnIg0KICAgIHZhciBxdWVyeVJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCiAgICB2YXIgcnRyZWNvcmRzID0gcXVlcnlSZXN1bHQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocnRyZWNvcmRzLmxlbmd0aCA9PSAwKSB7ICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsNCiAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgdmFyIFNoaXBtZW50TGluZVJlY29yZFR5cGUgPSBydHJlY29yZHNbMF0uSWQ7DQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KDQogICAgdmFyIHNocEhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyIpOw0KICAgIHNocEhkci5SZWNvcmRUeXBlSWQgPSBTaGlwbWVudEhkclJlY29yZFR5cGU7DQogICAgc2hwSGRyLlNWTVhDX19Db21wYW55X19jID0gU0hTVk9fQ29tcGFueUlkOw0KICAgIHNocEhkci5TVk1YQ19fQ2FzZV9fYyA9IFNIU1ZPX0Nhc2VJZDsNCiAgICBzaHBIZHIuU1ZNWENfX0NvbnRhY3RfX2MgPSBTSFNWT19Db250YWN0SWQ7DQogICAgc2hwSGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiT3BlbiI7DQogICAgc2hwSGRyLlNWTVhDX19FeHBlY3RlZF9EZWxpdmVyeV9EYXRlX19jID0gc29iamVjdExpc3RbMF0uU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2M7DQogICAgc2hwSGRyLlNWTVhDX19Tb3VyY2VfTG9jYXRpb25fX2MgPSBTb3VyY2VMb2NJZDsNCiAgICBzaHBIZHIuU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jID0gU0hTVk9fUmVxdWlyZWRBdElkOw0KICAgIHNocEhkci5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyA9IFNIU1ZPX093bmVySWQ7DQogICAgc2hwSGRyLlNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gU0hTVk9fU1ZPSWQ7DQogICAgdHJ5IHsNCiAgICAgICAgdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShbc2hwSGRyXSk7IA0KCQlpZiAocmV0WzBdLmdldEJvb2xlYW4oInN1Y2Nlc3MiKSkgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JldHVybiByZXRbMF0uaWQ7ICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZWxzZSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgfSAgDQoJfQ0KICAgIGNhdGNoKGVycm9yKSB7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE2IikrIlxuIisgZXJyb3IpOw0KCX0NCiAgICBTaGlwbWVudE9yZGVySWQgPSByZXRbMF0uaWQ7DQoNCiAgICAvLyBidWlsZCBhbiBhcnJheSBvZiBzaGlwbWVudCBsaW5lcw0KICAgIHZhciBzaHBsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIHZhciByZXFsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFNocFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaHBRdHkiKS52YWx1ZSk7DQoJdmFyIFJlbVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZW1RdHkiKS52YWx1ZSk7DQoJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KDQoJaWYgKFNocFF0eSA9PSAwKSB7IGNvbnRpbnVlOyB9CQkvLyBJdGVtIG5vdCBzaGlwcGVkLiBTa2lwLg0KDQoJdmFyIHNocExpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSBTaGlwbWVudE9yZGVySWQ7DQogICAgICAgIHNocExpbmUuUmVjb3JkVHlwZUlkID0gU2hpcG1lbnRMaW5lUmVjb3JkVHlwZTsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fUHJvZHVjdF9fYyA9IHJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fRXhwZWN0ZWRfU2hpcF9EYXRlX19jID0gcmVjLlNWTVhDX19EYXRlX1JlcXVpcmVkX19jOw0KCXNocExpbmUuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyA9IFNocFF0eTsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fU2hpcF9Mb2NhdGlvbl9fYyA9IFNIU1ZPX1JlcXVpcmVkQXRJZDsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiT3BlbiI7DQogICAgICAgIHNocExpbmUuU1ZNWENfX0xpbmVfVHlwZV9fYyA9ICJPdXRib3VuZCAoU2hpcG1lbnQpIjsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jID0gcmVjLklkOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gZmFsc2U7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2MgPSBTSFNWT19Pd25lcklkOw0KCQlzaHBMaW5lLlNWTVhDX19Vc2VfUHJpY2VfRnJvbV9QcmljZWJvb2tfX2MgPSAiRmFsc2UiOyAvL0J5IEdtIDE4SnVuMDgNCglzaHBsaW5lcy5wdXNoKHNocExpbmUpOw0KDQoJdmFyIHJlcWxpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCglyZXFsaW5lLklkID0gcmVjLklkOw0KCXJlcWxpbmUuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPSBTaGlwSW5pdFF0eSArIFNocFF0eTsNCglyZXFsaW5lcy5wdXNoKHJlcWxpbmUpOw0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHNocGxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTciKSsgIlxuIiArIGUpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KDQogICAgLy8gVXBkYXRlIHRoZSBTVk8gcGFydHMgcmVxdWVzdCBsaW5lcyB3aXRoIHNoaXBtZW50IGluaXRpYXRlZCBxdWFudGl0eQ0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHJlcWxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCiAgICAgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfU1ZPX0NhbmNlbFBhcnRzUmVxdWVzdChzZXJ2SWQsIHVJZCwgbGluZUlkKQ0Kew0KDQoJU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJXT1JEU0MxIik7DQoJU1ZNWElfU2V0TGFiZWxzKCJDYW5jZWxTVk9MaW5lUGFydHNSZXF1ZXN0Iik7DQoJDQoJDQogICAgQ05TVk9QUl9TVk9JZCA9IHNlcnZJZDsNCiAgICBDTlNWT1BSX1VzZXJJZCA9IHVJZDsNCiAgICBDTlNWT1BSX1NWT0xpbmVJZCA9IGxpbmVJZDsNCg0KICAgIC8vIEdldCBTZXJ2aWNlIE9yZGVyIGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fT3JkZXJfU3RhdHVzX19jIEZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgV0hFUkUgSWQgPSAnIiArIENOU1ZPUFJfU1ZPSWQgKyAiJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCgl7DQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDbG9zZWQiKQ0KICAgIAl7DQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiKQ0KICAgIAl7DQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgU2VydmljZSBvcmRlciAiUmVxdWVzdC9SZWNlaXB0Ig0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MnIEFORCBOYW1lID0gJ1JlcXVlc3QvUmVjZWlwdCciDQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsgDQogICAgdmFyIHJlYzIgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMi5sZW5ndGggPT0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOyAgICAgICANCgkgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCiAgICBSZXFSZWNvcmRUeXBlSWQgPSByZWMyWzBdLklkOw0KDQogICAgLy8gR2V0IG9wZW4gU2VydmljZSBPcmRlciBsaW5lcw0KICAgIHZhciBzb3FsMyA9ICJTRUxFQ1QgSWQsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsICIgKw0KICAgIAkJIlNWTVhDX19SZWNlaXZlZF9RdWFudGl0eTJfX2MsIFNWTVhDX19MaW5lX1N0YXR1c19fYyAiICsNCgkJIkZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyBXSEVSRSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyA9ICciICsgQ05TVk9QUl9TVk9JZCArICInICIgKw0KCQkiQU5EIFJlY29yZFR5cGVJZCA9ICciICsgUmVxUmVjb3JkVHlwZUlkICsgIiciOw0KICAgIGlmIChDTlNWT1BSX1NWT0xpbmVJZCkgeyBzb3FsMyA9IHNvcWwzICsgIiBBTkQgSWQgPSAnIiArIENOU1ZPUFJfU1ZPTGluZUlkICsgIiciOyB9DQogICAgdmFyIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICByZWNzID0gcXIzLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc3ZvbGluZXMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHJlY3MubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gcmVjc1trXTsNCg0KCWlmIChyZWMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID09ICJDb21wbGV0ZWQiIHx8IHJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYyA+IDAgfHwNCgkJCQkJcmVjLlNWTVhDX19SZWNlaXZlZF9RdWFudGl0eTJfX2MgPiAwIHx8IHJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPiAwKQ0KCSAgICB7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICBicmVhazsNCgkgICAgfQ0KCXZhciBzdm9saW5lID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIik7DQoJc3ZvbGluZS5JZCA9IHJlYy5JZDsNCglzdm9saW5lLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQoJc3ZvbGluZS5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCXN2b2xpbmUuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gQ05TVk9QUl9Vc2VySWQ7DQoJc3ZvbGluZXMucHVzaChzdm9saW5lKTsNCgl9DQoNCiAgICBpZiAoaW52YWxpZCkNCiAgICAJew0KCWlmIChDTlNWT1BSX1NWT0xpbmVJZCkNCgkgICAgew0KDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpKyJcbiIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikpOyANCgkJfQ0KCQkNCgllbHNlDQoJICAgIHsNCg0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSsiXG4iK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsgDQoJCX0NCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShzdm9saW5lcyk7DQoJfQ0KICAgIGNhdGNoIChlKSB7DQoNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgDQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsNCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NQUlJfU2hvd1JlcXVlc3RSZWNvcmRzKHJlcUlkLCByZXFOdW0sIHVJZCwgc2Vzc0lkKQ0Kew0KICAgIFNWTVhJX0luaXRNZXNzYWdlTGlzdCgiUFJFUVNDMyIpOw0KICAgIFNWTVhJX1NldExhYmVscygicHJvY3BycmVjZWlwdCIpOw0KDQogICAgUFBSUl9SZXF1ZXN0SWQgPSByZXFJZDsNCiAgICBQUFJSX1VzZXJJZCA9IHVJZDsNCiAgICBQUFJSX1BSTnVtYmVyID0gcmVxTnVtOw0KICAgIFBQUlJfU2Vzc2lvbklkID0gc2Vzc0lkOw0KDQogICAgLy8gR2V0IFBhcnRzIFJlcXVlc3QgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19TdGF0dXNfX2MsIFNWTVhDX19Db21wYW55X19jLCBTVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2MsIFNWTVhDX19SZXF1aXJlZF9BdF9Mb2NhdGlvbl9fYyAiICsNCgkJIkZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgV0hFUkUgSWQgPSAnIiArIFBQUlJfUmVxdWVzdElkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDb21wbGV0ZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIFBQUlJfU2l0ZUlkID0gcmVjMVswXS5TVk1YQ19fUmVxdWlyZWRfQXRfTG9jYXRpb25fX2M7DQogICAgUFBSUl9TdXBwbGllcklkID0gcmVjMVswXS5TVk1YQ19fQ29tcGFueV9fYzsNCiAgICBQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZSA9IHRydWU7DQoNCiAgICAvLyBJZiBzb3VyY2UgbG9jYXRpb24gaXMgbm90IGEgc3RvY2tpbmcgbG9jYXRpb24gYW5kIGEgc3VwcGxpZXIgbmFtZSBpcyBnaXZlbiwNCiAgICAvLyBpdCBpcyBpbXBsaWVkIHRoYXQgdGhlIHJlY2VpcHQgd2FzIGZyb20gYSBzdXBwbGllcg0KICAgIC8vIGFuZCBpdCBkb2VzIG5vdCBoYXZlIHRvIGJlIGFjY291bnRlZCBmb3IgaW4gaW52ZW50b3J5DQogICAgLy8gU28gd2UgY2hvb3NlIHRoZSBkZWZhdWx0IGludGVybmFsIGxvY2F0aW9uDQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX1JlcXVlc3RlZF9Gcm9tX19jICYmIFBQUlJfU3VwcGxpZXJJZCkgICAgICAgICAgICAgLy8gSFMgMDQvMjgvMjAwOA0KCXsNCgl2YXIgc29xbDQgPSAiU0VMRUNUIFNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19TaXRlX19jIFdIRVJFIElkID0gJyIgKyByZWMxWzBdLlNWTVhDX19SZXF1ZXN0ZWRfRnJvbV9fYyArICInIjsNCgl2YXIgcXI0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDQpOw0KCXZhciByZWM0ID0gcXI0LmdldEFycmF5KCJyZWNvcmRzIik7DQoJaWYgKHJlYzRbMF0uU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jID09ICJmYWxzZSIpDQoJICAgIHsNCgkgICAgdmFyIHNvcWwzID0gIlNFTEVDVCBJZCBGUk9NIFNWTVhDX19TaXRlX19jIFdIRVJFIE5hbWUgPSAnRGVmYXVsdCBTdXBwbGllciBMb2NhdGlvbiciOw0KCSAgICB2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KCSAgICBpZiAocXIzLnNpemUgPD0gMCkNCgkJCXsNCgkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCgkJCUNsb3NlV2luZG93KCk7DQoJCQlyZXR1cm47DQoJCQl9DQoJICAgIHZhciByZWMzID0gcXIzLmdldEFycmF5KCJyZWNvcmRzIik7DQoJICAgIFBQUlJfU291cmNlTG9jSWQgPSByZWMzWzBdLklkOw0KCSAgICBQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZSA9IGZhbHNlOw0KCSAgICB9DQoJfQ0KDQogICAgLy8gR2V0IG9wZW4gUGFydHMgUmVxdWVzdCBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYywgIiArDQogICAgCQkiU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsIFNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jLFNWTVhDX19Vbml0X1ByaWNlMl9fYyAiICsgDQoJCSJGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgPSAnIiArIFBQUlJfUmVxdWVzdElkICsgIicgQU5EICIgKw0KCQkiU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ09wZW4nIjsgLy9CeSBHbSAxOGp1bjA4IGFkZGVkIGZsZCA6IFNWTVhDX19Vbml0X1ByaWNlMl9fYyANCiAgICB0cnkgew0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQogICAgfSBjYXRjaCAoZSkgeyBhbGVydChlKTsgfQ0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZXFyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyMik7DQoNCiAgICB2YXIgcm93bnVtID0gMDsNCiAgICB2YXIgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KDQogICAgU1ZNWElfUHJvY1BSUl9EcmF3SGVhZGVyKHRib2R5KTsNCg0KICAgIHdoaWxlKHJlcXJlY3MuaGFzTmV4dCgpKQ0KCXsNCgl2YXIgcmVxcmVjID0gcmVxcmVjcy5uZXh0KCk7DQoNCgl2YXIgcmVxaWQgPSByZXFyZWMuSWQ7DQoJdmFyIHByb2RpZCA9IHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgUmVxUXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYyk7DQoNCglpZiAocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKSkNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykpDQoJICAgIHZhciBTaGlwUXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwUXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jKTsNCg0KCXZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd251bSx0Ym9keSkgKTsNCgl0ci5zb2JqZWN0ID0gcmVxcmVjOw0KCXRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCQkvLyBDb2wgMS4gUHJvZHVjdCBOYW1lDQoJY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCQkiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBwcm9kaWQgKyAiXCI+IiArIHByb2RpZCA/IHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lIDogIlVua25vd24iICsgIjwvYT4iOw0KDQoJCS8vIENvbCAyLiBSZXF1ZXN0ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSZXFRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJlcVF0eVwiIHZhbHVlPVwiIiArIFJlcVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDMuIFJlY2VpdmVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgcmVxaWQgKyAiUmN2UXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJSY3ZRdHlcIiB2YWx1ZT1cIiIgKyBSZXFRdHkgKyAiXCIgb25jaGFuZ2U9XCJTVk1YSV9Qcm9jUFJSX1ZhbGlkYXRlUXVhbnRpdHkodGhpcyk7XCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCA0LiBDaGVja2JveA0KCWNyZWF0ZVRhZyh0ciwidGQiLHsnY2xhc3MnOidhY3Rpb25Db2x1bW4nLCdhbGlnbic6J2NlbnRlcid9KS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IGNoZWNrZWQ9XCJ0cnVlXCIgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCIiICsgcmVxaWQgKyAiQ2hlY2tib3hcIiBuYW1lPVwiaWRzXCIgdmFsdWU9XCIiICsgcmVxaWQgKyAiXCIgPiZuYnNwOyI7DQoNCgkJLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGRpdiBpZD1cIiIgKyByZXFpZCArICJFcnJNc2dcIiBuYW1lPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCgkJLy8gQ29sIDYuIFNoaXBtZW50IEluaXRpYXRlZCBRdWFudGl0eQ0KCWNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJIjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgZGlzYWJsZWQ9XCJ0cnVlXCIgaWQ9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNoaXBJbml0UXR5XCIgdmFsdWU9XCIiICsgU2hpcEluaXRRdHkgKyAiXCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCA3LiBTaGlwcGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBkaXNhYmxlZD1cInRydWVcIiBpZD1cIiIgKyByZXFpZCArICJTaGlwUXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJTaGlwUXR5XCIgdmFsdWU9XCIiICsgU2hpcFF0eSArICJcIj48L2lucHV0PiI7DQoNCglyb3dudW0gKz0gMTsNCgl9DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7IA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUuaGVpZ2h0ID0gMDsgDQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1BSUl9WYWxpZGF0ZVF1YW50aXR5KGN0cmwpDQp7DQogICAgdmFyIHJlcWlkID0gY3RybC5uYW1lLnN1YnN0cmluZygwLDE4KTsNCiAgICB2YXIgcmVxcXR5bmFtZSA9IHJlcWlkICsgIlJlcVF0eSI7DQogICAgdmFyIHJlcXF0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcXF0eW5hbWUpOw0KDQogICAgaWYocGFyc2VGbG9hdChjdHJsLnZhbHVlKSA+PSBwYXJzZUZsb2F0KHJlcXF0eS52YWx1ZSkpDQogICAgCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5jaGVja2VkID0gdHJ1ZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IHRydWU7DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSBmYWxzZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IGZhbHNlOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUFJSX0RyYXdIZWFkZXIodGEpDQp7DQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pOw0KICAgIHRhLmFwcGVuZENoaWxkKHRyKTsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iICsgU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA1IikgKyAiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIgKyBTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDYiKSArICI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IiArIFNWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNyIpICsgIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIgKyBTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDgiKSArICI8L2E+IjsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUFJSX1ZhbGlkYXRlQW5kUHJvY2VzcygpDQp7DQogICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sncHJvY3BycmVjZWlwdCddOw0KDQogICAgdmFyIHNvYmplY3RMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspDQoJew0KCWlmIChmb3JtLmVsZW1lbnRzW2ldLm5hbWUgPT0gJ2lkcycpDQoJICAgIHsNCgkgICAgdmFyIHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlOw0KCSAgICB2YXIgcHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlLnBhcmVudE5vZGU7DQoJICAgIGlmIChwcG4uc29iamVjdCkNCgkJew0KCQlzb2JqZWN0TGlzdC5wdXNoKHBwbi5zb2JqZWN0KTsNCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgdmFyIHZhbGlkX3JlY2VpcHRzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc2tpcGNudCA9IDA7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBzb2JqZWN0TGlzdC5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWNfaW52YWxpZCA9IGZhbHNlOw0KCXZhciByZWMgPSBzb2JqZWN0TGlzdFtrXTsNCgl2YXIgU2hpcFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaGlwUXR5IikudmFsdWUpOw0KCXZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaGlwSW5pdFF0eSIpLnZhbHVlKTsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJjdlF0eSIpLnZhbHVlKTsNCgl2YXIgUmVxUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJlcVF0eSIpLnZhbHVlKTsNCgl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KCS8vYWxlcnQoImNoZWNrZWQ9IiArIGNoZWNrZWQgKyAiLCBSZXFRdHk9IiArIFJlcVF0eSArICIsIFJjdlF0eT0iICsgUmN2UXR5ICsgIiwgU2hpcEluaXRRdHk9IiArIFNoaXBJbml0UXR5ICsgIiwgU2hpcFF0eT0iICsgU2hpcFF0eSk7DQoJdmFyIEVyck1zZyA9ICIiOw0KCWlmIChpc05hTihSY3ZRdHkpIHx8IFJjdlF0eSA8IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3Iik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmICghY2hlY2tlZCAmJiBSY3ZRdHkgPT0gMCkNCgkgICAgew0KCSAgICBza2lwY250ICs9IDE7DQoJICAgIH0NCgllbHNlIGlmKFJjdlF0eSA+IFJlcVF0eSkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKGNoZWNrZWQgJiYgUmN2UXR5IDwgUmVxUXR5ICYmIFNoaXBRdHkgPiAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoY2hlY2tlZCAmJiBSY3ZRdHkgPCBSZXFRdHkgJiYgU2hpcEluaXRRdHkgPiAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKHJlY19pbnZhbGlkKQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSBFcnJNc2c7DQoJICAgIH0NCgllbHNlDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gIiI7DQoJICAgIH0NCglpZiAoIXJlY19pbnZhbGlkICYmIFJjdlF0eSA+IDApDQoJICAgIHZhbGlkX3JlY2VpcHRzLnB1c2gocmVjKTsNCgl9DQogICAgaWYoaW52YWxpZCkgeyByZXR1cm47IH0NCg0KICAgIGlmKHNraXBjbnQgPT0gc29iamVjdExpc3QubGVuZ3RoKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDExIikpOw0KCXJldHVybjsNCgl9DQoNCiAgICBQUFJSX1JlY2VpcHRzID0gdmFsaWRfcmVjZWlwdHM7CQkvLyBQcm9jZXNzIG9ubHkgcmVjb3JkcyB3aXRoIGEgdmFsaWQgcmVjZWlwdCBxdWFudGl0eQ0KICAgIFNWTVhJX1Byb2NQUlJfUHJvY2Vzc1JlY2VpcHRzKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1BSUl9Qcm9jZXNzUmVjZWlwdHMoKQ0Kew0KICAgIHZhciBQcm9kQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoUFBSUl9SZWNlaXB0cy5sZW5ndGgsIDYpOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUFBSUl9SZWNlaXB0cy5sZW5ndGg7IGkrKykNCgl7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFBSUl9SZWNlaXB0c1tpXS5JZCsiUmN2UXR5IikudmFsdWUpOw0KCVByb2RBcnJheVtpXVswXSA9IFBQUlJfUmVjZWlwdHNbaV0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJUHJvZEFycmF5W2ldWzFdID0gUmN2UXR5Ow0KCVByb2RBcnJheVtpXVsyXSA9IFBQUlJfU2l0ZUlkOw0KCVByb2RBcnJheVtpXVszXSA9ICJJbiBUcmFuc2l0IjsNCglpZiAoUFBSUl9Tb3VyY2VMb2NTdG9ja2FibGUgPT0gdHJ1ZSkNCgkgICAgUHJvZEFycmF5W2ldWzJdID0gUFBSUl9TaXRlSWQ7DQoJZWxzZQ0KCSAgICBQcm9kQXJyYXlbaV1bMl0gPSBQUFJSX1NvdXJjZUxvY0lkOw0KCVByb2RBcnJheVtpXVs1XSA9ICJBdmFpbGFibGUiOw0KCX0NCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJQYXJ0cyBSZWNlaXB0IiwgUFBSUl9QUk51bWJlciwgUFBSUl9Vc2VySWQsIFBQUlJfU2Vzc2lvbklkKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9DYWxsYmFja19Qcm9jZXNzUFJSZWNlaXB0cyhTZXJpYWxTZWxlY3RTdGF0dXMsIFNlcmlhbENvdW50LCBTZXJpYWxBcnJheSkNCnsNCiAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICBpZiAoIVNlcmlhbFNlbGVjdFN0YXR1cykNCiAgICAJew0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCg0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgUFBSUl9SZWNlaXB0cy5sZW5ndGg7IGorKykNCiAgICAJew0KCXZhciBQcm9kSWQgPSBQUFJSX1JlY2VpcHRzW2pdLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBQUlJfUmVjZWlwdHNbal0uSWQrIlJjdlF0eSIpLnZhbHVlKTsNCg0KCS8vIERlY3JlYXNlIEluIFRyYW5zaXQgc3RvY2sgaW4gdGhlIHRhcmdldCBsb2NhdGlvbg0KCWlmIChQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZSA9PSB0cnVlKQ0KCSAgICB2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBQUlJfU2l0ZUlkLCAiSW4gVHJhbnNpdCIsIFJjdlF0eSwgIlBhcnRzIFJlY2VpcHQiLCBQUFJSX1BSTnVtYmVyLCAiRGVjcmVhc2UiLCBQUFJSX1JlcXVlc3RJZCwgUFBSUl9SZWNlaXB0c1tqXS5JZCwgUFBSUl9Vc2VySWQpOw0KCWVsc2UNCgkgICAgdmFyIEZyb21TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUFJSX1NvdXJjZUxvY0lkLCAiUHVyY2hhc2VkIiwgUmN2UXR5LCAiUGFydHMgUmVjZWlwdCIsIFBQUlJfUFJOdW1iZXIsICJJbmNyZWFzZSIsIFBQUlJfUmVxdWVzdElkLCBQUFJSX1JlY2VpcHRzW2pdLklkLCBQUFJSX1VzZXJJZCk7DQoJaWYgKCFGcm9tU3RvY2tBcnJbMF0pDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikgKyAiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIEZyb21Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEluY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgdGFyZ2V0IGxvY2F0aW9uDQoJdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFBSUl9TaXRlSWQsICJBdmFpbGFibGUiLCBSY3ZRdHksICJQYXJ0cyBSZWNlaXB0IiwgUFBSUl9QUk51bWJlciwgIkluY3JlYXNlIiwgUFBSUl9SZXF1ZXN0SWQsIFBQUlJfUmVjZWlwdHNbal0uSWQsIFBQUlJfVXNlcklkKTsNCglpZiAoIVRvU3RvY2tBcnJbMF0pDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikgKyAiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIFRvUHJvZFN0b2NrSWQgPSBGcm9tU3RvY2tBcnJbMV07CQkvLyBETyBOT1QgQ0hBTkdFIFRISVMuIFRoaXMgaXMgYSBKYXZhc2NyaXB0IGJ1Zy4NCgkJCQkJCQkvLyBGb3Igc29tZSBteXN0ZXJpb3VzIHJlYXNvbiwgdGhlIHByb2R1Y3Qtc3RvY2staWQNCgkJCQkJCQkvLyBmb3IgZGVzdGluYXRpb24gbG9jYXRpb24gaXMgc2V0IGluIEZyb21TdG9ja0FyclsxXQ0KCQkJCQkJCS8vIGluc3RlYWQgb2YgVG9TdG9ja0FyclsxXSBldmVuIHRob3VnaCB0aGUgY29kZQ0KCQkJCQkJCS8vIGV4cGxpY2l0bHkgdXNlcyBUb1N0b2NrQXJyLiBEb24ndCBsb3NlIHNsZWVwIG92ZXIgdGhpcy4NCgkJCQkJCQkvLyBIUyAwNC8yOC8yMDA4DQoNCgkvLyBCdWlsZCBzZXJpYWwgbnVtYmVyIGFycmF5IGZvciB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkNCglpZiAoU2VyaWFsQ291bnQgPiAwKQ0KCSAgICB7DQoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgU2VyaWFsQ291bnQ7IGsrKykNCgkJew0KCQlpZiAoU2VyaWFsQXJyYXlba11bMF0gPT0gUHJvZElkKQ0KCQkgICAgew0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzBdID0gUHJvZElkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzFdID0gRnJvbVByb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCQkgICAgdG90cSsrOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgc2VyaWFsIG51bWJlcnMgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFBQUlJfVXNlcklkKTsgfQ0KDQogICAgLy8gQnVpbGQgYXJyYXlzIGZvciB1cGRhdGluZyBQYXJ0cyBSZXF1ZXN0IGxpbmVzIGFzIHdlbGwgYXMgY3JlYXRpbmcgbmV3IHJlcXVlc3QgbGluZXMgaWYgYXBwbGljYWJsZQ0KICAgIHZhciBuZXdjbnQgPSAwOw0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgcmVxbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgcmVxbGluZXNpbnMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBtID0gMDsgbSA8IFBQUlJfUmVjZWlwdHMubGVuZ3RoOyBtKyspDQogICAgCXsNCgl2YXIgcmVxbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyIpOw0KCXZhciByZWMgPSBQUFJSX1JlY2VpcHRzW21dOw0KCXZhciBTaGlwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBRdHkiKS52YWx1ZSk7DQoJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmN2UXR5IikudmFsdWUpOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmVxUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoNCglyZXFsaW5ldXBkLklkID0gcmVjLklkOw0KCXJlcWxpbmV1cGQuU1ZNWENfX1F1YW50aXR5X1JlY2VpdmVkMl9fYyA9IFJjdlF0eTsNCglyZXFsaW5ldXBkLlNWTVhDX19EYXRlX1JlY2VpdmVkX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCg0KCXJlcWxpbmV1cGQuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSB0cnVlOw0KCWlmIChjaGVja2VkICYmIFJjdlF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHJlcWxpbmV1cGQuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCgkgICAgcmVxbGluZXVwZC5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICByZXFsaW5ldXBkLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IFBQUlJfVXNlcklkOw0KCSAgICB9DQoJZWxzZSBpZiAoUmN2UXR5ID4gMCkNCgkgICAgew0KCSAgICByZXFsaW5ldXBkLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDb21wbGV0ZWQiOw0KCSAgICByZXFsaW5ldXBkLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICByZXFsaW5ldXBkLlNWTVhDX19DbG9zZWRfQnlfX2MgPSBQUFJSX1VzZXJJZDsNCgkgICAgfQ0KCXJlcWxpbmVzdXBkLnB1c2gocmVxbGluZXVwZCk7DQoNCgkvL2FsZXJ0KCJQcm9kOiAiICsgUFBSUl9SZWNlaXB0c1ttXS5TVk1YQ19fUHJvZHVjdF9fci5OYW1lICsgIiwgY2hlY2tlZD0iICsgY2hlY2tlZCArICIsIFJjdjogIiArIFJjdlF0eSArICIsIFJlcTogIiArIFJlcVF0eSk7DQoNCgkvLyBQYXJ0IGlzIHBhcnRpYWxseSByZWNlaXZlZCBhbmQgdXNlciBkb2VzIG5vdCB3YW50IHRvIGNsb3NlIHRoZSByZXF1ZXN0IHlldC4gQ3JlYXRlIGEgbmV3IGxpbmUgZm9yIHJlbWFpbmluZyBxdHkuDQoJaWYgKCFjaGVja2VkICYmIFJjdlF0eSA8IFJlcVF0eSkNCgkgICAgew0KCSAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQoJICAgIHZhciBkYXRlc3RyID0gQ29udmVydERhdGVUb1NGRENEYXRlKGN1cmRhdGUpOw0KCSAgICB2YXIgc2ZkY2RhdGVzdHIgPSByZWMuU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2M7DQoJICAgIHZhciBzZmRjZGF0ZSA9IG5ldyBEYXRlKHNmZGNkYXRlc3RyLnN1YnN0cmluZygwLDQpLCBwYXJzZUZsb2F0KHNmZGNkYXRlc3RyLnN1YnN0cmluZyg1LDcpKS0xLCBzZmRjZGF0ZXN0ci5zdWJzdHJpbmcoOCkpOw0KDQoJICAgIHZhciByZXFsaW5laW5zID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIik7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgPSByZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2M7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX1Byb2R1Y3RfX2MgPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYyA9IFJlcVF0eSAtIFJjdlF0eTsNCgkgICAgaWYgKHNmZGNkYXRlID4gY3VyZGF0ZSkNCgkJcmVxbGluZWlucy5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYyA9IHNmZGNkYXRlc3RyOw0KCSAgICBlbHNlDQoJCXJlcWxpbmVpbnMuU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2MgPSBkYXRlc3RyOw0KCSAgICByZXFsaW5laW5zLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJPcGVuIjsNCgkgICAgcmVxbGluZWlucy5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IGZhbHNlOw0KCSAgICByZXFsaW5laW5zLlNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jID0gcmVjLlNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jOw0KCSAgICByZXFsaW5laW5zLlNWTVhDX19Vbml0X1ByaWNlMl9fYyA9IHJlYy5TVk1YQ19fVW5pdF9QcmljZTJfX2M7IC8vQlkgR00gMThKdW4wOA0KCSAgICByZXFsaW5laW5zLlNWTVhDX19Vc2VfUHJpY2VfRnJvbV9QcmljZWJvb2tfX2MgPSAiRmFsc2UiOyAvL0JZIEdNIDE4SnVuMDgNCgkgICAgcmVxbGluZXNpbnMucHVzaChyZXFsaW5laW5zKTsNCgkgICAgbmV3Y250ICs9IDE7DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgcmVjZWlwdCBpbmZvcm1hdGlvbiBvbiBwYXJ0cyByZXF1ZXN0cw0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHJlcWxpbmVzdXBkKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KDQogICAgLy8gQ3JlYXRlIG5ldyBwYXJ0cyByZXF1ZXN0cyBpZiBhcHBsaWNhYmxlDQogICAgaWYgKG5ld2NudCA+IDApDQogICAgCXsNCgl0cnkgew0KCSAgICB2YXIgcmV0eCA9IHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShyZXFsaW5lc2lucyk7DQoJICAgIH0NCgljYXRjaCAoZSkgew0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCS8vIFRvIHVwZGF0ZSBQYXJ0cyBSZXF1ZXN0IGhlYWRlciBzdGF0dXMuLi4NCgkvLyBjaGVjayBpZiBhbGwgbGluZXMgaGF2ZSBiZWVuIGNvbXBsZXRlZCBvciBjYW5jZWxlZCBieSBjb21wYXJpbmcgY291bnRzDQoJdmFyIHNvcWwyID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgUFBSUl9SZXF1ZXN0SWQgKyAiJyI7DQoJcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KDQoJdmFyIHNvcWwzID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgUFBSUl9SZXF1ZXN0SWQgKyAiJyBBTkQgU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ0NvbXBsZXRlZCciOw0KCXFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCg0KCXZhciBzb3FsNCA9ICJTRUxFQ1QgQ291bnQoKSBGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgPSAnIiArIFBQUlJfUmVxdWVzdElkICsgIicgQU5EIFNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdDYW5jZWxlZCciOw0KCXFyNCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWw0KTsNCg0KCXZhciByZXFoZHIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X19jIik7DQoJcmVxaGRyLklkID0gUFBSUl9SZXF1ZXN0SWQ7DQoNCgl2YXIgaGRydXBkID0gZmFsc2U7DQoJaWYgKHFyMi5zaXplID09IHFyMy5zaXplKQkJLy8gQWxsIGxpbmVzIGNvbXBsZXRlZA0KCSAgICB7DQoJICAgIHJlcWhkci5TVk1YQ19fU3RhdHVzX19jID0gIkNvbXBsZXRlZCI7DQoJICAgIHJlcWhkci5TVk1YQ19fQ2xvc2VkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgcmVxaGRyLlNWTVhDX19DbG9zZWRfQnlfX2MgPSBQUFJSX1VzZXJJZDsNCgkgICAgaGRydXBkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKHFyMi5zaXplID09IHFyNC5zaXplKQkvLyBBbGwgbGluZXMgQ2FuY2VsZWQNCgkgICAgew0KCSAgICByZXFoZHIuU1ZNWENfX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQoJICAgIHJlcWhkci5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICByZXFoZHIuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gUFBSUl9Vc2VySWQ7DQoJICAgIGhkcnVwZCA9IHRydWU7DQoJICAgIH0NCglpZiAoaGRydXBkKQ0KCSAgICB7DQoJICAgIHRyeSB7DQoJCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbcmVxaGRyXSk7DQoJCX0NCgkgICAgY2F0Y2ggKGUpIHsNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSk7DQoJCUNsb3NlV2luZG93KCk7DQoJCXJldHVybiBmYWxzZTsNCgkJfQ0KCSAgICB9DQoJfQ0KICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpKTsNCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTVk9fU2hvd1JlcXVlc3RSZWNvcmRzKHNlcnZJZCwgc3ZvbnVtLCB1SWQsIGxpbmVJZCwgc2Vzc0lkKQ0Kew0KICAgIFNWTVhJX0luaXRNZXNzYWdlTGlzdCgiV09SRFNDOSIpOyANCiAgICBTVk1YSV9TZXRMYWJlbHMoIlByb2Nlc3NSZWNlaXB0c0ZvclNWTyIpOyAgDQoNCg0KICAgIFBSU1ZPX1NWT0lkID0gc2VydklkOw0KICAgIFBSU1ZPX1VzZXJJZCA9IHVJZDsNCiAgICBQUlNWT19TVk9MaW5lSWQgPSBsaW5lSWQ7DQogICAgUFJTVk9fU1ZPTnVtYmVyID0gc3ZvbnVtOw0KICAgIFBSU1ZPX1Nlc3Npb25JZCA9IHNlc3NJZDsNCg0KICAgIC8vIEdldCBTVk8gaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19PcmRlcl9TdGF0dXNfX2MgRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyBXSEVSRSBJZCA9ICciICsgUFJTVk9fU1ZPSWQgKyAiJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCgl7DQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDbG9zZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgU2VydmljZSBvcmRlciAiUmVxdWVzdC9SZWNlaXB0Ig0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYycgQU5EIE5hbWUgPSAnUmVxdWVzdC9SZWNlaXB0JyINCiAgICB2YXIgcXVlcnlSZXN1bHQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQogICAgdmFyIHJ0cmVjb3JkcyA9IHF1ZXJ5UmVzdWx0LmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJ0cmVjb3Jkcy5sZW5ndGggPT0gMCkNCgl7ICAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTAiKSk7DQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQoJfQ0KICAgIFBSU1ZPX1JlcVJlY29yZFR5cGVJZCA9IHJ0cmVjb3Jkc1swXS5JZDsNCg0KICAgIC8vIEdldCBvcGVuIFNWTyBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYywgIiArDQogICAgCQkiU1ZNWENfX0RhdGVfUmVxdWVzdGVkX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYywgU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jLCAiICsNCiAgICAJCSJTVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jLCAiKw0KICAgICAgICAgICAgIlNWTVhDX19SZXF1ZXN0ZWRfWmlwX19jLCBTVk1YQ19fUmVxdWVzdGVkX1N0cmVldF9fYyxTVk1YQ19fUmVxdWVzdGVkX1N0YXRlX19jLCBTVk1YQ19fUmVxdWVzdGVkX0NvdW50cnlfX2MsIFNWTVhDX19SZXF1ZXN0ZWRfQ2l0eV9fYywgIisNCgkJCSJTVk1YQ19fUmVjZWl2ZWRfWmlwX19jLCAgU1ZNWENfX1JlY2VpdmVkX1N0cmVldF9fYywgU1ZNWENfX1JlY2VpdmVkX1N0YXRlX19jLCAgU1ZNWENfX1JlY2VpdmVkX0NvdW50cnlfX2MsIFNWTVhDX19SZWNlaXZlZF9DaXR5X19jICAiICsNCgkJIkZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyBXSEVSRSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyA9ICciICsgUFJTVk9fU1ZPSWQgKyAiJyBBTkQgIiArDQoJCSJTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnT3BlbicgQU5EIFJlY29yZFR5cGVJZCA9ICciICsgUFJTVk9fUmVxUmVjb3JkVHlwZUlkICsgIiciOw0KICAgIGlmIChQUlNWT19TVk9MaW5lSWQpIHsgc29xbDIgPSBzb3FsMiArICIgQU5EIElkID0gJyIgKyBQUlNWT19TVk9MaW5lSWQgKyAiJyIgfSA7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCgl7DQoJaWYgKFBSU1ZPX1NWT0xpbmVJZCkNCgkJewkgICAgDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMSIpKTsNCgkJfQ0KCWVsc2UNCgkgICAgewkNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIikpOw0KCQl9DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZXFyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyMik7DQoNCiAgICB2YXIgcm93bnVtID0gMDsNCiAgICB2YXIgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KDQogICAgU1ZNWElfUHJvY1NWT19EcmF3SGVhZGVyKHRib2R5KTsNCg0KICAgIHZhciBub2xvYyA9IDA7DQogICAgd2hpbGUocmVxcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciByZXFyZWMgPSByZXFyZWNzLm5leHQoKTsNCg0KCWlmICghcmVxcmVjLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MpDQoJICAgIHsNCgkgICAgbm9sb2MgKz0gMTsNCgkgICAgY29udGludWU7DQoJICAgIH0NCg0KCXZhciByZXFpZCA9IHJlcXJlYy5JZDsNCgl2YXIgcHJvZGlkID0gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYyk7DQoNCglpZiAocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKSkNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jID09IG51bGwgfHwgaXNOYU4ocmVxcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykpDQoJICAgIHZhciBTaGlwUXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBTaGlwUXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jKTsNCg0KCXZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd251bSx0Ym9keSkgKTsNCgl0ci5zb2JqZWN0ID0gcmVxcmVjOw0KCXRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCQkvLyBDb2wgMS4gUHJvZHVjdCBOYW1lDQoJY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCQkiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBwcm9kaWQgKyAiXCI+IiArIHByb2RpZCA/IHJlcXJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lIDogIlVua25vd24iICsgIjwvYT4iOw0KDQoJCS8vIENvbCAyLiBSZXF1ZXN0ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSZXFRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJlcVF0eVwiIHZhbHVlPVwiIiArIFJlcVF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDMuIFJlY2VpdmVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgcmVxaWQgKyAiUmN2UXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJSY3ZRdHlcIiB2YWx1ZT1cIiIgKyBSZXFRdHkgKyAiXCIgb25jaGFuZ2U9XCJTVk1YSV9Qcm9jU1ZPX1ZhbGlkYXRlUXVhbnRpdHkodGhpcyk7XCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCA0LiBDaGVja2JveA0KCWNyZWF0ZVRhZyh0ciwidGQiLHsnY2xhc3MnOidhY3Rpb25Db2x1bW4nLCdhbGlnbic6J2NlbnRlcid9KS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IGNoZWNrZWQ9XCJ0cnVlXCIgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCIiICsgcmVxaWQgKyAiQ2hlY2tib3hcIiBuYW1lPVwiaWRzXCIgdmFsdWU9XCIiICsgcmVxaWQgKyAiXCIgPiZuYnNwOyI7DQoNCgkJLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGRpdiBpZD1cIiIgKyByZXFpZCArICJFcnJNc2dcIiBuYW1lPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCgkJLy8gQ29sIDYuIFNoaXBtZW50IEluaXRpYXRlZCBRdWFudGl0eQ0KCWNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJIjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgZGlzYWJsZWQ9XCJ0cnVlXCIgaWQ9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNoaXBJbml0UXR5XCIgdmFsdWU9XCIiICsgU2hpcEluaXRRdHkgKyAiXCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCA3LiBTaGlwcGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBkaXNhYmxlZD1cInRydWVcIiBpZD1cIiIgKyByZXFpZCArICJTaGlwUXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJTaGlwUXR5XCIgdmFsdWU9XCIiICsgU2hpcFF0eSArICJcIj48L2lucHV0PiI7DQoNCglyb3dudW0gKz0gMTsNCgl9DQoNCiAgICBpZiAobm9sb2MgPiAwKQ0KICAgIAl7DQoJaWYgKHJvd251bSA+IDApCQkJICAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSk7DQoJZWxzZQ0KCSAgICB7DQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNCIpKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuOw0KCSAgICB9DQoJfQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOyANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLmhlaWdodCA9IDA7IA0KfQ0KDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NWT19WYWxpZGF0ZVF1YW50aXR5KGN0cmwpDQp7DQogICAgdmFyIHJlcWlkID0gY3RybC5uYW1lLnN1YnN0cmluZygwLDE4KTsNCiAgICB2YXIgcmVxcXR5bmFtZSA9IHJlcWlkICsgIlJlcVF0eSI7DQogICAgdmFyIHJlcXF0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcXF0eW5hbWUpOw0KDQogICAgaWYocGFyc2VGbG9hdChjdHJsLnZhbHVlKSA+PSBwYXJzZUZsb2F0KHJlcXF0eS52YWx1ZSkpDQogICAgCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5jaGVja2VkID0gdHJ1ZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IHRydWU7DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSBmYWxzZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXFpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IGZhbHNlOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jU1ZPX0RyYXdIZWFkZXIodGEpDQp7DQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pOw0KICAgIHRhLmFwcGVuZENoaWxkKHRyKTsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNSIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDYiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiAiK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNyIpKyIgIDwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA4IikrIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTVk9fVmFsaWRhdGVBbmRQcm9jZXNzKCkNCnsNCiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWydQcm9jZXNzUmVjZWlwdHNGb3JTVk8nXTsNCg0KICAgIHZhciBzb2JqZWN0TGlzdCA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKQ0KCXsNCglpZiAoZm9ybS5lbGVtZW50c1tpXS5uYW1lID09ICdpZHMnKQ0KCSAgICB7DQoJICAgIHZhciBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZTsNCgkgICAgdmFyIHBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KCSAgICBpZiAocHBuLnNvYmplY3QpDQoJCXsNCgkJc29iamVjdExpc3QucHVzaChwcG4uc29iamVjdCk7DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIHZhciB2YWxpZF9yZWNlaXB0cyA9IG5ldyBBcnJheSgpOw0KICAgIHZhciBpbnZhbGlkID0gZmFsc2U7DQogICAgdmFyIHNraXBjbnQgPSAwOw0KICAgIGludmFsaWQgPSBmYWxzZTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHNvYmplY3RMaXN0Lmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlY19pbnZhbGlkID0gZmFsc2U7DQoJdmFyIHJlYyA9IHNvYmplY3RMaXN0W2tdOw0KCXZhciBTaGlwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBRdHkiKS52YWx1ZSk7DQoJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmN2UXR5IikudmFsdWUpOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmVxUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoJLy9hbGVydCgiY2hlY2tlZD0iICsgY2hlY2tlZCArICIsIFJlcVF0eT0iICsgUmVxUXR5ICsgIiwgUmN2UXR5PSIgKyBSY3ZRdHkgKyAiLCBTaGlwSW5pdFF0eT0iICsgU2hpcEluaXRRdHkgKyAiLCBTaGlwUXR5PSIgKyBTaGlwUXR5KTsNCgl2YXIgRXJyTXNnID0gIiI7DQoJaWYgKGlzTmFOKFJjdlF0eSkgfHwgUmN2UXR5IDwgMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKTsgDQoJCQ0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoIWNoZWNrZWQgJiYgUmN2UXR5ID09IDApDQoJICAgIHsNCgkgICAgc2tpcGNudCArPSAxOw0KCSAgICB9DQoJZWxzZSBpZihSY3ZRdHkgPiBSZXFRdHkpDQoJICAgIHsNCgkgICAgRXJyTXNnID0gIFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoY2hlY2tlZCAmJiBSY3ZRdHkgPCBSZXFRdHkgJiYgU2hpcFF0eSA+IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1Iik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmIChjaGVja2VkICYmIFJjdlF0eSA8IFJlcVF0eSAmJiBTaGlwSW5pdFF0eSA+IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2Iik7IA0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKHJlY19pbnZhbGlkKQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSBFcnJNc2c7DQoJICAgIH0NCgllbHNlDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gIiI7DQoJICAgIH0NCglpZiAoIXJlY19pbnZhbGlkICYmIFJjdlF0eSA+IDApDQoJICAgIHZhbGlkX3JlY2VpcHRzLnB1c2gocmVjKTsNCgl9DQoNCiAgICBpZihpbnZhbGlkKSB7IHJldHVybjsgfQ0KDQogICAgaWYoc2tpcGNudCA9PSBzb2JqZWN0TGlzdC5sZW5ndGgpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikpOw0KCXJldHVybjsNCgl9DQoNCiAgICBQUlNWT19SZWNlaXB0cyA9IHZhbGlkX3JlY2VpcHRzOw0KICAgIFNWTVhJX1Byb2NTVk9fUHJvY2Vzc1JlY2VpcHRzKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NWT19Qcm9jZXNzUmVjZWlwdHMoKQ0Kew0KICAgIHZhciBQcm9kQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoUFJTVk9fUmVjZWlwdHMubGVuZ3RoLCA2KTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBSU1ZPX1JlY2VpcHRzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUlNWT19SZWNlaXB0c1tpXS5JZCsiUmN2UXR5IikudmFsdWUpOw0KCVByb2RBcnJheVtpXVswXSA9IFBSU1ZPX1JlY2VpcHRzW2ldLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2RBcnJheVtpXVsxXSA9IFJjdlF0eTsNCglQcm9kQXJyYXlbaV1bMl0gPSBQUlNWT19SZWNlaXB0c1tpXS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jOw0KCVByb2RBcnJheVtpXVszXSA9ICJJbiBUcmFuc2l0IjsNCglQcm9kQXJyYXlbaV1bNF0gPSBQUlNWT19SZWNlaXB0c1tpXS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jOw0KCVByb2RBcnJheVtpXVs1XSA9ICJBdmFpbGFibGUiOw0KCX0NCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJTVk8gUmVjZWlwdCIsIFBSU1ZPX1NWT051bWJlciwgUFJTVk9fVXNlcklkLCBQUlNWT19TZXNzaW9uSWQpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX0NhbGxiYWNrX1Byb2Nlc3NTVk9SZWNlaXB0cyhTZXJpYWxTZWxlY3RTdGF0dXMsIFNlcmlhbENvdW50LCBTZXJpYWxBcnJheSkNCnsNCiAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICBpZiAoIVNlcmlhbFNlbGVjdFN0YXR1cykNCiAgICAJew0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCiAgICB2YXIgdG90cSA9IDA7DQogICAgdmFyIFNlcmlhbFNhdmVBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShTZXJpYWxDb3VudCwgNCk7DQoNCiAgICBmb3IgKHZhciBqID0gMDsgaiA8IFBSU1ZPX1JlY2VpcHRzLmxlbmd0aDsgaisrKQ0KICAgIAl7DQoJdmFyIFByb2RJZCA9IFBSU1ZPX1JlY2VpcHRzW2pdLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSU1ZPX1JlY2VpcHRzW2pdLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoNCgkvLyBEZWNyZWFzZSBJbiBUcmFuc2l0IHN0b2NrIGluIHRoZSB0YXJnZXQgbG9jYXRpb24NCgl2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBSU1ZPX1JlY2VpcHRzW2pdLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MsICJJbiBUcmFuc2l0IiwgUmN2UXR5LCAiU1ZPIFJlY2VpcHQiLCBQUlNWT19TVk9OdW1iZXIsICJEZWNyZWFzZSIsIFBSU1ZPX1NWT0lkLCBQUlNWT19SZWNlaXB0c1tqXS5JZCwgUFJTVk9fVXNlcklkKTsNCglpZiAoIUZyb21TdG9ja0FyclswXSkNCgkgICAgewkNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikrIlxuIiArIEZyb21TdG9ja0Fycls0XSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCXZhciBGcm9tUHJvZFN0b2NrSWQgPSBGcm9tU3RvY2tBcnJbMV07DQoNCgkvLyBJbmNyZWFzZSBBdmFpbGFibGUgc3RvY2sgaW4gdGhlIHRhcmdldCBsb2NhdGlvbg0KCXZhciBUb1N0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBSU1ZPX1JlY2VpcHRzW2pdLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MsICJBdmFpbGFibGUiLCBSY3ZRdHksICJTVk8gUmVjZWlwdCIsIFBSU1ZPX1NWT051bWJlciwgIkluY3JlYXNlIiwgUFJTVk9fU1ZPSWQsIFBSU1ZPX1JlY2VpcHRzW2pdLklkLCBQUlNWT19Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikrIlxuIiArIEZyb21TdG9ja0Fycls0XSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCXZhciBUb1Byb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gQnVpbGQgc2VyaWFsIG51bWJlciBhcnJheSBmb3IgdGhlIHJlY2VpdmVkIHF1YW50aXR5DQoJaWYgKFNlcmlhbENvdW50ID4gMCkNCgkgICAgew0KCSAgICBmb3IgKHZhciBrID0gMDsgayA8IFNlcmlhbENvdW50OyBrKyspDQoJCXsNCgkJaWYgKFNlcmlhbEFycmF5W2tdWzBdID09IFByb2RJZCAmJiBTZXJpYWxBcnJheVtrXVs0XSA9PSBQUlNWT19SZWNlaXB0c1tqXS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jKQ0KCQkgICAgew0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzBdID0gUHJvZElkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzFdID0gRnJvbVByb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCQkgICAgdG90cSsrOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgc2VyaWFsIG51bWJlcnMgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFBSU1ZPX1VzZXJJZCk7IH0NCg0KICAgIHZhciBuZXdjbnQgPSAwOw0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgc3ZvbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgc3ZvbGluZXNpbnMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBtID0gMDsgbSA8IFBSU1ZPX1JlY2VpcHRzLmxlbmd0aDsgbSsrKQ0KICAgIAl7DQoJCQl2YXIgc3ZvbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyIpOw0KCQkJdmFyIHJlYyA9IFBSU1ZPX1JlY2VpcHRzW21dOw0KCQkJdmFyIFNoaXBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcFF0eSIpLnZhbHVlKTsNCgkJCXZhciBTaGlwSW5pdFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaGlwSW5pdFF0eSIpLnZhbHVlKTsNCgkJCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmN2UXR5IikudmFsdWUpOw0KCQkJdmFyIFJlcVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZXFRdHkiKS52YWx1ZSk7DQoJCQl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KDQoJCQlzdm9saW5ldXBkLklkID0gcmVjLklkOw0KCQkJc3ZvbGluZXVwZC5TVk1YQ19fUmVjZWl2ZWRfUXVhbnRpdHkyX19jID0gUmN2UXR5Ow0KCQkJc3ZvbGluZXVwZC5TVk1YQ19fRGF0ZV9SZWNlaXZlZF9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoNCgkJCXN2b2xpbmV1cGQuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSB0cnVlOw0KCQkJaWYgKGNoZWNrZWQgJiYgUmN2UXR5ID09IDApDQoJCQkJew0KCQkJCXN2b2xpbmV1cGQuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCgkJCQlzdm9saW5ldXBkLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJCQkJc3ZvbGluZXVwZC5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBQUlNWT19Vc2VySWQ7DQoJCQkJfQ0KCQkJZWxzZSBpZiAoUmN2UXR5ID4gMCkNCgkJCQl7DQoJCQkJc3ZvbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ29tcGxldGVkIjsNCgkJCQlzdm9saW5ldXBkLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCQkJCXN2b2xpbmV1cGQuU1ZNWENfX0Nsb3NlZF9CeV9fYyA9IFBSU1ZPX1VzZXJJZDsNCgkJCQl9DQoJCQlzdm9saW5lc3VwZC5wdXNoKHN2b2xpbmV1cGQpOw0KDQoJCQkvLyBQYXJ0IGlzIHBhcnRpYWxseSByZWNlaXZlZCBhbmQgdXNlciBkb2VzIG5vdCB3YW50IHRvIGNsb3NlIHRoZSByZXF1ZXN0IHlldC4gQ3JlYXRlIGEgbmV3IGxpbmUgZm9yIHJlbWFpbmluZyBxdHkuDQoJCQ0KCQkJaWYgKCFjaGVja2VkICYmIFJjdlF0eSA8IFJlcVF0eSkNCgkJCQl7DQoJCQkJdmFyIHN2b2xpbmVpbnMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCgkJCQlzdm9saW5laW5zLlJlY29yZFR5cGVJZCA9IFBSU1ZPX1JlcVJlY29yZFR5cGVJZDsNCgkJCQlzdm9saW5laW5zLlNWTVhDX19MaW5lX1R5cGVfX2MgPSAiUGFydHMiOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgPSBQUlNWT19TVk9JZDsNCgkJCQlzdm9saW5laW5zLlNWTVhDX19Qcm9kdWN0X19jID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlcXVlc3RlZF9RdWFudGl0eTJfX2MgPSBSZXFRdHkgLSBSY3ZRdHk7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fRGF0ZV9SZXF1ZXN0ZWRfX2MgPSByZWMuU1ZNWENfX0RhdGVfUmVxdWVzdGVkX19jOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIk9wZW4iOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSBmYWxzZTsNCgkJCQkvL3N2b2xpbmVpbnMuU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyA9IHJlYy5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jIDsgIA0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyAgICAgPSByZWMuU1ZNWENfX1JlcXVlc3RlZF9Gcm9tX19jOwkJCSAvLyBBZGRlZCAgb24gNi1TZXAtMDggIGJ5IFNkCQkNCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZXF1ZXN0ZWRfWmlwX19jICAgIAk9IHJlYy5TVk1YQ19fUmVxdWVzdGVkX1ppcF9fYzsgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX1N0cmVldF9fYyAJPSByZWMuU1ZNWENfX1JlcXVlc3RlZF9TdHJlZXRfX2M7IDsNCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZXF1ZXN0ZWRfU3RhdGVfX2MgCT0gcmVjLlNWTVhDX19SZXF1ZXN0ZWRfU3RhdGVfX2M7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX0NvdW50cnlfX2MgCT0gcmVjLlNWTVhDX19SZXF1ZXN0ZWRfQ291bnRyeV9fYzsgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX0NpdHlfX2MgCT0gcmVjLlNWTVhDX19SZXF1ZXN0ZWRfQ2l0eV9fYzsgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVjZWl2ZWRfWmlwX19jIAkJPSByZWMuU1ZNWENfX1JlY2VpdmVkX1ppcF9fYzsgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVjZWl2ZWRfU3RyZWV0X19jIAk9IHJlYy5TVk1YQ19fUmVjZWl2ZWRfU3RyZWV0X19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZWNlaXZlZF9TdGF0ZV9fYyAJPSByZWMuU1ZNWENfX1JlY2VpdmVkX1N0YXRlX19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZWNlaXZlZF9Db3VudHJ5X19jIAk9IHJlYy5TVk1YQ19fUmVjZWl2ZWRfQ291bnRyeV9fYzsgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVjZWl2ZWRfQ2l0eV9fYyAJCT0gcmVjLlNWTVhDX19SZWNlaXZlZF9DaXR5X19jOw0KCQkJCQ0KCQkJCXN2b2xpbmVzaW5zLnB1c2goc3ZvbGluZWlucyk7DQoJCQkJbmV3Y250ICs9IDE7DQoJCQkJfQ0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHN2b2xpbmVzdXBkKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE2IikrIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQoNCiAgICBpZiAobmV3Y250ID4gMCkNCiAgICAJew0KCXRyeSB7DQoJICAgIHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShzdm9saW5lc2lucyk7DQoJICAgIH0NCgljYXRjaCAoZSkgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE3IikrIlxuIiArIGUpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9ICAgDQogICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE4IikpOwkJCQkNCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTaHBfU2hvd1NoaXBtZW50UmVjb3JkcyhzaHBJZCwgc2hwTnVtLCB1SWQsIHNlc3NJZCkNCnsNCiAgICBTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlBPUkRTQzgiKTsgDQogICAgU1ZNWElfU2V0TGFiZWxzKCJQcm9jZXNzU2hpcG1lbnRzIik7ICANCgkNCiAgICBQUlNIUF9TaGlwbWVudE9yZGVySWQgPSBzaHBJZDsNCiAgICBQUlNIUF9Vc2VySWQgPSB1SWQ7DQogICAgUFJTSFBfU2hpcG1lbnROdW1iZXIgPSBzaHBOdW07DQogICAgUFJTSFBfU2Vzc2lvbklkID0gc2Vzc0lkOw0KDQogICAgLy8gR2V0IFBhcnRzIFJlcXVlc3QgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19PcmRlcl9TdGF0dXNfX2MsIFNWTVhDX19Tb3VyY2VfTG9jYXRpb25fX2MsIFNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYywgIiArDQogICAgCQkiU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYyAiICsNCiAgICAJCSJGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgV0hFUkUgSWQgPSAnIiArIFBSU0hQX1NoaXBtZW50T3JkZXJJZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNsb3NlZCIpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAoIXJlYzFbMF0uU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYykNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIC8vIE5vdCBuZWVkZWQgYW55bW9yZS4gRGVzdGluYXRpb24gbG9jYXRpb24gaXMgb3B0aW9uYWwgaW4gdGhlIHNoaXBtZW50IHBhZ2UgbGF5b3V0DQogICAgLy8gSFMgMDQvMjgvMjAwOA0KICAgIC8vaWYgKCFyZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYykNCiAgICAvLwl7DQovLwkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KLy8JCUNsb3NlV2luZG93KCk7DQovLwkJcmV0dXJuOw0KLy8JfQ0KICAgIFBSU0hQX1NvdXJjZUxvY0lkID0gcmVjMVswXS5TVk1YQ19fU291cmNlX0xvY2F0aW9uX19jOw0KICAgIFBSU0hQX0Rlc3RMb2NJZCA9IHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYykNCiAgICAJUFJTSFBfRGVzdExvY1N0b2NrYWJsZSA9IHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYzsNCg0KICAgIC8vIElmIGRlc3RpbmF0aW9uIGxvY2F0aW9uIGlzIGJsYW5rIG9yIGlmIGl0IGlzIG5vdCBhIHN0b2NraW5nIGxvY2F0aW9uLA0KICAgIC8vIGl0IGlzIGltcGxpZWQgdGhhdCB0aGUgc2hpcG1lbnQgaXMgZGlyZWN0bHkgbWFkZSB0byB0aGUgY3VzdG9tZXIgDQogICAgLy8gYW5kIGl0IGRvZXMgbm90IGhhdmUgdG8gYmUgYWNjb3VudGVkIGZvciBpbiBpbnZlbnRvcnkNCiAgICAvLyBTbyB3ZSBjaG9vc2UgdGhlIGludGVybmFsIGxvY2F0aW9uDQogICAgaWYgKFBSU0hQX0Rlc3RMb2NJZCA9PSBudWxsIHx8IFBSU0hQX0Rlc3RMb2NJZC5sZW5ndGggPD0gMCB8fCByZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fci5TVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MgPT0gImZhbHNlIikNCiAgICAJew0KCXZhciBzb3FsMyA9ICJTRUxFQ1QgSWQgRlJPTSBTVk1YQ19fU2l0ZV9fYyBXSEVSRSBOYW1lID0gJ0RlZmF1bHQgQ3VzdG9tZXIgTG9jYXRpb24nIjsNCgl2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KCWlmIChxcjMuc2l6ZSA8PSAwKQ0KCSAgICB7DQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuOw0KCSAgICB9DQoJdmFyIHJlYzMgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCglQUlNIUF9EZXN0TG9jSWQgPSByZWMzWzBdLklkOw0KCVBSU0hQX0Rlc3RMb2NTdG9ja2FibGUgPSBmYWxzZTsNCgl9DQoNCiAgICAvLyBHZXQgb3BlbiBTaGlwbWVudCBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFJlY29yZFR5cGVJZCwgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MsICIgKw0KICAgIAkJIlNWTVhDX19FeHBlY3RlZF9TaGlwX0RhdGVfX2MsIFNWTVhDX19MaW5lX1R5cGVfX2MsIFNWTVhDX19QYWNraW5nX0luc3RydWN0aW9uc19fYywgIiArDQogICAgCQkiU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYywgU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsICIgKw0KCQkiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYywgU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsU1ZNWENfX0xpbmVfUHJpY2UyX19jICwgU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2MgLFNWTVhDX19TYWxlc19PcmRlcl9OdW1iZXJfX2MgIiArDQoJCSJGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBQUlNIUF9TaGlwbWVudE9yZGVySWQgKyAiJyBBTkQgIiArDQoJCSJTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnT3BlbiciOyAvL0J5IEdtIDE4SnVuMDggQWRkZWQgOiBTVk1YQ19fTGluZV9QcmljZTJfX2MNCgkJDQoJIA0KCQkNCgkJDQogICAgdHJ5IHsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIH0gY2F0Y2ggKGUpIHsgYWxlcnQoZSk7IH0NCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCgl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHNocHJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHZhciByb3dudW0gPSAwOw0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoNCiAgICBTVk1YSV9Qcm9jU2hwX0RyYXdIZWFkZXIodGJvZHkpOw0KDQogICAgd2hpbGUoc2hwcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciBzaHByZWMgPSBzaHByZWNzLm5leHQoKTsNCg0KCXZhciBzaHBpZCA9IHNocHJlYy5JZDsNCgl2YXIgcHJvZGlkID0gc2hwcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCWlmIChzaHByZWMuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyA9PSBudWxsIHx8IGlzTmFOKHNocHJlYy5TVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jKSkNCgkgICAgdmFyIEV4cFF0eSA9IDA7DQoJZWxzZQ0KCSAgICB2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChzaHByZWMuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyk7DQoNCgl2YXIgdHIgPSBtYWtlUm93KG1ha2VBdHRycyhyb3dudW0sdGJvZHkpICk7DQoJdHIuc29iamVjdCA9IHNocHJlYzsNCgl0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQoNCgkJLy8gQ29sIDEuIFByb2R1Y3QgTmFtZQ0KCWNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkJIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgcHJvZGlkICsgIlwiPiIgKyBwcm9kaWQgPyBzaHByZWMuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIiArICI8L2E+IjsNCg0KCQkvLyBDb2wgMi4gUmVxdWVzdGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IGRpc2FibGVkPVwidHJ1ZVwiIHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgc2hwaWQgKyAiRXhwUXR5XCIgbmFtZT1cIiIgKyBzaHBpZCArICJFeHBRdHlcIiB2YWx1ZT1cIiIgKyBFeHBRdHkgKyAiXCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCAzLiBTaGlwcGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgc2hwaWQgKyAiU2hwUXR5XCIgbmFtZT1cIiIgKyBzaHBpZCArICJTaHBRdHlcIiB2YWx1ZT1cIiIgKyBFeHBRdHkgKyAiXCIgb25jaGFuZ2U9XCJTVk1YSV9Qcm9jU2hwX1ZhbGlkYXRlUXVhbnRpdHkodGhpcyk7XCI+PC9pbnB1dD4iOw0KDQoJCS8vIENvbCA0LiBDaGVja2JveA0KCWNyZWF0ZVRhZyh0ciwidGQiLHsnY2xhc3MnOidhY3Rpb25Db2x1bW4nLCdhbGlnbic6J2NlbnRlcid9KS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IGNoZWNrZWQ9XCJ0cnVlXCIgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCIiICsgc2hwaWQgKyAiQ2hlY2tib3hcIiBuYW1lPVwiaWRzXCIgdmFsdWU9XCIiICsgc2hwaWQgKyAiXCIgPiZuYnNwOyI7DQoNCgkJLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGRpdiBpZD1cIiIgKyBzaHBpZCArICJFcnJNc2dcIiBuYW1lPVwiIiArIHNocGlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCglyb3dudW0gKz0gMTsNCgl9DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7IA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUuaGVpZ2h0ID0gMDsgDQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NocF9WYWxpZGF0ZVF1YW50aXR5KGN0cmwpDQp7DQogICAgdmFyIHNocGlkID0gY3RybC5uYW1lLnN1YnN0cmluZygwLDE4KTsNCiAgICB2YXIgZXhwcXR5bmFtZSA9IHNocGlkICsgIkV4cFF0eSI7DQogICAgdmFyIGV4cHF0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV4cHF0eW5hbWUpOw0KDQogICAgaWYocGFyc2VGbG9hdChjdHJsLnZhbHVlKSA+PSBwYXJzZUZsb2F0KGV4cHF0eS52YWx1ZSkpDQogICAgCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzaHBpZCsiQ2hlY2tib3giKS5jaGVja2VkID0gdHJ1ZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzaHBpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IHRydWU7DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNocGlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSBmYWxzZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzaHBpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IGZhbHNlOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jU2hwX0RyYXdIZWFkZXIodGEpDQp7DQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pOw0KICAgIHRhLmFwcGVuZENoaWxkKHRyKTsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNSIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDYiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA3IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA4IikrIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTaHBfVmFsaWRhdGVBbmRQcm9jZXNzKCkNCnsNCiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWydQcm9jZXNzU2hpcG1lbnRzJ107DQoNCiAgICB2YXIgc29iamVjdExpc3QgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgZm9ybS5lbGVtZW50cy5sZW5ndGg7IGkrKykNCgl7DQoJaWYgKGZvcm0uZWxlbWVudHNbaV0ubmFtZSA9PSAnaWRzJykNCgkgICAgew0KCSAgICB2YXIgcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGU7DQoJICAgIHZhciBwcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCgkgICAgaWYgKHBwbi5zb2JqZWN0KQ0KCQl7DQoJCXNvYmplY3RMaXN0LnB1c2gocHBuLnNvYmplY3QpOw0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICB2YXIgdmFsaWRfc2hpcG1lbnRzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc2tpcGNudCA9IDA7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBzb2JqZWN0TGlzdC5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWNfaW52YWxpZCA9IGZhbHNlOw0KCXZhciByZWMgPSBzb2JqZWN0TGlzdFtrXTsNCgl2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkV4cFF0eSIpLnZhbHVlKTsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNocFF0eSIpLnZhbHVlKTsNCgl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KCS8vYWxlcnQoImNoZWNrZWQ9IiArIGNoZWNrZWQgKyAiLCBFeHBRdHk9IiArIEV4cFF0eSArICIsIFNocFF0eT0iICsgU2hwUXR5KTsNCgl2YXIgRXJyTXNnID0gIiI7DQoJaWYgKGlzTmFOKFNocFF0eSkgfHwgU2hwUXR5IDwgMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKCFjaGVja2VkICYmIFNocFF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNraXBjbnQgKz0gMTsNCgkgICAgfQ0KCWVsc2UgaWYoU2hwUXR5ID4gRXhwUXR5KQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKHJlY19pbnZhbGlkKQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSBFcnJNc2c7DQoJICAgIH0NCgllbHNlDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gIiI7DQoJICAgIH0NCglpZighcmVjX2ludmFsaWQgJiYgU2hwUXR5ID4gMCkNCgkgICAgdmFsaWRfc2hpcG1lbnRzLnB1c2gocmVjKTsNCgl9DQogICAgaWYoaW52YWxpZCkgeyByZXR1cm47IH0NCg0KICAgIGlmKHNraXBjbnQgPT0gc29iamVjdExpc3QubGVuZ3RoKQ0KICAgIAl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMSIpKTsNCglyZXR1cm47DQoJfQ0KDQogICAgUFJTSFBfU2hpcG1lbnRzID0gdmFsaWRfc2hpcG1lbnRzOw0KICAgIFNWTVhJX1Byb2NTaHBfUHJvY2Vzc1NoaXBtZW50cygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTaHBfUHJvY2Vzc1NoaXBtZW50cygpDQp7DQogICAgdmFyIFByb2RBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShQUlNIUF9TaGlwbWVudHMubGVuZ3RoLCA2KTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBSU0hQX1NoaXBtZW50cy5sZW5ndGg7IGkrKykNCgl7DQoJdmFyIFNocFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJTSFBfU2hpcG1lbnRzW2ldLklkKyJTaHBRdHkiKS52YWx1ZSk7DQoJUHJvZEFycmF5W2ldWzBdID0gUFJTSFBfU2hpcG1lbnRzW2ldLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2RBcnJheVtpXVsxXSA9IFNocFF0eTsNCglQcm9kQXJyYXlbaV1bMl0gPSBQUlNIUF9Tb3VyY2VMb2NJZDsNCglQcm9kQXJyYXlbaV1bM10gPSAiQXZhaWxhYmxlIjsNCglQcm9kQXJyYXlbaV1bNF0gPSBQUlNIUF9EZXN0TG9jSWQ7DQoJUHJvZEFycmF5W2ldWzVdID0gIkluIFRyYW5zaXQiOw0KCX0NCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJTaGlwbWVudCIsIFBSU0hQX1NoaXBtZW50TnVtYmVyLCBQUlNIUF9Vc2VySWQsIFBSU0hQX1Nlc3Npb25JZCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1NoaXBtZW50KFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgUFJTSFBfU2hpcG1lbnRzLmxlbmd0aDsgaisrKQ0KICAgIAl7DQoJdmFyIFByb2RJZCA9IFBSU0hQX1NoaXBtZW50c1tqXS5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUlNIUF9TaGlwbWVudHNbal0uSWQrIlNocFF0eSIpLnZhbHVlKTsNCg0KCS8vIERlY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgc291cmNlIGxvY2F0aW9uDQoJdmFyIEZyb21TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUlNIUF9Tb3VyY2VMb2NJZCwgIkF2YWlsYWJsZSIsIFNocFF0eSwgIlNoaXBtZW50IiwgUFJTSFBfU2hpcG1lbnROdW1iZXIsICJEZWNyZWFzZSIsIFBSU0hQX1NoaXBtZW50T3JkZXJJZCwgUFJTSFBfU2hpcG1lbnRzW2pdLklkLCBQUlNIUF9Vc2VySWQpOw0KCWlmICghRnJvbVN0b2NrQXJyWzBdKQ0KCSAgICB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsJCQ0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl2YXIgRnJvbVByb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gSWYgdGFyZ2V0IGxvY2F0aW9uIGlzIG5vdCBzdG9ja2FibGUsIGl0IG1lYW5zIHRoZSBzaGlwbWVudCB3YXMgbWFkZSB0byBhIGN1c3RvbWVyIGxvY2F0aW9uLiBDb25zaWRlciB0aGUgcXVhbnRpdHkgYXMgQ29uc3VtZWQNCgkvLyBJZiB0YXJnZXQgbG9jYXRpb24gaXMgc3RvY2thYmxlLCBpdCBtdXN0IGJlIGFuIGludGVybmFsIGxvY2F0aW9uLiBDb25zaWRlciB0aGUgcXVhbnRpdHkgdG8gYmUgSW4gVHJhbnNpdCANCglpZiAoUFJTSFBfRGVzdExvY1N0b2NrYWJsZSA9PSBmYWxzZSkNCgkgICAgdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFJTSFBfRGVzdExvY0lkLCAiQ29uc3VtZWQiLCBTaHBRdHksICJTaGlwbWVudCIsIFBSU0hQX1NoaXBtZW50TnVtYmVyLCAiSW5jcmVhc2UiLCBQUlNIUF9TaGlwbWVudE9yZGVySWQsIFBSU0hQX1NoaXBtZW50c1tqXS5JZCwgUFJTSFBfVXNlcklkKTsNCgllbHNlDQoJICAgIHZhciBUb1N0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBSU0hQX0Rlc3RMb2NJZCwgIkluIFRyYW5zaXQiLCBTaHBRdHksICJTaGlwbWVudCIsIFBSU0hQX1NoaXBtZW50TnVtYmVyLCAiSW5jcmVhc2UiLCBQUlNIUF9TaGlwbWVudE9yZGVySWQsIFBSU0hQX1NoaXBtZW50c1tqXS5JZCwgUFJTSFBfVXNlcklkKTsNCglpZiAoIVRvU3RvY2tBcnJbMF0pDQoJICAgIHsJICAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsJCQ0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl2YXIgVG9Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSBzaGlwcGVkIHF1YW50aXR5DQoJaWYgKFNlcmlhbENvdW50ID4gMCkNCgkgICAgew0KCSAgICBmb3IgKHZhciBrID0gMDsgayA8IFNlcmlhbENvdW50OyBrKyspDQoJCXsNCgkJaWYgKFNlcmlhbEFycmF5W2tdWzBdID09IFByb2RJZCAmJiBTZXJpYWxBcnJheVtrXVs0XSA9PSBQUlNIUF9EZXN0TG9jSWQpDQoJCSAgICB7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMF0gPSBQcm9kSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMV0gPSBGcm9tUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMl0gPSBUb1Byb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzNdID0gU2VyaWFsQXJyYXlba11bN107DQoJCSAgICB0b3RxKys7DQoJCSAgICB9DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSBzZXJpYWwgbnVtYmVycyBmb3IgdGhlIHNoaXBwZWQgcXVhbnRpdHkNCiAgICBpZiAoU2VyaWFsQ291bnQgPiAwKSB7IHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNhdmUoU2VyaWFsU2F2ZUFycmF5LCBQUlNIUF9Vc2VySWQpOyB9DQoNCiAgICB2YXIgbmV3Y250ID0gMDsNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIHJlcWxpbmVzdXBkID0gbmV3IEFycmF5KCk7DQogICAgdmFyIHN2b2xpbmVzdXBkID0gbmV3IEFycmF5KCk7DQogICAgdmFyIHNocGxpbmVzdXBkID0gbmV3IEFycmF5KCk7DQogICAgdmFyIHNocGxpbmVzaW5zID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBQUlNIUF9TaGlwbWVudHMubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgc2hwbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIik7DQoJdmFyIHJlYyA9IFBSU0hQX1NoaXBtZW50c1trXTsNCgl2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkV4cFF0eSIpLnZhbHVlKTsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNocFF0eSIpLnZhbHVlKTsNCgl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KDQoJc2hwbGluZXVwZC5JZCA9IHJlYy5JZDsNCglzaHBsaW5ldXBkLlNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jID0gU2hwUXR5Ow0KCXNocGxpbmV1cGQuU1ZNWENfX0FjdHVhbF9TaGlwX0RhdGVfX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCXNocGxpbmV1cGQuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSB0cnVlOw0KCWlmIChjaGVja2VkICYmIFNocFF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNocGxpbmV1cGQuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCgkgICAgc2hwbGluZXVwZC5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICBzaHBsaW5ldXBkLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IFBSU0hQX1VzZXJJZDsNCgkgICAgfQ0KCWVsc2UgaWYgKFNocFF0eSA+IDApDQoJICAgIHsNCgkgICAgc2hwbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ29tcGxldGVkIjsNCgkgICAgc2hwbGluZXVwZC5TVk1YQ19fQ2xvc2VkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgc2hwbGluZXVwZC5TVk1YQ19fQ2xvc2VkX0J5X19jID0gUFJTSFBfVXNlcklkOw0KCSAgICB9DQoJc2hwbGluZXN1cGQucHVzaChzaHBsaW5ldXBkKTsNCg0KCS8vIFVwZGF0ZSByZWxhdGVkIG9iamVjdCAoU2VydmljZSBvcmRlciBvciBQYXJ0cyBSZXF1ZXN0KQ0KCWlmIChyZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYykNCgkgICAgew0KCSAgICB2YXIgcmVxbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyIpOw0KCSAgICByZXFsaW5ldXBkLklkID0gcmVjLlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2M7DQoJICAgIGlmKCFyZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpDQoJCXsgcmVxbGluZXVwZC5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPSBTaHBRdHk7IH0NCgkgICAgZWxzZQ0KCQl7IHJlcWxpbmV1cGQuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jID0gcGFyc2VGbG9hdChyZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpICsgU2hwUXR5OyB9DQoJICAgIHJlcWxpbmVzdXBkLnB1c2gocmVxbGluZXVwZCk7DQoJICAgIH0NCgllbHNlIGlmIChyZWMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYykNCgkgICAgew0KCSAgICB2YXIgc3ZvbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyIpOw0KCSAgICBzdm9saW5ldXBkLklkID0gcmVjLlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2M7DQoJICAgIGlmKCFyZWMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpDQoJCXsgc3ZvbGluZXVwZC5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPSBTaHBRdHk7IH0NCgkgICAgZWxzZQ0KCQl7IHN2b2xpbmV1cGQuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jID0gcGFyc2VGbG9hdChyZWMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fci5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpICsgU2hwUXR5OyB9DQoJICAgIHN2b2xpbmVzdXBkLnB1c2goc3ZvbGluZXVwZCk7DQoJICAgIH0NCg0KCS8vIFBhcnQgaXMgcGFydGlhbGx5IHNoaXBwZWQgYW5kIHVzZXIgZG9lcyBub3Qgd2FudCB0byBjbG9zZSB0aGUgc2hpcG1lbnQgeWV0LiBDcmVhdGUgYSBuZXcgbGluZSBmb3IgcmVtYWluaW5nIHF0eS4NCglpZiAoIWNoZWNrZWQgJiYgU2hwUXR5IDwgRXhwUXR5KQ0KCSAgICB7DQoJICAgIHZhciBzaHBsaW5laW5zID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MiKTsNCgkgICAgc2hwbGluZWlucy5TVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gUFJTSFBfU2hpcG1lbnRPcmRlcklkOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19Qcm9kdWN0X19jID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCSAgICBzaHBsaW5laW5zLlJlY29yZFR5cGVJZCA9IHJlYy5SZWNvcmRUeXBlSWQ7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX0xpbmVfVHlwZV9fYyA9IHJlYy5TVk1YQ19fTGluZV9UeXBlX19jOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MgPSBFeHBRdHkgLSBTaHBRdHk7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX0V4cGVjdGVkX1NoaXBfRGF0ZV9fYyA9IHJlYy5TVk1YQ19fRXhwZWN0ZWRfU2hpcF9EYXRlX19jOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJPcGVuIjsNCgkgICAgc2hwbGluZWlucy5TVk1YQ19fUGFja2luZ19JbnN0cnVjdGlvbnNfX2MgPSByZWMuU1ZNWENfX1BhY2tpbmdfSW5zdHJ1Y3Rpb25zX19jOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgPSByZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYzsNCgkgICAgc2hwbGluZWlucy5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jID0gcmVjLlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2M7DQoJCXNocGxpbmVpbnMuU1ZNWENfX0xpbmVfUHJpY2UyX19jID0gcmVjLlNWTVhDX19MaW5lX1ByaWNlMl9fYzsgLy9CeSBHbSAxOEp1bjA4DQoJCXNocGxpbmVpbnMuU1ZNWENfX1VzZV9QcmljZV9Gcm9tX1ByaWNlYm9va19fYyA9ICJGYWxzZSI7IC8vQnkgR20gMThKdW4wOA0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gZmFsc2U7CQkNCgkJc2hwbGluZWlucy5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyAgPSByZWMuU1ZNWENfX1NlcnZpY2VfRW5naW5lZXJfX2M7DQoJCXNocGxpbmVpbnMuU1ZNWENfX1NhbGVzX09yZGVyX051bWJlcl9fYyA9IHJlYy5TVk1YQ19fU2FsZXNfT3JkZXJfTnVtYmVyX19jOw0KCQkNCgkgICAgc2hwbGluZXNpbnMucHVzaChzaHBsaW5laW5zKTsNCgkgICAgbmV3Y250ICs9IDE7DQoJICAgIH0NCgl9DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShzaHBsaW5lc3VwZCk7DQoJfQ0KICAgIGNhdGNoIChlKSB7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMyIpKyJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCgl9DQoNCiAgICBpZiAocmVxbGluZXN1cGQubGVuZ3RoID4gMCkNCiAgICAJew0KCXRyeSB7DQoJICAgIHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShyZXFsaW5lc3VwZCk7DQoJICAgIH0NCgljYXRjaCAoZSkgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikrIlxuIiArIGUpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9DQogICAgZWxzZSBpZiAoc3ZvbGluZXN1cGQubGVuZ3RoID4gMCkNCiAgICAJew0KCXRyeSB7DQoJICAgIHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShzdm9saW5lc3VwZCk7DQoJICAgIH0NCgljYXRjaCAoZSkgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikrIlxuIiArIGUpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9DQoNCiAgICBpZiAobmV3Y250ID4gMCkNCiAgICAJew0KCXRyeSB7DQoJICAgIHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShzaHBsaW5lc2lucyk7DQoJICAgIH0NCgljYXRjaCAoZSkgewkNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE2IikrIlxuIiArIGUpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJLy8gVG8gdXBkYXRlIFNoaXBtZW50IGhlYWRlciBzdGF0dXMuLi4NCgkvLyBjaGVjayBpZiBhbGwgbGluZXMgaGF2ZSBiZWVuIGNvbXBsZXRlZCBvciBjYW5jZWxlZCBieSBjb21wYXJpbmcgY291bnRzDQoJdmFyIHNvcWwyID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIFBSU0hQX1NoaXBtZW50T3JkZXJJZCArICInIjsNCglxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQoNCgl2YXIgc29xbDMgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJTSFBfU2hpcG1lbnRPcmRlcklkICsgIicgQU5EIFNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdDb21wbGV0ZWQnIjsNCglxcjMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMyk7DQoNCgl2YXIgc29xbDQgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJTSFBfU2hpcG1lbnRPcmRlcklkICsgIicgQU5EIFNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdDYW5jZWxlZCciOw0KCXFyNCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWw0KTsNCg0KCXZhciBzaHBoZHIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MiKTsNCglzaHBoZHIuSWQgPSBQUlNIUF9TaGlwbWVudE9yZGVySWQ7DQoNCgl2YXIgaGRydXBkID0gZmFsc2U7DQoJaWYgKHFyMi5zaXplID09IHFyMy5zaXplKQkJLy8gQWxsIGxpbmVzIGNvbXBsZXRlZA0KCSAgICB7DQoJICAgIHNocGhkci5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID0gIkNsb3NlZCI7DQoJICAgIHNocGhkci5TVk1YQ19fQ2xvc2VkX0J5X19jID0gUFJTSFBfVXNlcklkOw0KCSAgICBzaHBoZHIuU1ZNWENfX0Nsb3NlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIGhkcnVwZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmIChxcjIuc2l6ZSA9PSBxcjQuc2l6ZSkJLy8gQWxsIGxpbmVzIENhbmNlbGVkDQoJICAgIHsNCgkgICAgc2hwaGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCSAgICBzaHBoZHIuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgc2hwaGRyLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IFBSU0hQX1VzZXJJZDsNCgkgICAgaGRydXBkID0gdHJ1ZTsNCgkgICAgfQ0KCWlmIChoZHJ1cGQpDQoJICAgIHsNCgkgICAgdHJ5IHsNCgkJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtzaHBoZHJdKTsNCgkJfQ0KCSAgICBjYXRjaCAoZSkgewkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNyIpKyJcbiIgKyBlKTsNCgkJQ2xvc2VXaW5kb3coKTsNCgkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJICAgIH0NCgl9IA0KICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxOCIpKTsJDQogICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7DQogICAgQ2xvc2VXaW5kb3coKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qb3N0U3RvY2tBZGp1c3RtZW50VG9JbnZlbnRvcnkoYWRqSWQsIGFkak51bSwgdUlkLCBzZXNzSWQpDQp7DQogICAgU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJTQURKU0MxIik7ICANCiAgICBTVk1YSV9TZXRMYWJlbHMoIlBvc3RTdG9ja0FkalRvSW52ZW50b3J5Iik7ICANCg0KICAgIEFESklOVl9BZGp1c3RtZW50SWQgPSBhZGpJZDsNCiAgICBBREpJTlZfQWRqTnVtYmVyID0gYWRqTnVtOw0KICAgIEFESklOVl9Vc2VySWQgPSB1SWQ7DQogICAgQURKSU5WX1Nlc3Npb25JZCA9IHNlc3NJZDsNCg0KICAgIC8qKio9PT09PT09PT09PT09PSBDb21tZW50ZWQgb3V0IGJ5IEhTOiA2LzI1LzIwMDkuIFRoaXMgaXMgY29udHJvbGxlZCBieSBMTU8gbm93DQogICAgdmFyIGludmVudG9yeV9lbmFibGVkID0gZmFsc2U7DQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fRW5hYmxlX0ludmVudG9yeV9Nb2R1bGVfX2MgRlJPTSBTVk1YQ19fU2VydmljZU1heF9TZXR0aW5nc19fYyI7DQogICAgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmKHFyMS5zaXplID4gMCkNCgl7DQoJcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KCWlmIChyZWMxWzBdLlNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYyA9PSAidHJ1ZSIpDQoJICAgIGludmVudG9yeV9lbmFibGVkID0gdHJ1ZTsNCgllbHNlDQoJICAgIGludmVudG9yeV9lbmFibGVkID0gZmFsc2U7DQoJfQ0KDQogICAgaWYgKCFpbnZlbnRvcnlfZW5hYmxlZCkNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgID09PT09PT09PSoqKioqKiovDQoNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkLCBTVk1YQ19fTmV3X1F1YW50aXR5Ml9fYywgU1ZNWENfX0xvY2F0aW9uX19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgIiArDQogICAgCQkiRlJPTSBTVk1YQ19fU3RvY2tfQWRqdXN0bWVudF9fYyBXSEVSRSBJZCA9ICciICsgQURKSU5WX0FkanVzdG1lbnRJZCArICInIjsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIHJlY3MgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIGlmIChyZWNzWzBdLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID09ICJ0cnVlIikNCgl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgQURKSU5WX1Byb2RJZCA9IHJlY3NbMF0uU1ZNWENfX1Byb2R1Y3RfX2M7DQogICAgQURKSU5WX0FkalF0eSA9IHJlY3NbMF0uU1ZNWENfX05ld19RdWFudGl0eTJfX2M7DQogICAgQURKSU5WX1NpdGVJZCA9IHJlY3NbMF0uU1ZNWENfX0xvY2F0aW9uX19jOw0KDQogICAgdmFyIFByb2RBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheSgxLCA2KTsNCiAgICBQcm9kQXJyYXlbMF1bMF0gPSBBREpJTlZfUHJvZElkOw0KICAgIFByb2RBcnJheVswXVsxXSA9IEFESklOVl9BZGpRdHk7DQogICAgUHJvZEFycmF5WzBdWzJdID0gQURKSU5WX1NpdGVJZDsNCiAgICBQcm9kQXJyYXlbMF1bM10gPSAiQXZhaWxhYmxlIjsNCiAgICBQcm9kQXJyYXlbMF1bNF0gPSBBREpJTlZfU2l0ZUlkOw0KICAgIFByb2RBcnJheVswXVs1XSA9ICJBdmFpbGFibGUiOw0KDQogICAgLy8gQ2FsbCBzZXJpYWwgc2VsZWN0aW9uIHV0aWxpdHkuIEl0IHdpbGwgY2FwdHVyZSBzZXJpYWwgbnVtYmVycyB3aGVyZSBhcHBsaWNhYmxlIGFuZA0KICAgIC8vIGNhbGwgYmFjayB0aGUgcm91dGluZSBiZWxvdyB3aXRoIHRoZSBzZWxlY3RlZCBzZXJpYWxzDQogICAgd2luZG93LmJsdXIoKTsNCiAgICB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTZWxlY3Rpb24oUHJvZEFycmF5LCAiU3RvY2sgQWRqdXN0bWVudCIsIEFESklOVl9BZGpOdW1iZXIsIEFESklOVl9Vc2VySWQsIEFESklOVl9TZXNzaW9uSWQpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX0NhbGxiYWNrX1N0b2NrQWRqdXN0bWVudChTZXJpYWxTZWxlY3RTdGF0dXMsIFNlcmlhbENvdW50LCBTZXJpYWxBcnJheSkNCnsNCiAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICBpZiAoIVNlcmlhbFNlbGVjdFN0YXR1cykNCiAgICAJew0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCg0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIHZhciBPbGRRdHkgPSAwOw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX1F1YW50aXR5Ml9fYyBGUk9NIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICIgKw0KICAgIAkJIldIRVJFIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyBBREpJTlZfUHJvZElkICsgDQoJCSInIEFORCBTVk1YQ19fTG9jYXRpb25fX2MgPSAnIiArIEFESklOVl9TaXRlSWQgKyANCgkJIicgQU5EIFNWTVhDX19TdGF0dXNfX2MgPSAnQXZhaWxhYmxlJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCiAgICAJT2xkUXR5ID0gMDsNCiAgICBlbHNlDQoJew0KCXJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCglPbGRRdHkgPSBwYXJzZUZsb2F0KHJlYzFbMF0uU1ZNWENfX1F1YW50aXR5Ml9fYyk7DQoJfQ0KDQogICAgdmFyIENoYW5nZVF0eSA9IDA7DQogICAgdmFyIENoYW5nZVR5cGUgPSAiIjsNCiAgICBpZiAoQURKSU5WX0FkalF0eSA+IE9sZFF0eSkNCiAgICAJew0KCUNoYW5nZVR5cGUgPSAiSW5jcmVhc2UiOw0KCUNoYW5nZVF0eSA9IEFESklOVl9BZGpRdHkgLSBPbGRRdHk7DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCUNoYW5nZVR5cGUgPSAiRGVjcmVhc2UiOw0KCUNoYW5nZVF0eSA9IE9sZFF0eSAtIEFESklOVl9BZGpRdHk7DQoJfQ0KICAgIC8vIERlY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgc291cmNlIGxvY2F0aW9uDQogICAgdmFyIFN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShBREpJTlZfUHJvZElkLCBBREpJTlZfU2l0ZUlkLCAiQXZhaWxhYmxlIiwgQ2hhbmdlUXR5LCAiU3RvY2sgQWRqdXN0bWVudCIsIEFESklOVl9BZGpOdW1iZXIsIENoYW5nZVR5cGUsIEFESklOVl9BZGp1c3RtZW50SWQsIG51bGwsIEFESklOVl9Vc2VySWQpOw0KICAgIGlmICghU3RvY2tBcnJbMF0pDQoJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSsiXG4iICsgU3RvY2tBcnJbNF0pOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCiAgICB2YXIgRnJvbVByb2RTdG9ja0lkID0gU3RvY2tBcnJbMV07DQogICAgdmFyIFRvUHJvZFN0b2NrSWQgPSBTdG9ja0FyclsxXTsNCg0KICAgIC8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSBhZGp1c3RlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApDQoJew0KCWZvciAodmFyIGsgPSAwOyBrIDwgU2VyaWFsQ291bnQ7IGsrKykNCgkgICAgew0KCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMF0gPSBBREpJTlZfUHJvZElkOw0KCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMV0gPSBGcm9tUHJvZFN0b2NrSWQ7DQoJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsyXSA9IFRvUHJvZFN0b2NrSWQ7DQoJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCSAgICB0b3RxKys7DQoJICAgIH0NCgl9DQoNCiAgICAvLyBEZWxldGUgYWxsIHNlcmlhbCBudW1iZXJzIGZyb20gdGhlIGFkanVzdG1lbnQgbG9jYXRpb24NCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQgRlJPTSBTVk1YQ19fUHJvZHVjdF9TZXJpYWxfX2MgV0hFUkUgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgPSAnIiArIFRvUHJvZFN0b2NrSWQgKyAiJyI7DQogICAgdmFyIHFyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7DQogICAgaWYgKHFyLnNpemUgPiAwKQ0KCXsNCgl2YXIgZGVscmVjcyA9IG5ldyBBcnJheSgpOw0KCXZhciBzcmxyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyKTsNCgl3aGlsZShzcmxyZWNzLmhhc05leHQoKSkNCgkgICAgew0KCSAgICB2YXIgcmVjID0gc3JscmVjcy5uZXh0KCk7DQoJICAgIHZhciBzcmxyZWMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TdG9ja19TZXJpYWxfX2MiKTsNCgkgICAgc3JscmVjLklkID0gcmVjLklkOw0KCSAgICBkZWxyZWNzLnB1c2gocmVjLklkKTsNCgkgICAgfQ0KDQoJaWYgKGRlbHJlY3MubGVuZ3RoID4gMCkNCgkgICAgew0KCSAgICB0cnkgew0KCQlzZm9yY2UuY29ubmVjdGlvbi5kZWxldGVJZHMoZGVscmVjcyk7DQoJCX0NCgkgICAgY2F0Y2ggKGUpIHsJCQ0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSsgIlxuIiArIGUpOw0KCQlDbG9zZVdpbmRvdygpOw0KCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSBzZXJpYWwgbnVtYmVycyBmb3IgdGhlIGFkanVzdGVkIHF1YW50aXR5DQogICAgaWYgKFNlcmlhbENvdW50ID4gMCkgeyB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTYXZlKFNlcmlhbFNhdmVBcnJheSwgQURKSU5WX1VzZXJJZCk7IH0NCg0KICAgIHZhciBhZGpsaW5lID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU3RvY2tfQWRqdXN0bWVudF9fYyIpOw0KICAgIGFkamxpbmUuSWQgPSBBREpJTlZfQWRqdXN0bWVudElkOw0KICAgIGFkamxpbmUuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSB0cnVlOw0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW2FkamxpbmVdKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikrIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7DQogICAgQ2xvc2VXaW5kb3coKTsNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qb3N0U1ZPVXNhZ2VUb0ludmVudG9yeShzZXJ2SWQsIHNlcnZOdW0sIHVJZCwgbGluZUlkLCBzZXNzSWQpDQp7DQogICAgU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJXT1JEU0M3Iik7IA0KICAgIFNWTVhJX1NldExhYmVscygiUG9zdFNWT1VzYWdlVG9JbnZlbnRvcnkiKTsgDQoJDQogICAgU1ZPVVNHSU5WX1NWT0lkID0gc2VydklkOw0KICAgIFNWT1VTR0lOVl9Vc2VySWQgPSB1SWQ7DQogICAgU1ZPVVNHSU5WX1NWT0xpbmVJZCA9IGxpbmVJZDsNCiAgICBTVk9VU0dJTlZfU1ZPTnVtYmVyID0gc2Vydk51bTsNCiAgICBTVk9VU0dJTlZfU2Vzc2lvbklkID0gc2Vzc0lkOw0KDQogICAgLyoqKj09PT09PT09PT09PT09IENvbW1lbnRlZCBvdXQgYnkgSFM6IDYvMjUvMjAwOS4gVGhpcyBpcyBjb250cm9sbGVkIGJ5IExNTyBub3cNCiAgICB2YXIgaW52ZW50b3J5X2VuYWJsZWQgPSBmYWxzZTsNCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYyBGUk9NIFNWTVhDX19TZXJ2aWNlTWF4X1NldHRpbmdzX19jIjsNCiAgICBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYocXIxLnNpemUgPiAwKQ0KCXsNCglyZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQoJaW52ZW50b3J5X2VuYWJsZWQgPSByZWMxWzBdLlNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYzsNCgl9DQoNCiAgICBpZiAoIWludmVudG9yeV9lbmFibGVkKQ0KICAgIAl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgPT09PT09PT09PT0qKioqKioqKi8NCg0KICAgIC8vIEdldCBTYWxlc2ZvcmNlIGludGVybmFsIFJlY29yZCBUeXBlIElEIGZvciBTZXJ2aWNlIG9yZGVyICJVc2FnZS9Db25zdW1wdGlvbiINCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkIEZST00gUmVjb3JkVHlwZSBXSEVSRSBTb2JqZWN0VHlwZSA9ICdTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jJyBBTkQgTmFtZSA9ICdVc2FnZS9Db25zdW1wdGlvbiciOw0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7IA0KICAgIHZhciByZWMyID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzIubGVuZ3RoID09IDApDQoJeyAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7DQogICAgICAgIENsb3NlV2luZG93KCk7DQogICAgICAgIHJldHVybjsNCgl9DQogICAgVXNhZ2VSZWNvcmRUeXBlSWQgPSByZWMyWzBdLklkOw0KDQogICAgdmFyIHNvcWwzID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyAiICsNCiAgICAJCSJXSEVSRSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyA9ICciICsgU1ZPVVNHSU5WX1NWT0lkICsgIicgQU5EIFJlY29yZFR5cGVJZCA9ICciICsgVXNhZ2VSZWNvcmRUeXBlSWQgKyAiJyI7DQogICAgdmFyIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICBpZiAocXIzLnNpemUgPD0gMCkNCiAgICAJeyAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQogICAgICAgIENsb3NlV2luZG93KCk7DQogICAgICAgIHJldHVybjsNCgl9DQoNCiAgICB2YXIgc29xbDQgPSAiU0VMRUNUIElkLCBTVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jIEZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyAiICsNCiAgICAJCSJXSEVSRSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyA9ICciICsgU1ZPVVNHSU5WX1NWT0lkICsgIicgQU5EIFJlY29yZFR5cGVJZCA9ICciICsgVXNhZ2VSZWNvcmRUeXBlSWQgKw0KCQkiJyBBTkQgU1ZNWENfX0xpbmVfVHlwZV9fYyA9ICdQYXJ0cycgQU5EIFNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gZmFsc2UiOw0KICAgIGlmIChTVk9VU0dJTlZfU1ZPTGluZUlkKSB7IHNvcWw0ID0gc29xbDQgKyAiIEFORCBJZCA9ICciICsgU1ZPVVNHSU5WX1NWT0xpbmVJZCArICInIjsgfQ0KICAgIHZhciBxcjQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsNCk7DQogICAgaWYgKHFyNC5zaXplIDw9IDApDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7ICANCiAgICAgICAgQ2xvc2VXaW5kb3coKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCiAgICB2YXIgbGluZXJlY3MgPSBxcjQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIHZhciBQcm9kQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkobGluZXJlY3MubGVuZ3RoLCA2KTsNCg0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbGluZXJlY3MubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gbGluZXJlY3Nba107DQoJaWYgKCFyZWMuU1ZNWENfX0NvbnN1bWVkX0Zyb21fTG9jYXRpb25fX2MpDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5IikpOyAgDQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybjsNCgkgICAgfQ0KCVByb2RBcnJheVtrXVswXSA9IHJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCglQcm9kQXJyYXlba11bMV0gPSByZWMuU1ZNWENfX0FjdHVhbF9RdWFudGl0eTJfX2M7DQoJUHJvZEFycmF5W2tdWzJdID0gcmVjLlNWTVhDX19Db25zdW1lZF9Gcm9tX0xvY2F0aW9uX19jOw0KCVByb2RBcnJheVtrXVszXSA9ICJBdmFpbGFibGUiOw0KCVByb2RBcnJheVtrXVs0XSA9IHJlYy5TVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYzsNCglQcm9kQXJyYXlba11bNV0gPSAiQ29uc3VtZWQiOw0KCX0NCiAgICBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzID0gbGluZXJlY3M7DQoNCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJTVk8gVXNhZ2UiLCBTVk9VU0dJTlZfU1ZPTnVtYmVyLCBTVk9VU0dJTlZfVXNlcklkLCBTVk9VU0dJTlZfU2Vzc2lvbklkKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9DYWxsYmFja19Qb3N0U1ZPVXNhZ2UoU2VyaWFsU2VsZWN0U3RhdHVzLCBTZXJpYWxDb3VudCwgU2VyaWFsQXJyYXkpDQp7DQogICAgd2luZG93LmZvY3VzKCk7DQogICAgaWYgKCFTZXJpYWxTZWxlY3RTdGF0dXMpDQogICAgCXsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCgl9DQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzLmxlbmd0aDsgaisrKQ0KICAgIAl7DQoJdmFyIFByb2RJZCA9IFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbal0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFVzYWdlUXR5ID0gcGFyc2VGbG9hdChTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzW2pdLlNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jKTsNCg0KCS8vIERlY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgdXNhZ2UgbG9jYXRpb24NCgl2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbal0uU1ZNWENfX0NvbnN1bWVkX0Zyb21fTG9jYXRpb25fX2MsICJBdmFpbGFibGUiLCBVc2FnZVF0eSwgIlNWTyBVc2FnZSIsIFNWT1VTR0lOVl9TVk9OdW1iZXIsICJEZWNyZWFzZSIsIFNWT1VTR0lOVl9TVk9JZCwgU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkc1tqXS5JZCwgU1ZPVVNHSU5WX1VzZXJJZCk7DQoJaWYgKCFGcm9tU3RvY2tBcnJbMF0pDQoJICAgIHsJICAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIEZyb21Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEluY3JlYXNlIENvbnN1bWVkIHN0b2NrIGluIHRoZSB1c2FnZSBsb2NhdGlvbg0KCXZhciBUb1N0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbal0uU1ZNWENfX0NvbnN1bWVkX0Zyb21fTG9jYXRpb25fX2MsICJDb25zdW1lZCIsIFVzYWdlUXR5LCAiU1ZPIFVzYWdlIiwgU1ZPVVNHSU5WX1NWT051bWJlciwgIkluY3JlYXNlIiwgU1ZPVVNHSU5WX1NWT0lkLCBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzW2pdLklkLCBTVk9VU0dJTlZfVXNlcklkKTsNCglpZiAoIVRvU3RvY2tBcnJbMF0pDQoJICAgIHsJICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgVG9Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSB0cmFuc2ZlcnJlZCBxdWFudGl0eQ0KCWlmIChTZXJpYWxDb3VudCA+IDApDQoJICAgIHsNCgkgICAgZm9yICh2YXIgayA9IDA7IGsgPCBTZXJpYWxDb3VudDsgaysrKQ0KCQl7DQoJCWlmIChTZXJpYWxBcnJheVtrXVswXSA9PSBQcm9kSWQgJiYgU2VyaWFsQXJyYXlba11bNF0gPT0gU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkc1tqXS5TVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYykNCgkJICAgIHsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVswXSA9IFByb2RJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsxXSA9IEZyb21Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsyXSA9IFRvUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bM10gPSBTZXJpYWxBcnJheVtrXVs3XTsNCgkJICAgIHRvdHErKzsNCgkJICAgIH0NCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgLy8gVXBkYXRlIHNlcmlhbCBudW1iZXJzIGZvciB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkNCiAgICBpZiAoU2VyaWFsQ291bnQgPiAwKSB7IHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNhdmUoU2VyaWFsU2F2ZUFycmF5LCBTVk9VU0dJTlZfVXNlcklkKTsgfQ0KDQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIHZhciBzdm9saW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkcy5sZW5ndGg7IG0rKykNCiAgICAJew0KCXZhciByZWMgPSBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzW21dOw0KDQoJdmFyIHN2b2xpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCglzdm9saW5lLklkID0gcmVjLklkOw0KCXN2b2xpbmUuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSB0cnVlOw0KCXN2b2xpbmVzLnB1c2goc3ZvbGluZSk7DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoc3ZvbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSsiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Bvc3RTdG9ja1RyYW5zZmVyVG9JbnZlbnRvcnkodHJmcklkLCB0cmZyTnVtLCB1SWQsIHNlc3NJZCkNCnsNCglTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlNYRlJTQzEiKTsgIA0KCVNWTVhJX1NldExhYmVscygiUG9zdFN0b2NrVHJhblRvSW52ZW50b3J5Iik7ICANCiAgICB2YXIgRXJyTXNnID0gIiI7DQoNCiAgICBYRlJJTlZfWGZlcklkID0gdHJmcklkOw0KICAgIFhGUklOVl9Vc2VySWQgPSB1SWQ7DQogICAgWEZSSU5WX1hmZXJOdW1iZXIgPSB0cmZyTnVtOw0KICAgIFhGUklOVl9TZXNzaW9uSWQgPSBzZXNzSWQ7DQoNCiAgICAvKioqPT09PT09PT09PT09PT0gQ29tbWVudGVkIG91dCBieSBIUzogNi8yNS8yMDA5LiBUaGlzIGlzIGNvbnRyb2xsZWQgYnkgTE1PIG5vdw0KICAgIHZhciBpbnZlbnRvcnlfZW5hYmxlZCA9IGZhbHNlOw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jIEZST00gU1ZNWENfX1NlcnZpY2VNYXhfU2V0dGluZ3NfX2MiOw0KICAgIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZihxcjEuc2l6ZSA+IDApDQoJew0KCXJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCglpbnZlbnRvcnlfZW5hYmxlZCA9IHJlYzFbMF0uU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jOw0KCX0NCg0KICAgIGlmICghaW52ZW50b3J5X2VuYWJsZWQpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICA9PT09PT09KioqKioqKioqKiovDQoNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIFNWTVhDX19Tb3VyY2VfTG9jYXRpb25fX2MsIFNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19TdG9ja19UcmFuc2Zlcl9fYyBXSEVSRSBJZCA9ICciICsgWEZSSU5WX1hmZXJJZCArICInIjsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIHJlYzIgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIFhGUklOVl9Tb3VyY2VMb2NJZCA9IHJlYzJbMF0uU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYzsNCiAgICBYRlJJTlZfRGVzdExvY0lkID0gcmVjMlswXS5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2M7DQoNCiAgICB2YXIgc29xbDMgPSAiU0VMRUNUIElkLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1F1YW50aXR5X1RyYW5zZmVycmVkMl9fYywgU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgIiArDQogICAgCQkiRlJPTSBTVk1YQ19fU3RvY2tfVHJhbnNmZXJfTGluZV9fYyBXSEVSRSBTVk1YQ19fU3RvY2tfVHJhbnNmZXJfX2MgPSAnIiArIFhGUklOVl9YZmVySWQgKyAiJyI7DQogICAgdmFyIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICByZWNzID0gcXIzLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICB2YXIgUHJvZEFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KHJlY3MubGVuZ3RoLCA2KTsNCg0KICAgIHZhciBpbnZhbGlkID0gZmFsc2U7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCByZWNzLmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlYyA9IHJlY3Nba107DQoNCglpZiAocmVjLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID09ICJ0cnVlIikNCgkgICAgew0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgYnJlYWs7DQoJICAgIH0NCgl2YXIgc29xbDQgPSAiU0VMRUNUIFNWTVhDX19RdWFudGl0eTJfX2MgRlJPTSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyBXSEVSRSBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcmVjLlNWTVhDX19Qcm9kdWN0X19jICsgIicgIiArDQoJCSJBTkQgU1ZNWENfX0xvY2F0aW9uX19jID0gJyIgKyBYRlJJTlZfU291cmNlTG9jSWQgKyAiJyBBTkQgU1ZNWENfX1N0YXR1c19fYyA9ICdBdmFpbGFibGUnIjsNCgl2YXIgcXI0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDQpOw0KCWlmIChxcjQuc2l6ZSA8PSAwKQ0KCSAgICB2YXIgYXZsYmxfcXR5ID0gMDsNCgllbHNlIA0KCSAgICB7DQoJICAgIHZhciByZWM0ID0gcXI0LmdldEFycmF5KCJyZWNvcmRzIik7DQoJICAgIHZhciBhdmxibF9xdHkgPSBwYXJzZUZsb2F0KHJlYzRbMF0uU1ZNWENfX1F1YW50aXR5Ml9fYyk7DQoJICAgIH0NCglpZiAocGFyc2VGbG9hdChyZWMuU1ZNWENfX1F1YW50aXR5X1RyYW5zZmVycmVkMl9fYykgPiBhdmxibF9xdHkpDQoJICAgIHsJCQ0KCSAgICBFcnJNc2cgPSBFcnJNc2cgKyByZWMuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSArIFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpICsgIlxuIjsNCgkgICAgfQ0KCQkNCglQcm9kQXJyYXlba11bMF0gPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJUHJvZEFycmF5W2tdWzFdID0gcmVjLlNWTVhDX19RdWFudGl0eV9UcmFuc2ZlcnJlZDJfX2M7DQoJUHJvZEFycmF5W2tdWzJdID0gWEZSSU5WX1NvdXJjZUxvY0lkOw0KCVByb2RBcnJheVtrXVszXSA9ICJBdmFpbGFibGUiOw0KCVByb2RBcnJheVtrXVs0XSA9IFhGUklOVl9EZXN0TG9jSWQ7DQoJUHJvZEFycmF5W2tdWzVdID0gIkF2YWlsYWJsZSI7DQoJfQ0KDQogICAgaWYgKGludmFsaWQpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAoRXJyTXNnLmxlbmd0aCA+IDApDQogICAgCXsNCglhbGVydChFcnJNc2cpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIFhGUklOVl9YZmVyUmVjb3JkcyA9IHJlY3M7DQoNCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJTdG9jayBUcmFuc2ZlciIsIFhGUklOVl9YZmVyTnVtYmVyLCBYRlJJTlZfVXNlcklkLCBYRlJJTlZfU2Vzc2lvbklkKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9DYWxsYmFja19TdG9ja1RyYW5zZmVyKFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgWEZSSU5WX1hmZXJSZWNvcmRzLmxlbmd0aDsgaisrKQ0KICAgIAl7DQoJdmFyIFByb2RJZCA9IFhGUklOVl9YZmVyUmVjb3Jkc1tqXS5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgWGZlclF0eSA9IHBhcnNlRmxvYXQoWEZSSU5WX1hmZXJSZWNvcmRzW2pdLlNWTVhDX19RdWFudGl0eV9UcmFuc2ZlcnJlZDJfX2MpOw0KDQoJLy8gRGVjcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSBzb3VyY2UgbG9jYXRpb24NCgl2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFhGUklOVl9Tb3VyY2VMb2NJZCwgIkF2YWlsYWJsZSIsIFhmZXJRdHksICJTdG9jayBUcmFuc2ZlciIsIFhGUklOVl9YZmVyTnVtYmVyLCAiRGVjcmVhc2UiLCBYRlJJTlZfWGZlcklkLCBYRlJJTlZfWGZlclJlY29yZHNbal0uSWQsIFhGUklOVl9Vc2VySWQpOw0KCWlmICghRnJvbVN0b2NrQXJyWzBdKQ0KCSAgICB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIEZyb21Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEluY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgdGFyZ2V0IGxvY2F0aW9uDQoJdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgWEZSSU5WX0Rlc3RMb2NJZCwgIkF2YWlsYWJsZSIsIFhmZXJRdHksICJTdG9jayBUcmFuc2ZlciIsIFhGUklOVl9YZmVyTnVtYmVyLCAiSW5jcmVhc2UiLCBYRlJJTlZfWGZlcklkLCBYRlJJTlZfWGZlclJlY29yZHNbal0uSWQsIFhGUklOVl9Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgewkgICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgVG9Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSB0cmFuc2ZlcnJlZCBxdWFudGl0eQ0KCWlmIChTZXJpYWxDb3VudCA+IDApDQoJICAgIHsNCgkgICAgZm9yICh2YXIgayA9IDA7IGsgPCBTZXJpYWxDb3VudDsgaysrKQ0KCQl7DQoJCWlmIChTZXJpYWxBcnJheVtrXVswXSA9PSBQcm9kSWQgJiYgU2VyaWFsQXJyYXlba11bNF0gPT0gWEZSSU5WX0Rlc3RMb2NJZCkNCgkJICAgIHsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVswXSA9IFByb2RJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsxXSA9IEZyb21Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsyXSA9IFRvUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bM10gPSBTZXJpYWxBcnJheVtrXVs3XTsNCgkJICAgIHRvdHErKzsNCgkJICAgIH0NCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgLy8gVXBkYXRlIHNlcmlhbCBudW1iZXJzIGZvciB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkNCiAgICBpZiAoU2VyaWFsQ291bnQgPiAwKSB7IHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNhdmUoU2VyaWFsU2F2ZUFycmF5LCBYRlJJTlZfVXNlcklkKTsgfQ0KDQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIHZhciBpbnZhbGlkID0gZmFsc2U7DQogICAgdmFyIHhmZXJsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgWEZSSU5WX1hmZXJSZWNvcmRzLmxlbmd0aDsgbSsrKQ0KICAgIAl7DQoJdmFyIHJlYyA9IFhGUklOVl9YZmVyUmVjb3Jkc1ttXTsNCg0KCXZhciB4ZmVybGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1N0b2NrX1RyYW5zZmVyX0xpbmVfX2MiKTsNCgl4ZmVybGluZS5JZCA9IHJlYy5JZDsNCgl4ZmVybGluZS5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoJeGZlcmxpbmVzLnB1c2goeGZlcmxpbmUpOw0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHhmZXJsaW5lcyk7DQoJfQ0KICAgIGNhdGNoIChlKSB7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKyJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1JNQV9TaG93TGluZXMocm1hSWQsIHJtYW51bSwgdUlkLCBsaW5lSWQsIHNlc3NJZCkNCnsNCiAgICBTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlBPUkRTQzYiKTsgDQogICAgU1ZNWElfU2V0TGFiZWxzKCJQcm9jZXNzUmVjZWlwdHNGb3JSTUEiKTsgDQoJDQogICAgUFJSTUFfUk1BSWQgPSBybWFJZDsNCiAgICBQUlJNQV9Vc2VySWQgPSB1SWQ7DQogICAgUFJSTUFfUk1BTGluZUlkID0gbGluZUlkOw0KICAgIFBSUk1BX1JNQU51bWJlciA9IHJtYW51bTsNCiAgICBQUlJNQV9TZXNzaW9uSWQgPSBzZXNzSWQ7DQoNCiAgICAvLyBHZXQgUk1BIGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fU291cmNlX0xvY2F0aW9uX19jLCBTVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2MsIFNWTVhDX19PcmRlcl9TdGF0dXNfX2MsICIgKw0KCQkiU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fci5TVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MsIFNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fci5TVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MsICIgKw0KCQkiU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19Db3N0ZWRfYXRfdmFsdWVfX2MgIiArDQogICAgCQkiRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jIFdIRVJFIElkID0gJyIgKyBQUlJNQV9STUFJZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNsb3NlZCIpDQogICAgCXsJDQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiKQ0KICAgIAl7CQ0KCSBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmICghcmVjMVswXS5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2MpDQogICAgCXsJCQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKCFyZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fci5TVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBQUlJNQV9Tb3VyY2VMb2NJZCA9IHJlYzFbMF0uU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYzsNCiAgICBQUlJNQV9EZXN0TG9jSWQgPSByZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYzsNCiAgICBQUlJNQV9EZXN0Q29zdGVkQXRWYWx1ZSA9IHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19Db3N0ZWRfYXRfdmFsdWVfX2M7DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgUk1BIExpbmUgIlJNQSINCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYycgQU5EIE5hbWUgPSAnUk1BJyINCiAgICB2YXIgcXVlcnlSZXN1bHQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQogICAgdmFyIHJ0cmVjb3JkcyA9IHF1ZXJ5UmVzdWx0LmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJ0cmVjb3Jkcy5sZW5ndGggPT0gMCkNCgl7ICAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTAiKSk7DQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQoJfQ0KICAgIFBSUk1BX1JlY29yZFR5cGVJZCA9IHJ0cmVjb3Jkc1swXS5JZDsNCg0KICAgIC8vIEdldCBvcGVuIFJNQSBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCAiICsNCiAgICAJCSJTVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jLCBTVk1YQ19fRXhwZWN0ZWRfUmVjZWlwdF9EYXRlX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJSTUFfUk1BSWQgKyAiJyBBTkQgIiArDQoJCSJTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnT3BlbicgQU5EIFJlY29yZFR5cGVJZCA9ICciICsgUFJSTUFfUmVjb3JkVHlwZUlkICsgIiciOw0KICAgIGlmIChQUlJNQV9STUFMaW5lSWQpIHsgc29xbDIgPSBzb3FsMiArICIgQU5EIElkID0gJyIgKyBQUlJNQV9STUFMaW5lSWQgKyAiJyIgfSA7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCgl7DQoJaWYgKFBSUk1BX1JNQUxpbmVJZCkNCgkJewkJCQ0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSkgOw0KCQl9DQoJZWxzZQ0KCQl7CQkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKSA7DQoJCX0NCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJtYXJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHZhciByb3dudW0gPSAwOw0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoNCiAgICBTVk1YSV9Qcm9jUk1BX0RyYXdIZWFkZXIodGJvZHkpOyAgDQoNCiAgICB2YXIgbm9sb2MgPSAwOw0KICAgIHdoaWxlKHJtYXJlY3MuaGFzTmV4dCgpKQ0KCXsNCgl2YXIgcm1hcmVjID0gcm1hcmVjcy5uZXh0KCk7DQoNCgl2YXIgcm1hbGluZWlkID0gcm1hcmVjLklkOw0KCXZhciBwcm9kaWQgPSBybWFyZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIEV4cFF0eSA9IHBhcnNlRmxvYXQocm1hcmVjLlNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MpOw0KDQoJdmFyIHRyID0gbWFrZVJvdyhtYWtlQXR0cnMocm93bnVtLHRib2R5KSApOw0KCXRyLnNvYmplY3QgPSBybWFyZWM7DQoJdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJCS8vIENvbCAxLiBQcm9kdWN0IE5hbWUNCgljcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJCSI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIHByb2RpZCArICJcIj4iICsgcHJvZGlkID8gcm1hcmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgOiAiVW5rbm93biIgKyAiPC9hPiI7DQoNCgkJLy8gQ29sIDIuIEV4cGVjdGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IGRpc2FibGVkPVwidHJ1ZVwiIHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgcm1hbGluZWlkICsgIkV4cFF0eVwiIG5hbWU9XCIiICsgcm1hbGluZWlkICsgIkV4cFF0eVwiIHZhbHVlPVwiIiArIEV4cFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDMuIFJlY2VpdmVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCIiICsgcm1hbGluZWlkICsgIlJjdlF0eVwiIG5hbWU9XCIiICsgcm1hbGluZWlkICsgIlJjdlF0eVwiIHZhbHVlPVwiIiArIEV4cFF0eSArICJcIiBvbmNoYW5nZT1cIlNWTVhJX1Byb2NSTUFfVmFsaWRhdGVRdWFudGl0eSh0aGlzKTtcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDQuIENoZWNrYm94DQoJY3JlYXRlVGFnKHRyLCJ0ZCIseydjbGFzcyc6J2FjdGlvbkNvbHVtbicsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgY2hlY2tlZD1cInRydWVcIiBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwiY2hlY2tib3hcIiBpZD1cIiIgKyBybWFsaW5laWQgKyAiQ2hlY2tib3hcIiBuYW1lPVwiaWRzXCIgdmFsdWU9XCIiICsgcm1hbGluZWlkICsgIlwiID4mbmJzcDsiOw0KDQoJCS8vIENvbCA1LiBTdGF0dXMgTWVzc2FnZQ0KCWNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJIjxkaXYgaWQ9XCIiICsgcm1hbGluZWlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgcm1hbGluZWlkICsgIkVyck1zZ1wiPjwvZGl2PiI7DQoNCglyb3dudW0gKz0gMTsNCgl9DQoNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS5oZWlnaHQgPSAwOyANCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUk1BX1ZhbGlkYXRlUXVhbnRpdHkoY3RybCkNCnsNCiAgICB2YXIgcm1hbGluZWlkID0gY3RybC5uYW1lLnN1YnN0cmluZygwLDE4KTsNCiAgICB2YXIgZXhwcXR5bmFtZSA9IHJtYWxpbmVpZCArICJFeHBRdHkiOw0KICAgIHZhciBleHBxdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChleHBxdHluYW1lKTsNCg0KICAgIGlmKHBhcnNlRmxvYXQoY3RybC52YWx1ZSkgPj0gcGFyc2VGbG9hdChleHBxdHkudmFsdWUpKQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm1hbGluZWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSB0cnVlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJtYWxpbmVpZCsiQ2hlY2tib3giKS5kaXNhYmxlZCA9IHRydWU7DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJtYWxpbmVpZCsiQ2hlY2tib3giKS5jaGVja2VkID0gZmFsc2U7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm1hbGluZWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gZmFsc2U7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NSTUFfRHJhd0hlYWRlcih0YSkNCnsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGEuYXBwZW5kQ2hpbGQodHIpOw0KCQ0KDQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCdMQUIwMDUnKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgnTEFCMDA2JykrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoJ0xBQjAwNycpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoJ0xBQjAwOCcpKyI8L2E+IjsNCgkJDQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1JNQV9WYWxpZGF0ZUFuZFByb2Nlc3MoKQ0Kew0KICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ1Byb2Nlc3NSZWNlaXB0c0ZvclJNQSddOw0KDQogICAgdmFyIHNvYmplY3RMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspDQoJew0KCWlmIChmb3JtLmVsZW1lbnRzW2ldLm5hbWUgPT0gJ2lkcycpDQoJICAgIHsNCgkgICAgdmFyIHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlOw0KCSAgICB2YXIgcHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlLnBhcmVudE5vZGU7DQoJICAgIGlmIChwcG4uc29iamVjdCkNCgkJew0KCQlzb2JqZWN0TGlzdC5wdXNoKHBwbi5zb2JqZWN0KTsNCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgdmFyIHZhbGlkX3JlY2VpcHRzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc2tpcGNudCA9IDA7DQogICAgaW52YWxpZCA9IGZhbHNlOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjX2ludmFsaWQgPSBmYWxzZTsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJdmFyIEV4cFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFeHBRdHkiKS52YWx1ZSk7DQoJdmFyIGNoZWNrZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkNoZWNrYm94IikuY2hlY2tlZDsNCgkNCgl2YXIgRXJyTXNnID0gIiI7DQoJaWYgKGlzTmFOKFJjdlF0eSkgfHwgUmN2UXR5IDwgMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTEiKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKCFjaGVja2VkICYmIFJjdlF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNraXBjbnQgKz0gMTsNCgkgICAgfQ0KCWVsc2UgaWYoUmN2UXR5ID4gRXhwUXR5KQ0KCSAgICB7DQoJICAgIEVyck1zZyA9U1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCWlmICghcmVjX2ludmFsaWQgJiYgUmN2UXR5ID4gMCkNCgkgICAgdmFsaWRfcmVjZWlwdHMucHVzaChyZWMpOw0KCX0NCg0KICAgIGlmKGludmFsaWQpIHsgcmV0dXJuOyB9DQoNCiAgICBpZihza2lwY250ID09IHNvYmplY3RMaXN0Lmxlbmd0aCkNCgl7CQkJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5IikpOw0KCXJldHVybjsNCgl9DQogICAgUFJSTUFfUmVjZWlwdHMgPSB2YWxpZF9yZWNlaXB0czsNCiAgICBTVk1YSV9Qcm9jUk1BX1Byb2Nlc3NSZWNlaXB0cygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NSTUFfUHJvY2Vzc1JlY2VpcHRzKCkNCnsNCiAgICB2YXIgUHJvZEFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFBSUk1BX1JlY2VpcHRzLmxlbmd0aCwgNik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQUlJNQV9SZWNlaXB0cy5sZW5ndGg7IGkrKykNCgl7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJSTUFfUmVjZWlwdHNbaV0uSWQrIlJjdlF0eSIpLnZhbHVlKTsNCglQcm9kQXJyYXlbaV1bMF0gPSBQUlJNQV9SZWNlaXB0c1tpXS5TVk1YQ19fUHJvZHVjdF9fYzsNCglQcm9kQXJyYXlbaV1bMV0gPSBSY3ZRdHk7DQoJUHJvZEFycmF5W2ldWzJdID0gUFJSTUFfRGVzdExvY0lkOw0KCVByb2RBcnJheVtpXVszXSA9ICJJbiBUcmFuc2l0IjsNCglQcm9kQXJyYXlbaV1bNF0gPSBQUlJNQV9EZXN0TG9jSWQ7DQoJUHJvZEFycmF5W2ldWzVdID0gIkF2YWlsYWJsZSI7DQoJfQ0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlJNQSBSZWNlaXB0IiwgUFJSTUFfUk1BTnVtYmVyLCBQUlJNQV9Vc2VySWQsIFBSUk1BX1Nlc3Npb25JZCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1JNQVJlY2VpcHRzKFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgUFJSTUFfUmVjZWlwdHMubGVuZ3RoOyBqKyspDQogICAgCXsNCgl2YXIgUHJvZElkID0gUFJSTUFfUmVjZWlwdHNbal0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJSTUFfUmVjZWlwdHNbal0uSWQrIlJjdlF0eSIpLnZhbHVlKTsNCg0KCS8vIElmIHRhcmdldCBsb2NhdGlvbiBpcyBjb3N0ZWQgYXQgdmFsdWUsIHNldCB0aGUgc3RvY2sgc3RhdHVzIGFzIEF2YWlsYWJsZS4NCgkvLyBJZiB0YXJnZXQgbG9jYXRpb24gaXMgTk9UIGNvc3RlZCBhdCB2YWx1ZSwgc2V0IHRoZSBzdG9jayBzdGF0dXMgYXMgU2NyYXAuDQoJaWYgKFBSUk1BX0Rlc3RDb3N0ZWRBdFZhbHVlKQ0KCSAgICB2YXIgVG9TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUlJNQV9EZXN0TG9jSWQsICJBdmFpbGFibGUiLCBSY3ZRdHksICJSTUEgUmVjZWlwdCIsIFBSUk1BX1JNQU51bWJlciwgIkluY3JlYXNlIiwgUFJSTUFfUk1BSWQsIFBSUk1BX1JlY2VpcHRzW2pdLklkLCBQUlJNQV9Vc2VySWQpOw0KCWVsc2UNCgkgICAgdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFJSTUFfRGVzdExvY0lkLCAiU2NyYXAiLCBSY3ZRdHksICJSTUEgUmVjZWlwdCIsIFBSUk1BX1JNQU51bWJlciwgIkluY3JlYXNlIiwgUFJSTUFfUk1BSWQsIFBSUk1BX1JlY2VpcHRzW2pdLklkLCBQUlJNQV9Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikrIlxuIiArIFRvU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgRnJvbVByb2RTdG9ja0lkID0gVG9TdG9ja0FyclsxXTsNCgl2YXIgVG9Qcm9kU3RvY2tJZCA9IFRvU3RvY2tBcnJbMV07DQoNCgkvLyBCdWlsZCBzZXJpYWwgbnVtYmVyIGFycmF5IGZvciB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkNCglpZiAoU2VyaWFsQ291bnQgPiAwKQ0KCSAgICB7DQoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgU2VyaWFsQ291bnQ7IGsrKykNCgkJew0KCQlpZiAoU2VyaWFsQXJyYXlba11bMF0gPT0gUHJvZElkKQ0KCQkgICAgew0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzBdID0gUHJvZElkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzFdID0gRnJvbVByb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCQkgICAgdG90cSsrOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgc2VyaWFsIG51bWJlcnMgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFBSUk1BX1VzZXJJZCk7IH0NCg0KICAgIHZhciBuZXdjbnQgPSAwOw0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgcm1hbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgcm1hbGluZXNpbnMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBtID0gMDsgbSA8IFBSUk1BX1JlY2VpcHRzLmxlbmd0aDsgbSsrKQ0KICAgIAl7DQoJdmFyIHJtYWxpbmV1cGQgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KCXZhciByZWMgPSBQUlJNQV9SZWNlaXB0c1ttXTsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJjdlF0eSIpLnZhbHVlKTsNCgl2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkV4cFF0eSIpLnZhbHVlKTsNCgl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KDQoJcm1hbGluZXVwZC5JZCA9IHJlYy5JZDsNCglybWFsaW5ldXBkLlNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jID0gUmN2UXR5Ow0KCXJtYWxpbmV1cGQuU1ZNWENfX0FjdHVhbF9SZWNlaXB0X0RhdGVfX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KDQoJaWYgKGNoZWNrZWQgJiYgUmN2UXR5ID09IDApDQoJICAgIHsNCgkgICAgcm1hbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCSAgICBybWFsaW5ldXBkLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gUFJSTUFfVXNlcklkOw0KCSAgICB9DQoJZWxzZSBpZiAoUmN2UXR5ID4gMCkNCgkgICAgew0KCSAgICBybWFsaW5ldXBkLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDb21wbGV0ZWQiOw0KCSAgICBybWFsaW5ldXBkLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICBybWFsaW5ldXBkLlNWTVhDX19DbG9zZWRfQnlfX2MgPSBQUlJNQV9Vc2VySWQ7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSAidHJ1ZSI7DQoJICAgIH0NCglybWFsaW5lc3VwZC5wdXNoKHJtYWxpbmV1cGQpOw0KDQoJLy8gUGFydCBpcyBwYXJ0aWFsbHkgcmVjZWl2ZWQgYW5kIHVzZXIgZG9lcyBub3Qgd2FudCB0byBjbG9zZSB0aGUgUk1BIGxpbmUgeWV0LiBDcmVhdGUgYSBuZXcgbGluZSBmb3IgcmVtYWluaW5nIHF0eS4NCglpZiAoIWNoZWNrZWQgJiYgUmN2UXR5IDwgRXhwUXR5KQ0KCSAgICB7DQoJICAgIHZhciBybWFsaW5laW5zID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MiKTsNCgkgICAgcm1hbGluZWlucy5SZWNvcmRUeXBlSWQgPSBQUlJNQV9SZWNvcmRUeXBlSWQ7DQoJICAgIHJtYWxpbmVpbnMuU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9IFBSUk1BX1JNQUlkOw0KCSAgICBybWFsaW5laW5zLlNWTVhDX19Qcm9kdWN0X19jID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCSAgICBybWFsaW5laW5zLlNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MgPSBFeHBRdHkgLSBSY3ZRdHk7DQoJICAgIHJtYWxpbmVpbnMuU1ZNWENfX0V4cGVjdGVkX1JlY2VpcHRfRGF0ZV9fYyA9IHJlYy5TVk1YQ19fRXhwZWN0ZWRfUmVjZWlwdF9EYXRlX19jOw0KCSAgICBybWFsaW5laW5zLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJPcGVuIjsNCgkgICAgcm1hbGluZWlucy5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9ICJmYWxzZSI7DQoJICAgIHJtYWxpbmVzaW5zLnB1c2gocm1hbGluZWlucyk7DQoJICAgIG5ld2NudCArPSAxOw0KCSAgICB9DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUocm1hbGluZXN1cGQpOw0KCX0NCiAgICBjYXRjaCAoZSkgewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTQiKSsiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCg0KICAgIGlmIChuZXdjbnQgPiAwKQ0KICAgIAl7DQoJdHJ5IHsNCgkgICAgc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHJtYWxpbmVzaW5zKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTUiKSsiXG4iICsgZSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCiAgICBlbHNlDQogICAgCXsNCgkvLyBUbyB1cGRhdGUgUk1BIGhlYWRlciBzdGF0dXMuLi4NCgkvLyBjaGVjayBpZiBhbGwgbGluZXMgaGF2ZSBiZWVuIGNvbXBsZXRlZCBvciBjYW5jZWxlZCBieSBjb21wYXJpbmcgY291bnRzDQoJdmFyIHNvcWwyID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIFBSUk1BX1JNQUlkICsgIiciOw0KCXFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCg0KCXZhciBzb3FsMyA9ICJTRUxFQ1QgQ291bnQoKSBGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBQUlJNQV9STUFJZCArICInIEFORCBTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnQ29tcGxldGVkJyI7DQoJcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KDQoJdmFyIHNvcWw0ID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIFBSUk1BX1JNQUlkICsgIicgQU5EIFNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdDYW5jZWxlZCciOw0KCXFyNCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWw0KTsNCg0KCXZhciBybWFoZHIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MiKTsNCglybWFoZHIuSWQgPSBQUlJNQV9STUFJZDsNCg0KCXZhciBoZHJ1cGQgPSBmYWxzZTsNCglpZiAocXIyLnNpemUgPT0gcXIzLnNpemUpCQkvLyBBbGwgbGluZXMgY29tcGxldGVkDQoJICAgIHsNCgkgICAgcm1haGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiQ2xvc2VkIjsNCgkgICAgcm1haGRyLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICBybWFoZHIuU1ZNWENfX0Nsb3NlZF9CeV9fYyA9IFBQUlJfVXNlcklkOw0KCSAgICBoZHJ1cGQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAocXIyLnNpemUgPT0gcXI0LnNpemUpCS8vIEFsbCBsaW5lcyBDYW5jZWxlZA0KCSAgICB7DQoJICAgIHJtYWhkci5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCgkgICAgcm1haGRyLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJtYWhkci5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBQUFJSX1VzZXJJZDsNCgkgICAgaGRydXBkID0gdHJ1ZTsNCgkgICAgfQ0KCWlmIChoZHJ1cGQpDQoJICAgIHsNCgkgICAgdHJ5IHsNCgkJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtybWFoZHJdKTsNCgkJfQ0KCSAgICBjYXRjaCAoZSkgewkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNiIpKyJcbiIgKyBlKTsNCgkJQ2xvc2VXaW5kb3coKTsNCgkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJICAgIH0NCgl9ICAgIA0KICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNyIpKTsNCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KfQ0KDQovKj09PT09PT09PSAgIEdFTkVSSUMgVVRJTElUSUVTICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8qPT09PT09PT09PT09PT09PT0gU1RBUlQgUmVsZWFzZSAyLjAgY2hhbmdlcyBmb3IgdHJhbnNsYXRpb24gPT09PT09PT09PT09PT09PT0qLw0KLy8gQnVpbGQgYSBnbG9iYWwgaGFzaCB0YWJsZSBvZiBtZXNzYWdlIG51bWJlcnMgYW5kIG1lc3NhZ2VzLg0KLy8gVGhpcyBhcnJheSB3aWxsIGJlIHVzZWQgZm9yIGRpc3BsYXlpbmcgaW5mby93YXJuaW5nL2Vycm9yIG1lc3NhZ2VzIHRvIHRoZSB1c2VyLg0KLy8gTk9URTogVGhlIGNhbGxpbmcgbW9kdWxlIHNob3VsZCBoYXZlIE1zZ0xpc3QgZGVjbGFyZWQgYXMgYW4gYXJyYXkNCmZ1bmN0aW9uIFNWTVhJX0luaXRNZXNzYWdlTGlzdChzdWJtb2R1bGVpZCkNCnsNCiAgICB2YXIgZm91bmQgPSBmYWxzZTsNCg0KICAgIHZhciBMYW5nTGlzdCA9IG5ldyBBcnJheSgpOw0KDQogICAgCQkvLyBIYXNoIChNYXApIG9mIFNGREMgbGFuZ3VhZ2UgSVNPIGNvZGUgdG8gTGFuZ3VhZ2UgcGlja2xpc3QgaW4gU2VydmljZU1heCB0YWdzIG9iamVjdA0KICAgIExhbmdMaXN0WyJlbl9VUyJdID0gIkVuZ2xpc2giOw0KICAgIExhbmdMaXN0WyJkZSJdID0gIkdlcm1hbiI7DQogICAgTGFuZ0xpc3RbImVzIl0gPSAiU3BhbmlzaCI7DQogICAgTGFuZ0xpc3RbImZyIl0gPSAiRnJlbmNoIjsNCiAgICBMYW5nTGlzdFsiaXQiXSA9ICJJdGFsaWFuIjsNCiAgICBMYW5nTGlzdFsiamEiXSA9ICJKYXBhbmVzZSI7DQogICAgTGFuZ0xpc3RbInN2Il0gPSAiU3dlZGlzaCI7DQogICAgTGFuZ0xpc3RbImtvIl0gPSAiS29yZWFuIjsNCiAgICBMYW5nTGlzdFsiemhfVFciXSA9ICJDaGluZXNlIChUcmFkaXRpb25hbCkiOw0KICAgIExhbmdMaXN0WyJ6aF9DTiJdID0gIkNoaW5lc2UgKFNpbXBsaWZpZWQpIjsNCiAgICBMYW5nTGlzdFsicHRfQlIiXSA9ICJQb3J0dWd1ZXNlIChCcmF6aWxpYW4pIjsNCiAgICBMYW5nTGlzdFsibmxfTkwiXSA9ICJEdXRjaCI7DQogICAgTGFuZ0xpc3RbImRhIl0gPSAiRGFuaXNoIjsNCiAgICBMYW5nTGlzdFsidGgiXSA9ICJUaGFpIjsNCiAgICBMYW5nTGlzdFsiZmkiXSA9ICJGaW5uaXNoIjsNCiAgICBMYW5nTGlzdFsicnUiXSA9ICJSdXNzaWFuIjsNCg0KICAgIHZhciBVc2VyTGFuZyA9IHNmb3JjZS5jb25uZWN0aW9uLmdldFVzZXJJbmZvKCkudXNlckxhbmd1YWdlOwkvLyBJU08gY29kZSBvZiB0aGUgdXNlcidzIGxhbmd1YWdlDQoNCiAgICBpZiAoIUxhbmdMaXN0W1VzZXJMYW5nXSkgeyBVc2VyTGFuZyA9ICJFbmdsaXNoIjsgfQkJLy8gaWYgdXNlcidzIGxhbmd1YWdlIGlzIG5vdCBmb3VuZCwgZGVmYXVsdCBpdCB0byBFbmdsaXNoDQogICAgZWxzZSB7IFVzZXJMYW5nID0gTGFuZ0xpc3RbVXNlckxhbmddOyB9DQoNCiAgICB2YXIgbGlzdE1zZ3MgPSBzZm9yY2UuYXBleC5leGVjdXRlKCdTVk1YQy5DT01NX1RhZ1dlYlNlcnZpY2VzJywnVGFnZGF0YWZvclN1Ym1vZHVsZScse3RleHQ6c3VibW9kdWxlaWR9KTsgDQoJaWYobGlzdE1zZ3MubGVuZ3RoPjApDQoJew0KCQlmb3IgKHZhciBpbnRNc2dDb3VudD0wO2ludE1zZ0NvdW50PGxpc3RNc2dzLmxlbmd0aDtpbnRNc2dDb3VudCsrKQ0KCQl7DQoJCQl2YXIgS2V5PWxpc3RNc2dzW2ludE1zZ0NvdW50XS5LZXk7DQoJCQl2YXIgVmFsdWU9bGlzdE1zZ3NbaW50TXNnQ291bnRdLlZhbHVlOwkJCQ0KCQkJTXNnTGlzdFtLZXldPVZhbHVlOw0KCQl9DQoJCWZvdW5kPXRydWU7DQoJfQ0KDQogICAgaWYgKCFmb3VuZCkNCgl7DQoJaWYgKHN1Ym1vZHVsZWlkID09ICJQUkVRU0MxIikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdDYW5jZWwgUGFydHMgUmVxdWVzdCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ0NhbmNlbCBQYXJ0cyBSZXF1ZXN0ICc7CSAgICANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ0FyZSB5b3Ugc3VyZT8gJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBQYXJ0cyBSZXF1ZXN0IGhhcyBiZWVuIHByb2Nlc3NlZCBhbHJlYWR5LiBDYW5ub3QgY2FuY2VsLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1RoaXMgUGFydHMgUmVxdWVzdCBoYXMgYmVlbiBjYW5jZWxlZCBhbHJlYWR5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1NvbWUgaXRlbXMgaW4gdGhpcyBQYXJ0cyBSZXF1ZXN0IGhhdmUgYmVlbiBwcm9jZXNzZWQgcGFydGlhbGx5Lic7CSAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnUGxlYXNlIG9wZW4gdGhlIHBlbmRpbmcgcmVxdWVzdCBsaW5lcyB0byBjYW5jZWwgaW5kaXZpZHVhbGx5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9DQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIlBPUkRTQzEiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ0NhbmNlbCBTaGlwbWVudCBPcmRlcic7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ0NhbmNlbCBTaGlwbWVudCBPcmRlcic7CSAgICANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgU2hpcG1lbnQgT3JkZXIgaGFzIGJlZW4gY2xvc2VkIGFscmVhZHkuIENhbm5vdCBjYW5jZWwuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBTaGlwbWVudCBPcmRlciBoYXMgYmVlbiBjYW5jZWxlZCBhbHJlYWR5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1NvbWUgaXRlbXMgaW4gdGhpcyBzaGlwbWVudCBvcmRlciBoYXZlIGJlZW4gcHJvY2Vzc2VkIHBhcnRpYWxseS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdQbGVhc2Ugb3BlbiB0aGUgcGVuZGluZyBzaGlwbWVudCBsaW5lcyB0byBjYW5jZWwgaW5kaXZpZHVhbGx5Lic7CSAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkJDQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIldPUkRTQzEiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ0NhbmNlbCBXb3JrIE9yZGVyIFBhcnQgUmVxdWVzdHMnOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdDYW5jZWwgUGFydHMgUmVxdWVzdHMgaW4gV29yayBPcmRlciAnOwkgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdUaGlzIFdvcmsgT3JkZXIgaGFzIGJlZW4gY2xvc2VkIGFscmVhZHkuIENhbm5vdCBjYW5jZWwgcGFydHMgcmVxdWVzdHMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBXb3JrIE9yZGVyIGhhcyBiZWVuIGNhbmNlbGVkIGFscmVhZHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnUmVjb3JkIFR5cGUgZGVmaW5pdGlvbiBpcyBtaXNzaW5nLiBUaGlzIGlzIGFuIGludGVybmFsIGVycm9yLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoaXMgcGFydCByZXF1ZXN0IGhhcyBiZWVuIHByb2Nlc3NlZCBwYXJ0aWFsbHkuJzsJICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdDYW5ub3QgY2FuY2VsLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1NvbWUgcGFydHMgcmVxdWVzdHMgaW4gdGhpcyBXb3JrIE9yZGVyIGhhdmUgYmVlbiBwcm9jZXNzZWQgcGFydGlhbGx5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ1BsZWFzZSBvcGVuIHRoZSBwZW5kaW5nIHJlcXVlc3QgbGluZXMgdG8gY2FuY2VsIGluZGl2aWR1YWxseS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdBbGwgUGFydHMgcmVxdWVzdHMgY2FuY2VsZWQgc3VjY2Vzc2Z1bGx5ISc7DQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9DQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIlBSRVFTQzIiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ05ldyBTaGlwbWVudCBmcm9tIFBhcnRzIFJlcXVlc3QnOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdDcmVhdGUgU2hpcG1lbnQgT3JkZXIgZm9yIFBhcnRzIFJlcXVlc3QnOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgUXVhbnRpdHkgVG8gQmUgU2hpcHBlZCc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDA0J10gPSAnQ2FuY2VsJzsgIA0KCSAgICBNc2dMaXN0WydMQUIwMDUnXSA9ICdQcm9kdWN0IE5hbWUnOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDA2J10gPSAnUXVhbnRpdHkgUmVtYWluaW5nJzsgIA0KCSAgICBNc2dMaXN0WydMQUIwMDcnXSA9ICdRdWFudGl0eSBUbyBCZSBTaGlwcGVkJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdUaGlzIFBhcnRzIFJlcXVlc3QgaXMgY29tcGxldGVkIGFscmVhZHkuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgUGFydHMgUmVxdWVzdCBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IGNyZWF0ZSBzaGlwbWVudCBvcmRlci4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhlcmUgYXJlIG5vIHBlbmRpbmcgcGFydHMgcmVxdWVzdCBsaW5lcyB0byBwcm9jZXNzLic7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdUaGlzIGlzIG5vdCBhIHZhbGlkIHZhbHVlIGZvciBxdWFudGl0eSB0byBiZSBzaGlwcGVkLic7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdRdWFudGl0eSB0byBiZSBzaGlwcGVkIGNhbm5vdCBleGNlZWQgcmVtYWluaW5nIHF1YW50aXR5Lic7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDgnXSA9ICdZb3UgaGF2ZSBub3QgZW50ZXJlZCBlbm91Z2ggaW5mb3JtYXRpb24gdG8gY3JlYXRlIGEgc2hpcG1lbnQgb3JkZXIuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ1NoaXBtZW50IE9yZGVyIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5ISc7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdSZWNvcmQgVHlwZSBkZWZpbml0aW9uIGlzIG1pc3NpbmcuIFRoaXMgaXMgYW4gaW50ZXJuYWwgZXJyb3IuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gY3JlYXRpbmcgU2hpcG1lbnQgSGVhZGVyLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gY3JlYXRpbmcgU2hpcG1lbnQgbGluZXMuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsNCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0JCQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJXT1JEU0M1IikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdOZXcgU2hpcG1lbnQgZnJvbSBXb3JrIE9yZGVyJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnQ3JlYXRlIFNoaXBtZW50IE9yZGVyIGZvciBXb3JrIE9yZGVyJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddID0gJ0VudGVyIFF1YW50aXR5IFRvIEJlIFNoaXBwZWQgZnJvbTonOyANCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7IA0KCSAgICBNc2dMaXN0WydMQUIwMDUnXSA9ICdQcm9kdWN0IE5hbWUnOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDA2J10gPSAnUXVhbnRpdHkgUmVtYWluaW5nJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1YW50aXR5IFRvIEJlIFNoaXBwZWQnOyAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnVGhpcyBXb3JrIE9yZGVyIGlzIGNsb3NlZCBhbHJlYWR5LiBDYW5ub3QgY3JlYXRlIHNoaXBtZW50IG9yZGVyLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFdvcmsgT3JkZXIgaGFzIGJlZW4gY2FuY2VsZWQuIENhbm5vdCBjcmVhdGUgc2hpcG1lbnQgb3JkZXIuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1RoZXJlIGFyZSBubyBwZW5kaW5nIHBhcnQgcmVxdWVzdCBsaW5lcyB0byBwcm9jZXNzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdSZXF1ZXN0ZWQgRnJvbSBsb2NhdGlvbiBoYXMgbm90IGJlZW4gZmlsbGVkIGZvciBhbnkgb3BlbiByZXF1ZXN0cy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnUmVxdWlyZWQgQXQgbG9jYXRpb24gaGFzIG5vdCBiZWVuIGZpbGxlZCBmb3IgYW55IG9wZW4gcmVxdWVzdHMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1RoZXJlIGFyZSBubyBwZW5kaW5nIHBhcnRzIHJlcXVlc3QgbGluZXMgZm9yIHRoaXMgbG9jYXRpb24uJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ1JlY29yZCBUeXBlIGRlZmluaXRpb24gaXMgbWlzc2luZy4gVGhpcyBpcyBhbiBpbnRlcm5hbCBlcnJvci4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDExJ10gPSAnUGxlYXNlIHNlbGVjdCBhIHZhbGlkIGxvY2F0aW9uIGZpcnN0Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTInXSA9ICdUaGlzIGlzIG5vdCBhIHZhbGlkIHZhbHVlIGZvciBxdWFudGl0eSB0byBiZSBzaGlwcGVkLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTMnXSA9ICdRdWFudGl0eSB0byBiZSBzaGlwcGVkIGNhbm5vdCBleGNlZWQgcmVtYWluaW5nIHF1YW50aXR5Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTQnXSA9ICdZb3UgaGF2ZSBub3QgZW50ZXJlZCBlbm91Z2ggaW5mb3JtYXRpb24gdG8gY3JlYXRlIGEgc2hpcG1lbnQgb3JkZXIuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNSddID0gJ1NoaXBtZW50IE9yZGVyIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5ISc7IA0KCSAgICBNc2dMaXN0WydNU0cwMTYnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGNyZWF0aW5nIFNoaXBtZW50IEhlYWRlci4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE3J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBjcmVhdGluZyBTaGlwbWVudCBsaW5lcy4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyANCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0NCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiU0FESlNDMSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnUG9zdCBTdG9jayBBZGp1c3RtZW50IFRvIEludmVudG9yeSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Bvc3QgU3RvY2sgQWRqdXN0bWVudCc7IA0KCSAgICBNc2dMaXN0WydMQUIwMDInXSAgID0gJyB0byBpbnZlbnRvcnknOyANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1NlcnZpY2VNYXggSW52ZW50b3J5IG1vZHVsZSBpcyBub3QgZW5hYmxlZCBmb3IgeW91ciBvcmdhbml6YXRpb24uJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgc3RvY2sgYWRqdXN0bWVudCBoYXMgYmVlbiBwb3N0ZWQgdG8gaW52ZW50b3J5IGFscmVhZHkuJzsgIA0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGRlbGV0aW5nIHNlcmlhbCBudW1iZXJzLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFN0b2NrIEFkanVzdG1lbnQuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgDQoJICAgIH0NCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiU1hGUlNDMSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnUG9zdCBTdG9jayBUcmFuc2ZlciBUbyBJbnZlbnRvcnknOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdQb3N0IFN0b2NrIFRyYW5zZmVyJzsgICAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddID0gJyB0byBpbnZlbnRvcnknOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdTZXJ2aWNlTWF4IEludmVudG9yeSBtb2R1bGUgaXMgbm90IGVuYWJsZWQgZm9yIHlvdXIgb3JnYW5pemF0aW9uLic7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBzdG9jayB0cmFuc2ZlciByZWNvcmQuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJzogVHJhbnNmZXIgcXVhbnRpdHkgZXhjZWVkcyBhdmFpbGFibGUgcXVhbnRpdHkuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoaXMgc3RvY2sgdHJhbnNmZXIgaGFzIGJlZW4gcG9zdGVkIHRvIGludmVudG9yeSBhbHJlYWR5Lic7ICAgIAkNCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBzdG9jay4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBTdG9jayBUcmFuc2ZlciBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0JCQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJXT1JEU0M3IikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQb3N0IFVzYWdlIFRvIEludmVudG9yeSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Bvc3QgdXNhZ2UvY29uc3VtcHRpb24gZm9yIFdvcmsgT3JkZXInOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnIHRvIGludmVudG9yeSc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1NlcnZpY2VNYXggSW52ZW50b3J5IG1vZHVsZSBpcyBub3QgZW5hYmxlZCBmb3IgeW91ciBvcmdhbml6YXRpb24uJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoZXJlIGFyZSBubyB1c2FnZS9jb25zdW1wdGlvbiBsaW5lcyBpbiB0aGlzIFdvcmsgT3JkZXIuJzsgICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdSZWNvcmQgVHlwZSBkZWZpbml0aW9uIGlzIG1pc3NpbmcuIFRoaXMgaXMgYW4gaW50ZXJuYWwgZXJyb3IuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1VzYWdlL0NvbnN1bXB0aW9uIGxpbmVzIHNob3VsZCBoYXZlIGEgbGluZSB0eXBlICJQYXJ0cyIgYW5kIG5vdCBwb3N0ZWQgdG8gaW52ZW50b3J5IGFscmVhZHkuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgc3RvY2suJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgV29yayBPcmRlciBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnQ29uc3VtZWQgRnJvbSBMb2NhdGlvbiBtdXN0IGJlIGVudGVyZWQgZm9yIGFsbCB1c2FnZS9jb25zdW1wdGlvbiBwYXJ0cyByZWNvcmRzLic7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkNCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiV09SRFNDOSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnUHJvY2VzcyBSZWNlaXB0cyBmb3IgV29yayBPcmRlcic7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Byb2Nlc3MgUmVjZWlwdHMgZm9yIFdvcmsgT3JkZXInOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgUmVjZWl2ZWQgUXVhbnRpdHkgYW5kL29yIENsb3NlIFJlcXVlc3RzJzsgICAgICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsgCQ0KCSAgICBNc2dMaXN0WydMQUIwMDQnXSA9ICdDYW5jZWwnOyAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7IA0KCSAgICBNc2dMaXN0WydMQUIwMDYnXSA9ICdRdWFudGl0eSBSZXF1ZXN0ZWQnOyAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDcnXSA9ICdRdWFudGl0eSBSZWNlaXZlZCc7IA0KCSAgICBNc2dMaXN0WydMQUIwMDgnXSA9ICdDbG9zZSBSZXF1ZXN0JzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdUaGlzIGlzIG5vdCBhIHZhbGlkIHZhbHVlIGZvciByZWNlaXZlZCBxdWFudGl0eS4nOyAJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1JlY2VpdmVkIHF1YW50aXR5IGNhbm5vdCBleGNlZWQgcmVxdWVzdGVkIHF1YW50aXR5Lic7ICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1RoaXMgaXRlbSBoYXMgYmVlbiBzaGlwcGVkIGFscmVhZHkuIENhbm5vdCBzaG9ydC1jbG9zZS4nOyAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdTaGlwbWVudCBoYXMgYmVlbiBpbml0aWF0ZWQgZm9yIHRoaXMgcmVxdWVzdCEgQ2Fubm90IHNob3J0LWNsb3NlLic7ICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdZb3UgaGF2ZSBub3QgZW50ZXJlZCBlbm91Z2ggaW5mb3JtYXRpb24gdG8gcHJvY2VzcyByZWNlaXB0cy4nOyAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDgnXSA9ICdUaGlzIFdvcmsgT3JkZXIgaXMgY2xvc2VkIGFscmVhZHkuIENhbm5vdCBwcm9jZXNzIHJlY2VpcHRzLic7IAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ1RoaXMgV29yayBPcmRlciBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IHByb2Nlc3MgcmVjZWlwdHMuJzsgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDEwJ10gPSAnUmVjb3JkIFR5cGUgZGVmaW5pdGlvbiBpcyBtaXNzaW5nLiBUaGlzIGlzIGFuIGludGVybmFsIGVycm9yLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTEnXSA9ICdUaGlzIHBhcnRzIHJlcXVlc3QgbGluZSBpcyBub3Qgb3Blbi4gQ2Fubm90IHByb2NlZWQgdG8gcHJvY2VzcyByZWNlaXB0cyc7IA0KCSAgICBNc2dMaXN0WydNU0cwMTInXSA9ICdUaGVyZSBhcmUgbm8gb3BlbiBwYXJ0cyByZXF1ZXN0IGxpbmVzIHRvIHByb2Nlc3MuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ1BhcnRzIHJlcXVlc3RzIGluIHRoaXMgV29yayBvcmRlciB3aXRob3V0IGEgRnJvbSBvciBUbyBsb2NhdGlvbiBhcmUgbm90IGxpc3RlZCBoZXJlLiBUbyBjb3JyZWN0IHRoaXMsIHBsZWFzZSBlbnRlciB0aGUgbG9jYXRpb25zIGJlZm9yZSBwcm9jZXNzaW5nIHJlY2VpcHRzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTQnXSA9ICdGcm9tIGFuZCBUbyBsb2NhdGlvbnMgYXJlIG5vdCBlbnRlcmVkIGZvciBhbnkgb3BlbiBwYXJ0cyByZXF1ZXN0cy4gVG8gY29ycmVjdCB0aGlzLCBwbGVhc2UgZW50ZXIgdGhlIGxvY2F0aW9ucyBiZWZvcmUgcHJvY2Vzc2luZyByZWNlaXB0cy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE1J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBzdG9jay4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE2J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBXb3JrIE9yZGVyIGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTcnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGNyZWF0aW5nIFdvcmsgT3JkZXIgbGluZXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxOCddID0gJ1JlY2VpcHRzIHByb2Nlc3NpbmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEnOyANCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0JCQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJQUkVRU0MzIikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQcm9jZXNzIFJlY2VpcHRzIGZvciBQYXJ0cyBSZXF1ZXN0JzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnUHJvY2VzcyBSZWNlaXB0cyBmb3IgUGFydHMgUmVxdWVzdCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddID0gJ0VudGVyIFJlY2VpdmVkIFF1YW50aXR5IGFuZC9vciBDbG9zZSBSZXF1ZXN0cyc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMyddID0gJ1N1Ym1pdCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNiddID0gJ1F1YW50aXR5IFJlcXVlc3RlZCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1YW50aXR5IFJlY2VpdmVkJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA4J10gPSAnQ2xvc2UgUmVxdWVzdCc7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgUGFydHMgUmVxdWVzdCBpcyBjb21wbGV0ZWQgYWxyZWFkeS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFBhcnRzIFJlcXVlc3QgaGFzIGJlZW4gY2FuY2VsZWQuIENhbm5vdCBwcm9jZXNzIHJlY2VpcHRzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ0RlZmF1bHQgU3VwcGxpZXIgTG9jYXRpb24gaXMgbm90IHNldHVwLiBUaGlzIGlzIGEgc2V0dXAgaXNzdWUuXG5QbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnVGhlcmUgYXJlIG5vIG9wZW4gcGFydHMgcmVxdWVzdCBsaW5lcyB0byBwcm9jZXNzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHJlY2VpdmVkIHF1YW50aXR5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1JlY2VpdmVkIHF1YW50aXR5IGNhbm5vdCBleGNlZWQgcmVxdWVzdGVkIHF1YW50aXR5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ1RoaXMgaXRlbSBoYXMgYmVlbiBzaGlwcGVkIGFscmVhZHkuIENhbm5vdCBzaG9ydC1jbG9zZS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdTaGlwbWVudCBoYXMgYmVlbiBpbml0aWF0ZWQgZm9yIHRoaXMgcmVxdWVzdCEgQ2Fubm90IHNob3J0LWNsb3NlLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ1lvdSBoYXZlIG5vdCBlbnRlcmVkIGVub3VnaCBpbmZvcm1hdGlvbiB0byBwcm9jZXNzIHJlY2VpcHRzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ1JlY2VpcHRzIHByb2Nlc3NpbmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEnOw0KCSAgICBNc2dMaXN0WydNU0cwMTMnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJQT1JEU0M2IikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQcm9jZXNzIFJlY2VpcHRzIGZvciBSTUEnOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdQcm9jZXNzIFJlY2VpcHRzIGZvciBSTUEgJzsgICAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddID0gJ0VudGVyIFJlY2VpdmVkIFF1YW50aXR5IGFuZC9vciBDbG9zZSBMaW5lcyc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDQnXSA9ICdDYW5jZWwnOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDYnXSA9ICdRdWFudGl0eSBFeHBlY3RlZCc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDA3J10gPSAnUXVhbnRpdHkgUmVjZWl2ZWQnOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwOCddID0gJ0Nsb3NlIExpbmUnOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdUaGlzIFJNQSBpcyBjbG9zZWQgYWxyZWFkeS4gQ2Fubm90IHByb2Nlc3MgcmVjZWlwdHMuJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFJNQSBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IHByb2Nlc3MgcmVjZWlwdHMuJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdEZXN0aW5hdGlvbiBsb2NhdGlvbiBjYW5ub3QgYmUgYmxhbmsuJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdUaGUgZGVzdGluYXRpb24gbG9jYXRpb24gaXMgbm90IGEgc3RvY2tpbmcgbG9jYXRpb24uJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdUaGlzIFJNQSBsaW5lIGlzIG5vdCBvcGVuLiBDYW5ub3QgcHJvY2VzcyByZWNlaXB0cy4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1RoZXJlIGFyZSBubyBvcGVuIFJNQSBsaW5lcyB0byBwcm9jZXNzLic7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnWW91IGhhdmUgbm90IGVudGVyZWQgZW5vdWdoIGluZm9ybWF0aW9uIHRvIHByb2Nlc3MgcmVjZWlwdHMuJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdSZWNvcmQgVHlwZSBkZWZpbml0aW9uIGlzIG1pc3NpbmcuIFRoaXMgaXMgYW4gaW50ZXJuYWwgZXJyb3IuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHJlY2VpdmVkIHF1YW50aXR5Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTInXSA9ICdSZWNlaXZlZCBxdWFudGl0eSBjYW5ub3QgZXhjZWVkIGV4cGVjdGVkIHF1YW50aXR5Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTMnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTQnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFJNQSBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE1J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBjcmVhdGluZyBSTUEgbGluZXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNiddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgUk1BIEhlYWRlci4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE3J10gPSAnUmVjZWlwdHMgcHJvY2Vzc2luZyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISc7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkJDQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIlBPUkRTQzgiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ1Byb2Nlc3MgU2hpcG1lbnRzJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnUHJvY2VzcyBTaGlwbWVudHMgZm9yIFNoaXBtZW50IE9yZGVyJzsgICAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddID0gJ0VudGVyIFNoaXBwZWQgUXVhbnRpdHkgYW5kL29yIENsb3NlIFJlcXVlc3RzICc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsgCQ0KCSAgICBNc2dMaXN0WydMQUIwMDQnXSA9ICdDYW5jZWwnOyAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7IA0KCSAgICBNc2dMaXN0WydMQUIwMDYnXSA9ICdRdWFudGl0eSBSZXF1ZXN0ZWQnOyAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDcnXSA9ICdRdWFudGl0eSBTaGlwcGVkJzsgCQ0KCSAgICBNc2dMaXN0WydMQUIwMDgnXSA9ICdDbG9zZSBSZXF1ZXN0JzsgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgU2hpcG1lbnQgT3JkZXIgaXMgY2xvc2VkIGFscmVhZHkuJzsgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgU2hpcG1lbnQgT3JkZXIgaGFzIGJlZW4gY2FuY2VsZWQuIENhbm5vdCBwcm9jZXNzIHNoaXBtZW50cy4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1RoZSBzb3VyY2UgbG9jYXRpb24gaXMgYmxhbmsgZm9yIHRoaXMgc2hpcG1lbnQgb3JkZXIuIENhbm5vdCBwcm9jZXNzIHNoaXBtZW50cy4nOyAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoZSBkZXN0aW5hdGlvbiBsb2NhdGlvbiBpcyBibGFuayBmb3IgdGhpcyBzaGlwbWVudCBvcmRlci4gQ2Fubm90IHByb2Nlc3Mgc2hpcG1lbnRzLic7ICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ0RlZmF1bHQgQ3VzdG9tZXIgTG9jYXRpb24gaXMgbm90IHNldHVwLiAnOyAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnVGhlcmUgYXJlIG5vIG9wZW4gc2hpcG1lbnQgbGluZXMgdG8gcHJvY2Vzcy4nOyAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDknXSA9ICdUaGlzIGlzIG5vdCBhIHZhbGlkIHZhbHVlIGZvciBzaGlwcGVkIHF1YW50aXR5Lic7ICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdTaGlwcGVkIHF1YW50aXR5IGNhbm5vdCBleGNlZWQgcmVxdWVzdGVkIHF1YW50aXR5Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTEnXSA9ICdZb3UgaGF2ZSBub3QgZW50ZXJlZCBlbm91Z2ggaW5mb3JtYXRpb24gdG8gcHJvY2VzcyB0aGlzIHNoaXBtZW50Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTInXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTMnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFNoaXBtZW50IGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTQnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFBhcnRzIFJlcXVlc3QgbGluZXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNSddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgV29yayBPcmRlciBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE2J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBjcmVhdGluZyBTaGlwbWVudCBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE3J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBTaGlwbWVudCBPcmRlci4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE4J10gPSAnU2hpcG1lbnRzIHByb2Nlc3NpbmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEnOyANCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0NCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiU0xLUFNDMSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnU3RvY2sgTG9jYXRvcic7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Nob3cvSGlkZSBPcHRpb25zJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnWW91ciBMb2NhdGlvbjogICc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMyddID0gJyBTaG93IFJlc3VsdHMgQXM6ICc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0ZpbmQgU3RvY2snOw0KCSAgICBNc2dMaXN0WydMQUIwMDUnXSA9ICdTaG93L0hpZGUgUmVzdWx0cyc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNiddID0gJ1Nob3cvSGlkZSBNYXAnOw0KCSAgICBNc2dMaXN0WydMQUIwMDcnXSA9ICdSZXF1ZXN0IFN0b2NrJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA4J10gPSAnQ2FuY2VsJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA5J10gPSAnTG9jYXRpb24nOw0KCSAgICBNc2dMaXN0WydMQUIwMTAnXSA9ICdTdHJlZXQnOw0KCSAgICBNc2dMaXN0WydMQUIwMTEnXSA9ICdDaXR5JzsNCgkgICAgTXNnTGlzdFsnTEFCMDEyJ10gPSAnU3RhdGUnOw0KCSAgICBNc2dMaXN0WydMQUIwMTMnXSA9ICdaaXAnOw0KCSAgICBNc2dMaXN0WydMQUIwMTQnXSA9ICdDb3VudHJ5JzsNCgkgICAgTXNnTGlzdFsnTEFCMDE1J10gPSAnUGhvbmUnOw0KCSAgICBNc2dMaXN0WydMQUIwMTYnXSA9ICdBdmFpbGFibGUgUXVhbnRpdHknOw0KCSAgICBNc2dMaXN0WydMQUIwMTcnXSA9ICdEaXN0YW5jZSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxOCddID0gJ1JlcXVlc3QnOwkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAxOSddID0gJ01hcCxHcmlkLEJvdGgnOwkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAyMCddID0gJ0tpbG9tZXRlcnMsTWlsZXMnOwkJCQ0KCSAgICBNc2dMaXN0WydMQUIwMjEnXSA9ICdPcHRpb25zOic7DQoJICAgIE1zZ0xpc3RbJ0xBQjAyMiddID0gJ1JhZGl1czogJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1BsZWFzZSBzZWxlY3QgYSBzdG9jayBsb2NhdGlvbiB0byByZXF1ZXN0IGZyb20uJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnUHJvZ3JhbW1pbmcgZXJyb3IuIEludmFsaWQgcmVjb3JkIHR5cGUuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnTm90IEF2YWlsYWJsZS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdGaW5kIHN0b2NrIGZvcjogICc7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ1JlcXVpcmVkIFF1YW50aXR5OiAgJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnVW5hYmxlIHRvIGRpc3BsYXkgbWFwLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ0FkZHJlc3MgZm9yIHRoZSBSZXF1aXJlZCBsb2NhdGlvbiBpcyBlaXRoZXIgaW5jb3JyZWN0IG9yIGluY29tcGxldGUuIFRoZSBtYXAgbWF5IG5vdCBiZSBkaXNwbGF5ZWQgcHJvcGVybHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDEwJ10gPSAnWW91IGFyZSBoZXJlISc7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ05vIHN0b2NrIGF2YWlsYWJsZSBpbiBhbnkgbG9jYXRpb24uJzsNCgkgICAgTXNnTGlzdFsnTVNHMDEyJ10gPSAnRG91YmxlLWNsaWNrIHRoZSBpbWFnZSB0byByZXF1ZXN0IHN0b2NrIGZyb20gdGhpcyBsb2NhdGlvbi4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTMnXSA9ICdQaG9uZTogICc7DQoJICAgIE1zZ0xpc3RbJ01TRzAxNCddID0gJ1N0b2NrOiAgJzsNCgkgICAgTXNnTGlzdFsnTVNHMDE1J10gPSAnOiBBcmUgeW91IHN1cmUgdG8gcmVxdWVzdCBzdG9jayBmcm9tIHRoaXMgbG9jYXRpb24/JzsNCgkgICAgTXNnTGlzdFsnTVNHMDE3J10gPSAnV29yayBPcmRlciBQYXJ0IFJlcXVlc3QgdXBkYXRlZCBzdWNjZXNzZnVsbHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDE4J10gPSAnRXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBwYXJ0cyByZXF1ZXN0OiAnOw0KCSAgICBNc2dMaXN0WydNU0cwMTknXSA9ICdQcm9ncmFtbWluZyBlcnJvci4gVW5zdXBwb3J0ZWQgc291cmNlIHJlY29yZCB0eXBlLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMjAnXSA9ICdQYXJ0IFJlcXVlc3QgdXBkYXRlZCBzdWNjZXNzZnVsbHkuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAyMSddID0gJ1Vua25vd24nOyANCgkgICAgTXNnTGlzdFsnTVNHMDIyJ10gPSAnTm8gc3RvY2sgYXZhaWxhYmxlIHdpdGhpbiB0aGUgZ2l2ZW4gcmFkaXVzJzsNCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0NCgllbHNlDQoJICAgIGFsZXJ0KCJVbnN1cHBvcnRlZCBzdWJtb2R1bGUgIiArIHN1Ym1vZHVsZWlkICsgIi4gVGhpcyBpcyBhIHByb2dyYW1taW5nIGVycm9yLiIpOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gR2V0IHRoZSBtZXNzYWdlIGZvciB0aGUgZ2l2ZW4gbWVzc2FnZSBudW1iZXIgZnJvbSB0aGUgZ2xvYmFsIGhhc2ggdGFibGUuDQovLyBSZXR1cm4gInNldHVwLWlzc3VlIiBpZiB0aGUgbWVzc2FnZSBpcyBub3QgZm91bmQNCmZ1bmN0aW9uIFNWTVhJX0dldE1lc3NhZ2UoTXNnTnVtKQ0Kew0KICAgIGlmICghTXNnTGlzdFtNc2dOdW1dKQ0KCXJldHVybiAiTWVzc2FnZSBkZWZpbml0aW9uIGZvciAiICsgTXNnTnVtICsgIiBub3QgZm91bmQuIFRoaXMgaXMgYSBzZXR1cCBpc3N1ZS5cblBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4iOw0KDQogICAgcmV0dXJuIE1zZ0xpc3RbTXNnTnVtXTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU2V0TGFiZWxzKGZvcm1uYW1lKQ0Kew0KICAgIHZhciBsYWJlbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGFiZWwnKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhYmVscy5sZW5ndGg7IGkrKykNCgl7DQoJdmFyIGYgPSBsYWJlbHNbaV07DQoJaWYgKE1zZ0xpc3RbZi5uYW1lXSkNCgkgICAgZi5pbm5lclRleHQgPSBNc2dMaXN0W2YubmFtZV07DQoJfQ0KICAgIHZhciBoMWxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaDEnKTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IGgxbGlzdC5sZW5ndGg7IGsrKykNCgl7DQoJdmFyIGYgPSBoMWxpc3Rba107DQoJaWYgKE1zZ0xpc3RbZi5pZF0pDQoJICAgIGYuaW5uZXJIVE1MID0gTXNnTGlzdFtmLmlkXTsNCgl9DQogICAgdmFyIGgybGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoMicpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgaDJsaXN0Lmxlbmd0aDsgbSsrKQ0KCXsNCgl2YXIgZiA9IGgybGlzdFttXTsNCglpZiAoTXNnTGlzdFtmLmlkXSkNCgkgICAgZi5pbm5lckhUTUwgPSBNc2dMaXN0W2YuaWRdOw0KCX0NCiAgICB2YXIgZWxlbXMgPSBkb2N1bWVudC5mb3Jtc1tmb3JtbmFtZV0uZWxlbWVudHM7DQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbGVtcy5sZW5ndGg7IGorKykNCgl7DQoJdmFyIGYgPSBlbGVtc1tqXTsNCglpZiAoKGYudHlwZSA9PSAnYnV0dG9uJyB8fCBmLnR5cGUgPT0gJ2NoZWNrYm94JykgJiYgTXNnTGlzdFtmLm5hbWVdKQ0KCQl7DQoJICAgIGYudmFsdWUgPSBNc2dMaXN0W2YubmFtZV07DQoJCQlpZiAoZi50eXBlID09ICdidXR0b24nKQ0KCQkJCWYudGl0bGUgPSBNc2dMaXN0W2YubmFtZV07DQoJCX0NCgkJDQoJfQ0KCSAvL3RvIHBvcHVsYXRlIHBpY2tsaXN0IGZpZWxkDQoJIHZhciBzZWxlY3RzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NlbGVjdCcpOw0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZWN0cy5sZW5ndGg7IGorKykNCgl7DQoJdmFyIGYgPSBzZWxlY3RzW2pdOw0KDQoJaWYgKE1zZ0xpc3RbZi5uYW1lXSkNCgkgICAgIHsNCgkJDQoJCSAgLy92YXIgb3B0aW9uc0xpc3RTdHJpbmcgID0gTXNnTGlzdFtmLm5hbWVdOwkJIA0KCQkgICAvL29wdGlvbnNMaXN0ID1vcHRpb25zTGlzdFN0cmluZy5zcGxpdCgnLCcpOwkJDQoJCSAgLy8gdmFyIG9wdGlvbnNMaXN0U3RyaW5nICA9IE1zZ0xpc3RbZi5uYW1lXTsJCSANCgkJICAgb3B0aW9uc0xpc3QgPU1zZ0xpc3RbZi5uYW1lXS5zcGxpdCgnLCcpOwkNCgkJIGZvciAodmFyIGs9MDtrPG9wdGlvbnNMaXN0Lmxlbmd0aDtrKyspDQoJCQl7CQkNCgkJCQl2YXIgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnT1BUSU9OJyk7DQoJCQkJb3B0LnZhbHVlID0gb3B0aW9uc0xpc3Rba107DQoJCQkJb3B0LnRleHQgPSBvcHRpb25zTGlzdFtrXTsJCS8vCQlvcHQudGV4dCA9IChvcHRpb25zTGlzdFtrXT09J251bGwnKT8nJzpvcHRpb25zTGlzdFtrXTsJCQkJDQoJCQkJZi5vcHRpb25zLmFkZChvcHQsIGspOwkJCQ0KCQkJfQ0KCQkJZi5zZWxlY3RlZEluZGV4ID1vcHRpb25zTGlzdC5sZW5ndGgtMTsNCgkJIH0NCgl9DQoJaWYgKE1zZ0xpc3RbIkxBQjAwMCJdKQ0KCQlkb2N1bWVudC50aXRsZSA9IE1zZ0xpc3RbIkxBQjAwMCJdOyANCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT0gRU5EIFJlbGVhc2UgMi4wIGNoYW5nZXMgZm9yIHRyYW5zbGF0aW9uID09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIENsb3NlV2luZG93KCkNCnsNCiAgICB3aW5kb3cuY2xvc2UoKTsNCn0NCg0KZnVuY3Rpb24gU1ZNWElfR2V0Q3VycmVudFRpbWUoKQ0Kew0KICAgIHZhciBzZXJ2ZXJUaW1lID0gc2ZvcmNlLmNvbm5lY3Rpb24uZ2V0U2VydmVyVGltZXN0YW1wKCk7DQogICAgcmV0dXJuIHNlcnZlclRpbWUudGltZXN0YW1wOw0KfQ0KDQpmdW5jdGlvbiBTVk1YSV9DaGVja0FuZENsb3NlKCkNCnsNCiAgICB2YXIgYW5zID0gY29uZmlybShTVk1YSV9HZXRNZXNzYWdlKCJNU0c5OTkiKSk7DQogICAgaWYgKGFucykgeyBDbG9zZVdpbmRvdygpOyB9DQp9DQoNCmZ1bmN0aW9uIGlzVmFsaWROdW1iZXIoZXZ0KQ0Kew0KICAgIHZhciBjaGFyQ29kZSA9IChldnQud2hpY2gpID8gZXZ0LndoaWNoIDogZXZlbnQua2V5Q29kZQ0KICAgIGlmIChjaGFyQ29kZSA+IDMxICYmIChjaGFyQ29kZSA8IDQ4IHx8IGNoYXJDb2RlID4gNTcpKQ0KCXJldHVybiBmYWxzZTsNCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KDQpmdW5jdGlvbiBkcmF3TXNnKHRhLG1zZykNCnsNCiAgICBpZiAoIXRhKSB0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQogICAgY2xlYXJfdGFibGUoIHRhICk7DQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pO3RhLmFwcGVuZENoaWxkKHRyKTsNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J2NsYXNzJzonYWN0aW9uQ29sdW1uJywnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0gbXNnOw0KfQ0KDQpmdW5jdGlvbiBjbGVhcl90YWJsZSh0Ym9keSkNCnsNCiAgICBpZiAoIXRib2R5KSB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQogICAgd2hpbGUgKHRib2R5LnJvd3MubGVuZ3RoID4gMCkgCXsgdGJvZHkuZGVsZXRlUm93KDApOyB9DQp9DQoNCmZ1bmN0aW9uIG1ha2VBdHRycyhpLHRhKQ0Kew0KICAgIHZhciBhdHRzID0gbmV3IE9iamVjdCgpOw0KICAgIC8vIGhvdyBtYW55IHJvd3MgaW4gdGhpcyB0YWJsZSBzbyBmYXINCiAgICB0cnkgeyB0YS5ldmVuIH0gY2F0Y2ggKGUpIHsgdGEuZXZlbiA9IGl9Ow0KICAgIGlmIChpPT0wKSB7IC8vIHNraW4gc3R1ZmYNCgkgICAgYXR0c1siY2xhc3MiXSA9ICJldmVuIGZpcnN0IjsNCiAgICB9IGVsc2UgaWYgKHRhLmV2ZW4gPT0gdHJ1ZSkgew0KCSAgICBhdHRzWyJjbGFzcyJdID0gImV2ZW4iOw0KICAgIH0gZWxzZSB7DQoJICAgIGF0dHNbImNsYXNzIl0gPSAib2RkIjsNCiAgICB9DQogICAgdGEuZXZlbiA9ICF0YS5ldmVuOw0KICAgIGF0dHNbIm9ubW91c2VvdXQiXSA9ICJpZiAodHlwZW9mKGhpT2ZmKSAhPSAndW5kZWZpbmVkJyAmJiB0aGlzLmFjdGl2ZSA9PSBmYWxzZSl7aGlPZmYodGhpcyk7fSI7DQogICAgYXR0c1sib25tb3VzZW92ZXIiXSA9ICJpZiAodHlwZW9mKGhpT24pICE9ICd1bmRlZmluZWQnKXtoaU9uKHRoaXMpO30iOw0KICAgIHJldHVybiBhdHRzOw0KfQ0KDQpmdW5jdGlvbiBtYWtlUm93KGF0dHMpDQp7DQogICAgdmFyIGJyb3dzZXIgPSBuYXZpZ2F0b3IuYXBwTmFtZTsNCiAgICBpZiAoYnJvd3NlciA9PSAiTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyIikgew0KCSAgICB2YXIgdHJUYWcgPSAiPFRSICI7DQoJICAgIGZvciAoa2V5IGluIGF0dHMpIHsNCgkJICAgIHRyVGFnICs9IGtleSArICI9XCIiICsgYXR0c1trZXldICsgIlwiIjsNCgkgICAgfQ0KCSAgICB0clRhZyArPSAiPiI7DQoJICAgIHZhciByZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRyVGFnKTsNCiAgICB9IGVsc2Ugew0KCSAgICB2YXIgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJUUiIpOw0KCSAgICBmb3IgKGtleSBpbiBhdHRzKSB7DQoJCSAgICB0ci5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRzW2tleV0pOw0KCSAgICB9DQoJICAgIHZhciByZXQgPSB0cjsNCiAgICB9DQogICAgcmV0LmFjdGl2ZSA9IGZhbHNlOw0KICAgIHJldHVybiByZXQ7DQp9DQoNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIFNUUklORyBGdW5jdGlvbnMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KLy8gUmVtb3ZlcyBsZWFkaW5nIHdoaXRlc3BhY2VzDQpmdW5jdGlvbiBMVHJpbSggdmFsdWUgKSANCnsNCiAgICB2YXIgcmUgPSAvXHMqKChcUytccyopKikvOw0KICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKHJlLCAiJDEiKTsNCn0NCg0KLy8gUmVtb3ZlcyBlbmRpbmcgd2hpdGVzcGFjZXMNCmZ1bmN0aW9uIFJUcmltKCB2YWx1ZSApIA0Kew0KICAgIHZhciByZSA9IC8oKFxzKlxTKykqKVxzKi87DQogICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UocmUsICIkMSIpOw0KfQ0KDQovLyBSZW1vdmVzIGxlYWRpbmcgYW5kIGVuZGluZyB3aGl0ZXNwYWNlcw0KZnVuY3Rpb24gdHJpbSggdmFsdWUgKSANCnsNCiAgICByZXR1cm4gTFRyaW0oUlRyaW0odmFsdWUpKTsNCn0NCgkNCmZ1bmN0aW9uIExlZnQoc3RyLCBuKQ0Kew0KICAgIGlmIChuIDw9IDApDQoJcmV0dXJuICIiOw0KICAgIGVsc2UgaWYgKG4gPiBTdHJpbmcoc3RyKS5sZW5ndGgpDQoJcmV0dXJuIHN0cjsNCiAgICBlbHNlDQoJcmV0dXJuIFN0cmluZyhzdHIpLnN1YnN0cmluZygwLG4pOw0KfQ0KZnVuY3Rpb24gUmlnaHQoc3RyLCBuKQ0Kew0KICAgIGlmIChuIDw9IDApDQogICAgICAgcmV0dXJuICIiOw0KICAgIGVsc2UgaWYgKG4gPiBTdHJpbmcoc3RyKS5sZW5ndGgpDQogICAgICAgcmV0dXJuIHN0cjsNCiAgICBlbHNlIHsNCiAgICAgICB2YXIgaUxlbiA9IFN0cmluZyhzdHIpLmxlbmd0aDsNCiAgICAgICByZXR1cm4gU3RyaW5nKHN0cikuc3Vic3RyaW5nKGlMZW4sIGlMZW4gLSBuKTsNCiAgICB9DQp9DQoJDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICBEYXRlIFV0aWxpdGllcy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLw0KDQpmdW5jdGlvbiBDb252ZXJ0RGF0ZVRvU0ZEQ0RhdGUodGhlRGF0ZSkNCnsNCiAgICB2YXIgdG9kYXkgPSB0aGVEYXRlOw0KICAgIHZhciB5ZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTsNCiAgICB2YXIgbW9udGggPSBwYXJzZUZsb2F0KHRvZGF5LmdldE1vbnRoKCkpICsgMTsNCiAgICBpZiAobW9udGggPCAxMCkgeyBtb250aCA9ICIwIiArIG1vbnRoOyB9DQogICAgdmFyIGRheSA9IHBhcnNlRmxvYXQodG9kYXkuZ2V0RGF0ZSgpKTsNCiAgICBpZiAoZGF5IDwgMTApIHsgZGF5ID0gIjAiICsgZGF5OyB9DQogICAgcmV0dXJuICB5ZWFyICsgIi0iICsgbW9udGggKyAiLSIgKyBkYXk7DQp9DQoNCi8qPT09PT09PT09ICAgU1RPQ0svU0VSSUFMIFVUSUxJVElFUyAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQoNCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFNlcmlhbCBOdW1iZXIgU0FWRSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQp2YXIgc1Nhdl9wcm9jZXNzTG9nID0gIiI7DQp2YXIgc1Nhdl92UHJvZFN0a0FyOyANCnZhciBzU2F2X3ZVc2VyOyAvLyBTdG9yZXMgVXNlciBOYW1lL2RlYWlscyANCnZhciBzU2F2X3ZVc2VySWQ7DQpmdW5jdGlvbiBTVk1YSV9Eb1NlcmlhbFNhdmUoY1Byb2RTdGtBciwgY1VzZXJJZCkgDQp7CQ0KCXNTYXZfdlByb2RTdGtBciA9IGNQcm9kU3RrQXI7IC8vQW4gYXJyYXkgY29udGFpbmluZzogUHJvZHVjdCBJZCwgRnJvbSBQcm9kdWN0IFN0b2NrIElELCBUbyBQcm9kdWN0IFN0b2NrIElELCBTZXJpYWwgTnVtYmVyCXZhciBza1Nhdl9wcm9jZXNzTG9nID0gIiI7DQoJc1Nhdl92Y3VycmRhdGUgPSBuZXcgRGF0ZSgpOyANCglzU2F2X3ZVc2VySWQgPWNVc2VySWQ7DQoJdmFyIHJlc3VsdDsNCgl2YXIgcmVzdWx0QXIgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoY1Byb2RTdGtBci5sZW5ndGgsNCk7IC8vU2FtZSBTaXplIGFzIG9mIElucHV0IEFycmF5DQoJZm9yICh2YXIgYT0wOyBhPHNTYXZfdlByb2RTdGtBci5sZW5ndGggO2ErKykgLy9Mb29wIHRoZSBQcm9kIGFycmF5IGFuZCBkbyBQUyBVcGRhdGUvQ3JlYXRlIFNlcmlhbCdzIFBTIElEDQoJew0KCQlyZXN1bHRBclthXVswXSA9IHRydWU7IC8vU3RhdHVzIFRydWUvZmFsc2UNCgkJcmVzdWx0QXJbYV1bMV0gPSBzU2F2X3ZQcm9kU3RrQXJbYV1bMF07IC8vUHJvZHVjdCBJZA0KCQlyZXN1bHRBclthXVsyXSA9IHNTYXZfdlByb2RTdGtBclthXVszXTsgLy9TZXJpYWwgTm8NCgkJcmVzdWx0QXJbYV1bM10gPSAiIjsgLy9FcnJvciBNc2cNCg0KCQlpZiAoc1Nhdl92UHJvZFN0a0FyW2FdWzBdICE9ICIiICYmIHNTYXZfdlByb2RTdGtBclthXVsyXSAhPSAiIiAmJiBzU2F2X3ZQcm9kU3RrQXJbYV1bM10gIT0gIiIgKSAvL1ZhbGlkYXRlIFByb2RBciBJdGVtIGlzIG5vdCBibGFuaw0KCQl7DQoJCQl2YXIgc2VsUHJvZElkID0gc1Nhdl92UHJvZFN0a0FyW2FdWzBdOw0KCQkJdmFyIHNlbEZyb21QU0lEID0gc1Nhdl92UHJvZFN0a0FyW2FdWzFdOwkJCQkNCgkJCXZhciBzZWxUb1BTSUQgPSBzU2F2X3ZQcm9kU3RrQXJbYV1bMl07CQkJCQ0KCQkJdmFyIHNlbFNOID0gc1Nhdl92UHJvZFN0a0FyW2FdWzNdOwkJCQkNCgkJCWlmIChTVk1YSV9zYXZlUHJvZFNlcmlhbChzZWxQcm9kSWQsc2VsRnJvbVBTSUQsc2VsVG9QU0lELHNlbFNOKSA9PSBmYWxzZSkNCgkJCXsNCgkJCQlyZXN1bHRBclthXVswXSA9IGZhbHNlOyAvL1N0YXR1cyBUcnVlL2ZhbHNlDQoJCQkJcmVzdWx0QXJbYV1bM10gPSBzU2F2X3Byb2Nlc3NMb2c7IC8vRXJyb3IgTXNnDQoJCQkJc1Nhdl9wcm9jZXNzTG9nID0gIiI7DQoJCQl9DQoJCX0NCgkJZWxzZSANCgkJeyANCgkJCXJlc3VsdEFyW2FdWzBdID0gZmFsc2U7IC8vU3RhdHVzIFRydWUvZmFsc2UNCgkJCXJlc3VsdEFyW2FdWzNdID0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDUiKTsgLy9FcnJvciBNc2cNCgkJCXNTYXZfcHJvY2Vzc0xvZyA9ICIiOw0KCQl9DQoJfQ0KCXJldHVybiByZXN1bHRBcjsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfc2F2ZVByb2RTZXJpYWwoc2VsUHJvZElkLHNlbEZyb21QU0lELHNlbFRvUFNJRCxzZWxTTikgDQp7CQ0KCXZhciByZXN1bHQ7DQoJdmFyIHNvcWwgPSAiU2VsZWN0IElkLCBOYW1lICIgOw0KCQlzb3FsID0gc29xbCArICIgRnJvbSBTVk1YQ19fUHJvZHVjdF9TZXJpYWxfX2MgICI7DQoJCXNvcWwgPSBzb3FsICsgIiBXSEVSRSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyAgPSAnIiArIHNlbEZyb21QU0lEICsgIiciOw0KCQlzb3FsID0gc29xbCArICIgQW5kIE5hbWUgPSAnIiArIHNlbFNOICsgIiciOw0KCXRyeQ0KCXsNCgkJdmFyIHFyUFMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQoJfSANCgljYXRjaChlKSANCgl7CQkJDQoJCVNWTVhJX3NTYXZfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQlyZXN1bHQgPSBmYWxzZTsNCgl9DQoNCgkvLyBDcmVhdGUgb3IgVXBkYXRlIFByb2Qtc2VyaWFsIHJlY29yZA0KCXZhciBwcyA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1Byb2R1Y3RfU2VyaWFsX19jIik7DQoJaWYgKHFyUFMgJiYgcXJQUy5zaXplID4gMCkgLy8gUHJvZC1TZXJpYWwgUmVjb3JkIEFscmVhZHkgRXhpc3QgVVBEQVRFIElUDQoJeyANCgkJdmFyIHJlY3NQUyA9IHFyUFMuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJICAgIHBzLklkID0gcmVjc1BTWzBdLklkOyAvLyBleGlzdGluZyBSZWNvcmRzIHByb2Qtc2VyaWFsIElEDQoJICAgIHBzLlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICAgPSBzZWxUb1BTSUQ7DQoJICAgIHRyeSB7DQoJCXZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3BzXSk7IA0KCQkgICAgcmVzdWx0ID0gdHJ1ZTsNCgkJfQ0KCSAgICBjYXRjaChlKSB7ICAgICAgICANCgkJCVNWTVhJX3NTYXZfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMSIpK2UpOw0KCQlyZXN1bHQgPSBmYWxzZTsNCgkgICAgfQ0KCX0gDQoJZWxzZSAvLyBQUyBSZWNvcmQgTm90IEV4aXN0IHNvIENyZWF0ZSBJdA0KCXsgDQoJICAgIHBzLk5hbWUgID0gc2VsU047DQoJICAgIHBzLlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICAgPSBzZWxUb1BTSUQ7DQoJCXBzLlNWTVhDX19Qcm9kdWN0X19jICAgPSBzZWxQcm9kSWQ7DQoJICAgIHBzLlNWTVhDX19BY3RpdmVfX2MgPSAiVHJ1ZSI7DQoJICAgIHRyeSB7DQoJCXZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3BzXSk7IA0KCQlpZiAocmV0WzBdLmdldEJvb2xlYW4oInN1Y2Nlc3MiKSkgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlOyAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICBlbHNlIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmV0WzBdLmVycm9ycy5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7Ow0KICAgICAgICAgICAgICAgIH0NCgkJICAgIA0KCQl9DQoJICAgIGNhdGNoKGUpIHsgICAgICAgIAkJDQoJCQlTVk1YSV9zU2F2X1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDEiKStlKTsNCgkJcmVzdWx0ID0gZmFsc2U7DQoJICAgIH0NCgl9IA0KCXJldHVybiByZXN1bHQ7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX3NTYXZfUHV0UHJvY2Vzc0xvZyhNc2cpIA0KeyANCglpZiAoc1Nhdl9wcm9jZXNzTG9nKSB7IHNTYXZfcHJvY2Vzc0xvZyArPSAiXG4iOyB9IA0KCXNTYXZfcHJvY2Vzc0xvZyArPSBNc2c7DQp9DQoNCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFN0b2NrIFNhdmU9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQp2YXIgc2tTYXZfcHJvY2Vzc0xvZyA9ICIiOw0KdmFyIHNrU2F2X3ZQcm9kOyAvL1N0b3JlcyBQcm9kdWN0IE5hbWUvRGV0YWlscyAoVXNlZCBpbiBFbWFpbCBCb2R5KQ0KdmFyIHNrU2F2X3ZMb2NhdGlvbjsgLy9TdG9yZXMgTG9jYXRpb24gTmFtZS9EZXRhaWxzIChVc2VkIGluIEVtYWlsIGJvZHkpDQp2YXIgc2tTYXZfdlVzZXI7IC8vIFN0b3JlcyBVc2VyIE5hbWUvZGVhaWxzIDlVc2VkIGluIEVtYWlsIGJvZHkpDQp2YXIgc2tTYXZfdlByb2R1Y3RJZDsNCnZhciBza1Nhdl92U2l0ZUlEOw0KdmFyIHNrU2F2X3ZTdGF0dXM7DQp2YXIgc2tTYXZfdlRyYW5zYWN0aW9uUXR5Ow0KdmFyIHNrU2F2X3ZUcmFuc2FjdGlvblR5cGU7IC8vKFJNQSwgU2hpcG1lbnQsIFNWTyBSZWNlaXB0LCBTVk8gVXNhZ2UsIFBhcnRzIFJlY2VpcHQsIFN0b2NrIFRyYW5zZmVyLCBTdG9jayBBZGp1c3RtZW50KQ0KdmFyIHNrU2F2X3ZUcmFuc2FjdGlvbk51bWJlcjsgDQp2YXIgc2tTYXZfdkNoYW5nZVR5cGU7DQp2YXIgc2tTYXZfdkhlYWRlclJlZklkOw0KdmFyIHNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQ7DQp2YXIgc2tTYXZfdlVzZXJJZDsNCnZhciBza1Nhdl92Y3VycmRhdGU7IA0KdmFyIHNrU2F2X3Zwc0lEOyAvL1Byb2R1Y3QgU3RvY2sgSWQNCnZhciBza1Nhdl92cHNRdHk7IC8vRXhpc3RpbmcgUXR5L0JlZm9yZSBRdHkNCnZhciBza1Nhdl92cHNVcGRRdHk7IC8vIFVwZGF0ZWQgUXR5IC9hZnRlciBxdHkgKENvdWxkIGJlIG5lZ2F0aXZlLCBmb3Igc2VuZGluZyBpbiBlbWFpbCBub3RpZmljYXRpb24gZXRjKQ0KdmFyIHNrU2F2X3ZlbWFpbFRvVXNlcklkOyAvL0lkIG9mIFVzZXIgd2hvIHdpbGwgZ2V0IE5vdGlmaWVkLi5vbiBOZWdhdGl2ZSBTdG9jaw0KdmFyIHNrU2F2X3ZQcmljZTsgLy8gVG8gU3RvcmUgdGhlIFByaWNlIG9mIEdpdmVuIHByb2R1Y3QNCnZhciBza1Nhdl92SW52QWNjdCA9ICIiOyAvLyBUbyBzdG9yZSBJbnZlbnRvcnkgQWNjb3VudCB2YWx1ZSBmcm9tIFNpdGUgLSBmb3IgcG9zdGluZyBpbiBTdGsgSGlzdA0KdmFyIHNrU2F2X3Jlc0FycmF5ID0gbmV3IEFycmF5KDUpOyANCnZhciBza1Nhdl92SXNvQ3VyckNvZGU7IC8vIHRvIHN0b3JlIElzb0NvZGUsIGV4dHJhY3RpbmcgZnJvbSBDdXJyZW5jeVR5cGUNCnZhciBza1Nhdl92Q3VycklkOyAvLyBUbyBTdG9yZSBDdXJySWQgZnJvb20gQ3VycmVuY3lUeXBlDQp2YXIgc2tTYXZfdlByaWNlQmtJZDsgLy8gdG8gc3RvcmUgUHJpY2VCb29rMiBJZCwgTWF0Y2hpbmcgd2l0aCBEZWZhdWx0IFNldHRpbmdzIGdpdmUgaW4gU2VydmljZU1heCBTZXR0aW5ncw0KdmFyIHNrU2F2X3ZEZWZQcmljZUJrOyAvLyB0byBzdG9yZSBEZWZhdWx0IFByaWNlQm9vayBhcyBzcGVjaWZpZWQgaW4gU2VydmVNYXggU2V0dGluZ3MNCgkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX0RvU3RvY2tVcGRhdGUoY1Byb2R1Y3RJZCwgY1NpdGVJRCwgY1N0YXR1cywgY1RyYW5zYWN0aW9uUXR5LCBjVHJhbnNhY3Rpb25UeXBlLCBjVHJhbnNhY3Rpb25OdW1iZXIsIGNDaGFuZ2VUeXBlLCBjSGVhZGVyUmVmSWQsIGNMaW5lUmVmZXJlbmNlSWQsIGNVc2VySWQpDQp7DQoJdmFyIHJlczsNCglpZiAoU1ZNWElfc2tTYXZHZXRTZXJ2aWNlTWF4U2V0dGluZ3MoKSkJCS8vQnkgR00gMjNKdW4wOCBtZXRob2Qgd2Fzbid0IGhhdmluZyAnKCknIGFkZGVkIG5vdyAgIA0KCSAgICB7DQoJICAgIGlmIChTVk1YSV9za1NhdklzVmFsaWRQcm9kdWN0KGNQcm9kdWN0SWQpKQ0KCQl7DQoJCWlmIChTVk1YSV9za1NhdklzVmFsaWRTaXRlKGNTaXRlSUQpKQ0KCQkgICAgew0KCQkgICAgcmVzID0gU1ZNWElfUHJvY2Vzc1N0b2NrVXBkYXRlKGNQcm9kdWN0SWQsIGNTaXRlSUQsIGNTdGF0dXMsIGNUcmFuc2FjdGlvblF0eSwgY1RyYW5zYWN0aW9uVHlwZSwgY1RyYW5zYWN0aW9uTnVtYmVyLCBjQ2hhbmdlVHlwZSwgY0hlYWRlclJlZklkLCBjTGluZVJlZmVyZW5jZUlkLCBjVXNlcklkKSA7DQoJCSAgICB9DQoJCWVsc2UgDQoJCSAgICByZXMgPSBmYWxzZTsNCgkJfQ0KCSAgICBlbHNlIA0KCQlyZXMgPSBmYWxzZTsNCgkgICAgfQ0KCWVsc2UgDQoJICAgIHJlcyA9IGZhbHNlOw0KDQoJLy9EcmF3IFJlc3VsdCBhcnJheQ0KCXNrU2F2X3Jlc0FycmF5WzBdID0gcmVzOw0KCXNrU2F2X3Jlc0FycmF5WzFdID0gc2tTYXZfdnBzSUQ7DQoJc2tTYXZfcmVzQXJyYXlbMl0gPSBwYXJzZUZsb2F0KHNrU2F2X3Zwc1F0eSk7IC8vQmVmb3JlIFF0eQ0KCWlmIChwYXJzZUZsb2F0KHNrU2F2X3Zwc1VwZFF0eSkgPiAwKSB7c2tTYXZfcmVzQXJyYXlbM10gPSBwYXJzZUZsb2F0KHNrU2F2X3Zwc1VwZFF0eSk7fSAvL2FmdGVyIFF0eQ0KCWVsc2Uge3NrU2F2X3Jlc0FycmF5WzNdID0gMDt9DQoJc2tTYXZfcmVzQXJyYXlbNF0gPSBza1Nhdl9wcm9jZXNzTG9nOw0KDQoJcmV0dXJuIHNrU2F2X3Jlc0FycmF5Ow0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfUHJvY2Vzc1N0b2NrVXBkYXRlKGNQcm9kdWN0SWQsIGNTaXRlSUQsIGNTdGF0dXMsIGNUcmFuc2FjdGlvblF0eSwgY1RyYW5zYWN0aW9uVHlwZSwgY1RyYW5zYWN0aW9uTnVtYmVyLCBjQ2hhbmdlVHlwZSwgY0hlYWRlclJlZklkLCBjTGluZVJlZmVyZW5jZUlkLCBjVXNlcklkKSANCnsJDQoJc2tTYXZfdmN1cnJkYXRlID0gbmV3IERhdGUoKTsgDQoJc2tTYXZfdlByb2R1Y3RJZCA9IGNQcm9kdWN0SWQ7DQoJc2tTYXZfdlNpdGVJRCA9IGNTaXRlSUQ7DQoJc2tTYXZfdlN0YXR1cyA9IGNTdGF0dXM7DQoJc2tTYXZfdlRyYW5zYWN0aW9uUXR5ID0gcGFyc2VGbG9hdChjVHJhbnNhY3Rpb25RdHkpOw0KCXNrU2F2X3ZUcmFuc2FjdGlvblR5cGUgPSBjVHJhbnNhY3Rpb25UeXBlOw0KCXNrU2F2X3ZUcmFuc2FjdGlvbk51bWJlciA9IGNUcmFuc2FjdGlvbk51bWJlcjsgDQoJc2tTYXZfdkNoYW5nZVR5cGUgPWNDaGFuZ2VUeXBlOw0KCXNrU2F2X3ZIZWFkZXJSZWZJZCA9IGNIZWFkZXJSZWZJZDsNCglza1Nhdl92TGluZVJlZmVyZW5jZUlkID0gY0xpbmVSZWZlcmVuY2VJZDsNCglza1Nhdl92VXNlcklkID1jVXNlcklkOw0KCXZhciBzb3FsID0gIlNlbGVjdCBJZCxTVk1YQ19fUXVhbnRpdHkyX19jLCAgU1ZNWENfX1N0YXR1c19fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Mb2NhdGlvbl9fYyAiIDsNCgkJc29xbCA9IHNvcWwgKyAiIEZyb20gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIjsNCgkJc29xbCA9IHNvcWwgKyAiIFdIRVJFIFNWTVhDX19TdGF0dXNfX2MgPSAnIiArIHNrU2F2X3ZTdGF0dXMgKyAiJyI7DQoJCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX1Byb2R1Y3RfX2MgPSAnIiArIHNrU2F2X3ZQcm9kdWN0SWQgKyAiJyI7DQoJCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX0xvY2F0aW9uX19jID0gJyIgKyBza1Nhdl92U2l0ZUlEICsgIiciOw0KCS8vU1ZNWElfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyUFMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQoJfSANCgljYXRjaChlKSANCgl7CQkJDQoJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgl9DQoJaWYgKHFyUFMgJiYgcXJQUy5zaXplID4gMCkgLy8gUFMgUmVjb3JkIEFscmVhZHkgRXhpc3QNCgl7IA0KCQl2YXIgcmVjc1BTID0gcXJQUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJc2tTYXZfdnBzSUQgPSByZWNzUFNbMF0uSWQ7IA0KCQlza1Nhdl92cHNRdHkgPSBwYXJzZUZsb2F0KHJlY3NQU1swXS5TVk1YQ19fUXVhbnRpdHkyX19jKTsNCgkJc2tTYXZfdnBzVXBkUXR5ID0gU1ZNWElfdXBkUFMoc2tTYXZfdnBzSUQsc2tTYXZfdnBzUXR5LHNrU2F2X3ZUcmFuc2FjdGlvblF0eSxza1Nhdl92Q2hhbmdlVHlwZSk7DQoJfSANCgllbHNlIC8vIFBTIFJlY29yZCBOb3QgRXhpc3Qgc28gQ3JlYXRlIEl0DQoJeyANCgkJdmFyIHBzID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyIpOw0KCQlza1Nhdl92cHNRdHkgPTA7DQoJICAgIHBzLlNWTVhDX19Mb2NhdGlvbl9fYyAgPSBza1Nhdl92U2l0ZUlEOw0KCSAgICBwcy5TVk1YQ19fUHJvZHVjdF9fYyAgPSBza1Nhdl92UHJvZHVjdElkOw0KCSAgICBwcy5TVk1YQ19fU3RhdHVzX19jICA9IHNrU2F2X3ZTdGF0dXM7DQoJICAgIHBzLlNWTVhDX19RdWFudGl0eTJfX2MgID0gc2tTYXZfdnBzUXR5Ow0KCSAgICB0cnkgDQoJCXsNCgkJCQl2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKFtwc10pOyANCgkJCQlpZiAocmV0WzBdLmdldEJvb2xlYW4oInN1Y2Nlc3MiKSkgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiByZXRbMF0uaWQ7ICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZWxzZSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgfQ0KCQkJCXNrU2F2X3Zwc0lEID0gcmV0WzBdLmlkOw0KCQkJCXNrU2F2X3Zwc1VwZFF0eSA9IFNWTVhJX3VwZFBTKHNrU2F2X3Zwc0lELHNrU2F2X3Zwc1F0eSxza1Nhdl92VHJhbnNhY3Rpb25RdHksc2tTYXZfdkNoYW5nZVR5cGUpOw0KCQl9DQoJICAgIGNhdGNoKGUpIHsgICAgICAgIAkJDQoJCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAxIikrZSk7DQoJCXJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0gDQoNCgkvLy8vLy8vLy8vSWYgdGhlIG5ldyBxdWFudGl0eSBpcyBsZXNzIHRoYW4gemVybyBHRU5FUkFURSBhbmQgU0VOVCBOT1RJRklDQVRJT04gRW1haWwgKFRvOiBhcyBzcGVjaWZpZWQgaW4gU2VydmljZW1heCBzZXR0aW5ncykNCglpZiAoc2tTYXZfdnBzVXBkUXR5IDwgMCkgDQoJICAgIHsNCgkgICAgdmFyIGVtYWlsVG87CS8vR2V0IEVtYWlsIGlkIHRvIE5vdGlmeQ0KCSAgICB2YXIgc29xbFNTID0gIlNlbGVjdCBTVk1YQ19fTm90aWZ5X29uX05lZ2F0aXZlX1N0b2NrX19jLFNWTVhDX19Ob3RpZnlfb25fTmVnYXRpdmVfU3RvY2tfX3IuRW1haWwgICIgOw0KCQkgICAgc29xbFNTID0gc29xbFNTICsgIiBGcm9tIFNWTVhDX19TZXJ2aWNlTWF4X1NldHRpbmdzX19jICAiOw0KCSAgICAvL1NWTVhJX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbCk7IAkNCgkgICAgdHJ5DQoJCXsNCgkJCWVtYWlsVG8gPSAiIjsNCgkJCXZhciBxclNTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFNTKTsgDQoJCQlpZiAocXJTUy5zaXplID4gMCkgLy8gTm90aWZpY2F0aW9uIEVtYWlsIEZvdW5kDQoJCQkgICAgeyANCgkJCSAgICB2YXIgcmVjc1NTID0gcXJTUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCSAgICBpZiAocmVjc1NTWzBdLlNWTVhDX19Ob3RpZnlfb25fTmVnYXRpdmVfU3RvY2tfX2MpDQoJCQkJew0KCQkJCWVtYWlsVG8gPSByZWNzU1NbMF0uU1ZNWENfX05vdGlmeV9vbl9OZWdhdGl2ZV9TdG9ja19fci5FbWFpbDsgDQoJCQkJc2tTYXZfdmVtYWlsVG9Vc2VySWQgPSByZWNzU1NbMF0uU1ZNWENfX05vdGlmeV9vbl9OZWdhdGl2ZV9TdG9ja19fYzsNCgkJCQl9DQoJCQkgICAgfSANCg0KCQkJaWYgKGVtYWlsVG8gIT0gIiIpIC8vIENvZGUgdG8gc2VuZCBFbWFpbCB0byBzc05vdGlmeUVtYWlsDQoJCQkgICAgewkNCgkJCQl2YXIgcmVxdWVzdCA9IG5ldyBzZm9yY2UuU2luZ2xlRW1haWxNZXNzYWdlKCk7IA0KCQkJCXZhciB1c2VyRW1haWwgPSBzZm9yY2UuY29ubmVjdGlvbi5nZXRVc2VySW5mbygpLnVzZXJFbWFpbDsNCgkJCQlyZXF1ZXN0LnJlcGx5VG8gPSB1c2VyRW1haWw7DQoJCQkJcmVxdWVzdC5zdWJqZWN0ID0gIlNlcnZpY2VNYXggTmVnYXRpdmUgc3RvY2sgYWxlcnQhIjsNCgkJCQlyZXF1ZXN0LnRvQWRkcmVzc2VzID0gZW1haWxUbzsgDQoJCQkJdmFyIGVtYWlsTXNnOw0KCQkJCXZhciB2VDsNCgkJCQllbWFpbE1zZyA9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDEyIik7DQoJCQkJLy8iVGhlIGZvbGxvd2luZyB0cmFuc2FjdGlvbiBoYXMgcmVzdWx0ZWQgaW4gYSBuZWdhdGl2ZSBzdG9jayBxdWFudGl0eS4gUGxlYXNlIHZlcmlmeSB0aGF0IHlvdXIgb3JnYW5pemF0aW9uIGZvbGxvd3MgdGhlIG5lY2Vzc2FyeSBwcm9jZXNzZXMgdG8gbWFpbnRhaW4gaW50ZWdyaXR5IG9mIHN0b2NrIGluZm9ybWF0aW9uIGluIFNlcnZpY2VNYXguIElmIHlvdXIgb3JnYW5pemF0aW9uIGlzIGZ1bGx5IGNvbXBsaWFudCB3aXRoIHRoZSBwcm9jZXNzIHJlcXVpcmVtZW50cywgcmVwb3J0IHRoaXMgaXNzdWUgdG8gU2VydmljZU1heCBzdXBwb3J0IGltbWVkaWF0ZWx5LiI7CQkJDQoJCQkJZW1haWxNc2cgPSBlbWFpbE1zZyArICJcbiIgKyAiXG4iOw0KDQoJCQkJaWYgKFNWTVhJX2dldFByb2R1Y3REZXRhaWxzKHNrU2F2X3ZQcm9kdWN0SWQpID09IHRydWUgJiYNCgkJCQkJCVNWTVhJX2dldFNpdGVEZXRhaWxzKHNrU2F2X3ZTaXRlSUQpID09IHRydWUgJiYNCgkJCQkJCSAgICBTVk1YSV9nZXRVc2VyRGV0YWlscyhza1Nhdl92VXNlcklkKSA9PSB0cnVlKQ0KCQkJCSAgICB7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxNSIpICsgIiAiICsgc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSArICJcbiIgIDsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDE2IikgKyAiICIgKyBza1Nhdl92VHJhbnNhY3Rpb25OdW1iZXIgKyAiXG4iICA7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxNyIpICsgIiAiICsgc2tTYXZfdlByb2QgKyAiXG4iIDsgIC8vQWRkIENvZGUgdG8gR2V0IFByb2QgTmFtZS9EZXRhaWxzDQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxOCIpICsgIiAiICsgc2tTYXZfdkxvY2F0aW9uICsgIlxuIiA7IC8vIEFkZCBDb2RlIHRvIGdldCBTaXRlIE5hbWUvRGV0YWlscw0KCQkJCSAgICBlbWFpbE1zZyA9IGVtYWlsTXNnICsgU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTkiKSArICIgIiArIHNrU2F2X3ZTdGF0dXMgKyAiXG4iICA7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAyMCIpICsgIiAiICsgc2tTYXZfdnBzUXR5ICsgIlxuIiAgOw0KCQkJCSAgICBlbWFpbE1zZyA9IGVtYWlsTXNnICsgU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMjEiKSArICIgIiArIHNrU2F2X3ZUcmFuc2FjdGlvblF0eSArICJcbiIgIDsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDIyIikgKyAiICIgKyBza1Nhdl92cHNVcGRRdHkgKyAiXG4iICA7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAyMyIpICsgIiAiICsgc2tTYXZfdlVzZXIgKyAiXG4iOw0KCQkJCSAgICBlbWFpbE1zZyA9IGVtYWlsTXNnICsgU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMjQiKSArICIgIiArIHNrU2F2X3ZjdXJyZGF0ZSArICJcbiI7DQoJCQkJICAgIC8vU1ZNWElfUHV0UHJvY2Vzc0xvZygiZW1haWwgQm9keTogIiArIGVtYWlsTXNnKTsNCgkJCQkgICAgcmVxdWVzdC5wbGFpblRleHRCb2R5ID0gZW1haWxNc2c7DQoNCgkJCQkgICAgdmFyIHNlbmRNYWlsUmVzID0gc2ZvcmNlLmNvbm5lY3Rpb24uc2VuZEVtYWlsKFtyZXF1ZXN0XSk7IA0KCQkJCSAgICB2YXIgZVJlc3VsdHMgPSBlbWFpbFJlc3VsdHMoc2VuZE1haWxSZXMpOw0KCQkJCSAgICB9DQoJCQkJZWxzZQ0KCQkJCSAgICB7CQkJCQkJDQoJCQkJICAgIFNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTQiKSk7CQkJCQkJCQ0KCQkJCSAgICByZXR1cm4gdHJ1ZTsgLy9CeSBHTSAyM0p1bjA4LCBPbiBFbWFpbCBlcnJvciBjb3VudGludWUgd2l0aG91dCBlcnJvci4JQ2hhbmdlZCBGYWxzZSB0byBUUlVFDQoJCQkJICAgIH0NCgkJCSAgICB9DQoJCQllbHNlIHsJCQkJDQoJCQkgICAgU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxNCIpKTsNCgkJCSAgICByZXR1cm4gdHJ1ZTsgLy9CeSBHTSAyM0p1bjA4LCBPbiBFbWFpbCBlcnJvciBjb3VudGludWUgd2l0aG91dCBlcnJvci4gQ2hhbmdlZCBGYWxzZSB0byBUUlVFDQoJCQkgICAgfQ0KCQl9DQoJICAgIGNhdGNoKGUpIA0KCQl7CQkJCQ0KCQkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJICAgIH0vLyBTZW5kIEVtYWlsIENMT1NFCQ0KDQoJaWYgKFNWTVhJX2dldFByaWNlRGV0YWlscyhza1Nhdl92UHJvZHVjdElkLCBza1Nhdl92U2l0ZUlEKSA9PSB0cnVlKQ0KCSAgICB7DQoJICAgIGlmKFNWTVhJX3VwZGF0ZVByb2R1Y3RTdG9ja0Nvc3QoKSA9PSB0cnVlKQ0KCQl7DQoJCXZhciBzaGlzdFJlcyA9IAlTVk1YSV9jcmVhdGVTdG9ja0hpc3QoKTsgDQoJCXJldHVybiBzaGlzdFJlczsNCgkJfQ0KCSAgICB9DQoJZWxzZSB7CXJldHVybiBmYWxzZTsJfQ0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfZ2V0UHJpY2VEZXRhaWxzKHByb2RJZCwgc2l0ZUlkKQ0Kew0KCXZhciBzb3FsQ29zdEF0ID0gIlNlbGVjdCBTVk1YQ19fQ29zdGVkX2F0X3ZhbHVlX19jLFNWTVhDX19JbnZlbnRvcnlfQWNjb3VudF9fYyAgZnJvbSBTVk1YQ19fU2l0ZV9fYyIgOw0KCXNvcWxDb3N0QXQgKz0gIiBXaGVyZSBJZCA9ICciICsgc2l0ZUlkICsgIiciOw0KCXRyeQ0KCXsNCgkJdmFyIHFyQ29zdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxDb3N0QXQpOyANCgkJaWYgKHFyQ29zdC5zaXplID4gMCkgDQoJCXsgDQoJCQl2YXIgcmVjc0Nvc3QgPSBxckNvc3QuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQlza1Nhdl92SW52QWNjdCA9IHJlY3NDb3N0WzBdLlNWTVhDX19JbnZlbnRvcnlfQWNjb3VudF9fYyA7IC8vbmV3IEZpZWxkIGFkZGVkIHRvIFNJdGUsIHNob3VsZCBjb3B5IHZhbHVlIHRvIFN0b2NrLUhpc3QNCgkJCWlmIChyZWNzQ29zdFswXS5TVk1YQ19fQ29zdGVkX2F0X3ZhbHVlX19jID09IHRydWUgfHwgcmVjc0Nvc3RbMF0uU1ZNWENfX0Nvc3RlZF9hdF92YWx1ZV9fYyA9PSAidHJ1ZSIpDQoJCQl7DQoJCQkJdmFyIHNvcWxQcmljZSA9ICJTZWxlY3QgU1ZNWENfX1Byb2R1Y3RfQ29zdF9fYyBmcm9tIFByb2R1Y3QyIiA7DQoJCQkJc29xbFByaWNlICs9ICIgV2hlcmUgSWQgPSAnIiArIHByb2RJZCArICInIjsNCgkJCQl0cnkNCgkJCQl7DQoJCQkJCXZhciBxclByaWNlID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFByaWNlKTsgDQoJCQkJCWlmIChxclByaWNlLnNpemUgPiAwKSANCgkJCQkJeyANCgkJCQkJCXZhciByZWNzUHJpY2UgPSBxclByaWNlLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCQkJc2tTYXZfdlByaWNlID0gcmVjc1ByaWNlWzBdLlNWTVhDX19Qcm9kdWN0X0Nvc3RfX2M7DQoJCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQkJfSANCgkJCQkJZWxzZSB7c2tTYXZfdlByaWNlID0gMDtyZXR1cm4gdHJ1ZTt9DQoJCQkJCX0gDQoJCQkJY2F0Y2goZSkgDQoJCQkJew0KCQkJCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCQkJCXJldHVybiBmYWxzZTsNCgkJCQl9DQoJCQl9DQoJCQllbHNlIHtza1Nhdl92UHJpY2UgPSAwO3JldHVybiB0cnVlO30NCgkJfSANCgkJZWxzZSB7c2tTYXZfdlByaWNlID0gMDtyZXR1cm4gdHJ1ZTt9DQoJfSANCgljYXRjaChlKSANCgl7CQkJDQoJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJcmV0dXJuIGZhbHNlOw0KCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9za1NhdklzVmFsaWRTaXRlKGNTaXRlSUQpDQp7DQoJdmFyIHNvcWxWUyA9ICJTZWxlY3QgU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jICAgIiA7DQoJc29xbFZTICs9ICIgRnJvbSBTVk1YQ19fU2l0ZV9fYyAgICI7DQoJc29xbFZTICs9ICIgd2hlcmUgSWQgPSAnIiArIGNTaXRlSUQgICsgIiciOw0KCS8vc29xbFZTICs9ICIgQW5kIFNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYyA9IHRydWUgIjsgICAvL05vbi1zdG9ja2FibGUgc2l0ZSAgaXMgTk9UIGFuIGVycm9yIGluIFJlbCAyLjAJU3llZCAwNC8zMC8yMDA4DQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxTUyk7IAkNCgl0cnkNCgl7DQoJCXZhciBxclZTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFZTKTsgDQoJCWlmIChxclZTLnNpemUgPiAwKSAvLyBzaXRlIGlzIFZhbGlkIC1TdG9ja2FibGUgDQoJCXsgDQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfSANCgkJZWxzZSB7cmV0dXJuIGZhbHNlO30NCgkJfQ0KCWNhdGNoKGUpIA0KCXsJCQkgDQoJCSBTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCSByZXR1cm4gZmFsc2U7DQoJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NrU2F2SXNWYWxpZFByb2R1Y3QoY1Byb2R1Y3RJZCkNCnsNCgl2YXIgc29xbFZQID0gIlNlbGVjdCBTVk1YQ19fU3RvY2thYmxlX19jICAiIDsNCglzb3FsVlAgKz0gIiBGcm9tIFByb2R1Y3QyICAiOw0KCXNvcWxWUCArPSAiIHdoZXJlIElkID0gJyIgKyBjUHJvZHVjdElkICArICInIjsNCiAvLwlzb3FsVlAgKz0gIiBBbmQgU1ZNWENfX1N0b2NrYWJsZV9fYyA9IHRydWUgIjsJLy9Ob24tc3RvY2thYmxlICBwcm9kdWN0IGlzIE5PVCBhbiBlcnJvciBpbiBSZWwgMi4wICAgU3llZCAwNC8zMC8yMDA4DQoJLy9hbGVydChzb3FsVlApOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU1MpOyAJDQoJdHJ5DQoJew0KCQl2YXIgcXJWUCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxWUCk7IA0KCQlpZiAocXJWUC5zaXplID4gMCkgLy8gUHJvZHVjdCBpcyBWYWxpZCAtVHJhY2tpYWJsZSANCgkJeyANCgkJCXJldHVybiB0cnVlOw0KCQl9IA0KCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCQl9DQoJY2F0Y2goZSkgDQoJewkJCSANCgkJIFNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJIHJldHVybiBmYWxzZTsNCgl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc2tTYXZHZXRTZXJ2aWNlTWF4U2V0dGluZ3MoKQ0Kew0KCXZhciBzb3FsU1MgPSAiU2VsZWN0IFNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYywgU1ZNWENfX0VuYWJsZV9TZXJpYWxfVHJhY2tpbmdfX2MsU1ZNWENfX0NoZWNrX1NlcmlhbF9VbmlxdWVuZXNzX19jICAgIiA7DQoJc29xbFNTICs9ICIgRnJvbSBTVk1YQ19fU2VydmljZU1heF9TZXR0aW5nc19fYyAgIjsNCgkvLyBzb3FsU1MgKz0gIiB3aGVyZSBTVk1YQ19fRW5hYmxlX0ludmVudG9yeV9Nb2R1bGVfX2MgPSB0cnVlIjsgSFMgQ29tbWVudGVkIG91dCA2LzI1LzIwMDkgbm90IG5lZWRlZC4NCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFNTKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyU1MgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsU1MpOyANCgkJaWYgKHFyU1Muc2l6ZSA+IDApIC8vIFNldHRpbmdzIEZvdW5kDQoJCXsgDQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfSANCgkJZWxzZSB7cmV0dXJuIGZhbHNlO30NCgkJfQ0KCWNhdGNoKGUpIA0KCXsNCgkJIHJldHVybiBmYWxzZTsNCgkJIFNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKSsgZSk7DQoJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3VwZGF0ZVByb2R1Y3RTdG9ja0Nvc3QoKQ0Kew0KCXZhciBwcm9kU3RvY2sgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIik7DQoJcHJvZFN0b2NrLklkICA9IHNrU2F2X3Zwc0lEIDsNCglwcm9kU3RvY2suU1ZNWENfX1Byb2R1Y3RfQ29zdF9fYyAgPSBza1Nhdl92UHJpY2U7DQoJdHJ5IA0KCXsNCgl2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtwcm9kU3RvY2tdKTsgICAgICAgICAJDQoJCXJldHVybiB0cnVlOw0KCX0NCgljYXRjaChlKSANCgl7ICAgICAgICAJDQoJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDEiKStlKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX2NyZWF0ZVN0b2NrSGlzdCgpDQp7DQoJdmFyIHNoaXN0ID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU3RvY2tfSGlzdG9yeV9fYyIpOw0KCXNoaXN0LlNWTVhDX19Qcm9kdWN0X19jICA9IHNrU2F2X3ZQcm9kdWN0SWQgOw0KCXNoaXN0LlNWTVhDX19Mb2NhdGlvbl9fYyA9IHNrU2F2X3ZTaXRlSUQgOw0KCXNoaXN0LlNWTVhDX19TdGF0dXNfX2MgID0gc2tTYXZfdlN0YXR1cyA7DQoJc2hpc3QuU1ZNWENfX1RyYW5zYWN0aW9uX1R5cGVfX2MgID0gc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA7DQoJc2hpc3QuU1ZNWENfX1F1YW50aXR5X2JlZm9yZV9jaGFuZ2UyX19jICA9IHBhcnNlRmxvYXQoc2tTYXZfdnBzUXR5KSA7DQoJc2hpc3QuU1ZNWENfX1RyYW5zYWN0aW9uX1F1YW50aXR5Ml9fYyAgPSBwYXJzZUZsb2F0KHNrU2F2X3ZUcmFuc2FjdGlvblF0eSkgOw0KCXNoaXN0LlNWTVhDX19DaGFuZ2VfVHlwZV9fYyAgPSBza1Nhdl92Q2hhbmdlVHlwZSA7DQoJc2hpc3QuU1ZNWENfX1F1YW50aXR5X2FmdGVyX2NoYW5nZTJfX2MgID0gcGFyc2VGbG9hdChza1Nhdl92cHNVcGRRdHkpIDsNCi8vCXNoaXN0LlNWTVhDX19EYXRlX0NoYW5nZWRfX2MgID0gc2tTYXZfdmN1cnJkYXRlIDsNCiAgICBzaGlzdC5TVk1YQ19fRGF0ZV9DaGFuZ2VkX19jICA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7ICAgLy8gVXBkYXRlZCBvbiBGZWIgNiwyMDA5IGJ5IFN5ZWQNCglzaGlzdC5TVk1YQ19fQ2hhbmdlZF9CeV9fYyAgPSBza1Nhdl92VXNlcklkIDsNCglzaGlzdC5TVk1YQ19fQ29zdF9fYyAgPSBza1Nhdl92UHJpY2UgOw0KCXNoaXN0LlNWTVhDX19DdXJyZW5jeV9fYyAgPSBza1Nhdl92SXNvQ3VyckNvZGUgOw0KCXNoaXN0LlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICA9IHNrU2F2X3Zwc0lEIDsNCglzaGlzdC5TVk1YQ19fSW52ZW50b3J5X0FjY291bnRfX2MgID0gc2tTYXZfdkludkFjY3Q7DQoNCglpZiAoc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9PSAiUk1BIiB8fCBza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJSTUEgUmVjZWlwdCIpDQoJew0KCQlzaGlzdC5TVk1YQ19fUk1BX19jICA9IHNrU2F2X3ZIZWFkZXJSZWZJZCA7DQoJCXNoaXN0LlNWTVhDX19STUFfTGluZV9fYyAgPSBza1Nhdl92TGluZVJlZmVyZW5jZUlkIDsNCgl9DQoNCglpZiAoc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9PSAiU2hpcG1lbnQiKQ0KCXsNCgkJc2hpc3QuU1ZNWENfX1NoaXBtZW50X19jICA9IHNrU2F2X3ZIZWFkZXJSZWZJZCA7DQoJCXNoaXN0LlNWTVhDX19TaGlwbWVudF9MaW5lX19jICA9IHNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQgOw0KCX0NCg0KCWlmIChza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJTVk8gUmVjZWlwdCIgfHwgc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9PSAgIlNWTyBVc2FnZSIpDQoJew0KCQlzaGlzdC5TVk1YQ19fU2VydmljZV9PcmRlcl9fYyAgPSBza1Nhdl92SGVhZGVyUmVmSWQgOw0KCQlzaGlzdC5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jICA9IHNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQgOw0KCX0NCg0KCWlmIChza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJQYXJ0cyBSZWNlaXB0IikNCgl7DQoJCXNoaXN0LlNWTVhDX19QYXJ0c19SZXF1ZXN0X19jICA9IHNrU2F2X3ZIZWFkZXJSZWZJZCA7DQoJCXNoaXN0LlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgID0gc2tTYXZfdkxpbmVSZWZlcmVuY2VJZCA7DQoJfQ0KDQoJaWYgKHNrU2F2X3ZUcmFuc2FjdGlvblR5cGUgPT0gIlN0b2NrIFRyYW5zZmVyIikNCgl7DQoJCXNoaXN0LlNWTVhDX19TdG9ja19UcmFuc2Zlcl9fYyAgPSBza1Nhdl92SGVhZGVyUmVmSWQgOw0KCQlzaGlzdC5TVk1YQ19fU3RvY2tfVHJhbnNmZXJfTGluZV9fYyAgPSBza1Nhdl92TGluZVJlZmVyZW5jZUlkIDsNCgl9DQoNCglpZiAoc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9PSAiU3RvY2sgQWRqdXN0bWVudCIpDQoJew0KCQlzaGlzdC5TVk1YQ19fU3RvY2tfQWRqdXN0bWVudF9fYyAgID0gc2tTYXZfdkhlYWRlclJlZklkIDsJCQ0KCX0NCg0KCWlmIChwYXJzZUZsb2F0KHNrU2F2X3Zwc1VwZFF0eSkgPCAwICkge3NoaXN0LlNWTVhDX19OZWdhdGl2ZV9TdG9ja19fYyAgID0gdHJ1ZTt9DQoJZWxzZSB7c2hpc3QuU1ZNWENfX05lZ2F0aXZlX1N0b2NrX19jICAgPSBmYWxzZTt9DQoJc2hpc3QuU1ZNWENfX05vdGlmaWVkX1VzZXJfX2MgICAgPSBza1Nhdl92ZW1haWxUb1VzZXJJZCA7DQoNCgl0cnkgDQoJew0KCXZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3NoaXN0XSk7DQoJaWYgKHJldFswXS5nZXRCb29sZWFuKCJzdWNjZXNzIikpIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7ICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZWxzZSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoJLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJUcmFuc2FjdGlvbiBBZGRlZCBpbiBTdG9jayBIaXN0b3J5IE9iamVjdDogIik7DQoJcmV0dXJuIHRydWU7DQoJfQ0KCWNhdGNoKGUpIA0KCXsgICAgICAgIAkNCgkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMSIpK2UpOw0KCXJldHVybiBmYWxzZTsNCgl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfdXBkUFMocHNJZCxwc1F0eSwgcHNUcmFuc1F0eSwgcHNDaGdUeXApDQp7DQoJdmFyIHJldFVwZFF0eSA9IDA7IC8vVGhpcyBjb3VsZCBiZSBOZWdhdGl2ZSBhbHNvLCAnU2VuZCBOZWdhdGl2ZScNCglpZiAocHNDaGdUeXAgPT0gIkluY3JlYXNlIil7cmV0VXBkUXR5ID0gcGFyc2VGbG9hdChwc1F0eSkgKyBwYXJzZUZsb2F0KHBzVHJhbnNRdHkpOyB9DQoJaWYgKHBzQ2hnVHlwID09ICJEZWNyZWFzZSIpe3JldFVwZFF0eSA9IHBhcnNlRmxvYXQocHNRdHkpIC0gcGFyc2VGbG9hdChwc1RyYW5zUXR5KTsgfQ0KCWlmIChwc0NoZ1R5cCA9PSAiU2V0Iil7cmV0VXBkUXR5ID0gcGFyc2VGbG9hdChwc1RyYW5zUXR5KTsgfQ0KCS8vIFVwZGF0ZSBuZXcgUXR5IGluIFBTDQoJdmFyIHBzVXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyIpOw0KCXBzVXBkLmlkICA9IHBzSWQ7DQoJaWYgKHJldFVwZFF0eSA8IDAgKSB7cHNVcGQuU1ZNWENfX1F1YW50aXR5Ml9fYyAgPSAwIDt9DQoJZWxzZSB7cHNVcGQuU1ZNWENfX1F1YW50aXR5Ml9fYyAgPSByZXRVcGRRdHk7fQ0KCXRyeSANCgl7DQoJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbcHNVcGRdKTsgDQoJLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJVcGRhdGVkIFBTIFF0eTogIik7DQoJfQ0KCWNhdGNoKGUpIA0KCXsgICAgICAgIAkNCgkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMSIpK2UpOw0KCX0NCglza1Nhdl92cHNJRCA9IHJldFswXS5pZDsNCgkvL2lmKHBzVHJhbnNRdHkgPT0gMCkge3JldHVybiAwO30NCglyZXR1cm4gcmV0VXBkUXR5Ow0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX2dldFVzZXJEZXRhaWxzKHVzZXJJZCkNCnsNCgl2YXIgc29xbFVzZXIgPSAiU2VsZWN0IE5hbWUgZnJvbSBVc2VyICIgOw0KCXNvcWxVc2VyID0gc29xbFVzZXIgKyAiIFdoZXJlIElkID0gJyIgKyB1c2VySWQgKyAiJyI7DQoJLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxVc2VyKTsgCQ0KCXRyeQ0KCQl7DQoJCQl2YXIgcXJVc2VyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFVzZXIpOyANCgkJCWlmIChxclVzZXIuc2l6ZSA+IDApIA0KCQkJeyANCgkJCQl2YXIgcmVjc1VzZXIgPSBxclVzZXIuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQkJc2tTYXZfdlVzZXIgPSByZWNzVXNlclswXS5OYW1lOyANCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0gDQoJCQllbHNlIHtza1Nhdl92VXNlciA9ICIiO3JldHVybiB0cnVlO30NCgkJfSANCgkJY2F0Y2goZSkgDQoJCXsJCQkJDQoJCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9nZXRQcm9kdWN0RGV0YWlscyhwcm9kSWQpDQp7DQoJdmFyIHNvcWxQcm9kID0gIlNlbGVjdCBOYW1lIGZyb20gUHJvZHVjdDIgIiA7DQoJc29xbFByb2QgPSBzb3FsUHJvZCArICIgV0hFUkUgSWQgPSAnIiArIHByb2RJZCArICInIjsNCgkvL1NWTVhJX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFByb2QpOyAJDQoJdHJ5DQoJCXsNCgkJCXZhciBxclByb2QgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsUHJvZCk7IA0KCQkJaWYgKHFyUHJvZC5zaXplID4gMCkgDQoJCQl7IA0KCQkJCXZhciByZWNzUHJvZCA9IHFyUHJvZC5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCQlza1Nhdl92UHJvZCA9IHJlY3NQcm9kWzBdLk5hbWU7IA0KCQkJCXJldHVybiB0cnVlOw0KCQkJfSANCgkJCWVsc2Uge3NrU2F2X3ZQcm9kID0gIiI7cmV0dXJuIHRydWU7fQ0KCQl9IA0KCQljYXRjaChlKSANCgkJewkJCQkNCgkJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX2dldFNpdGVEZXRhaWxzKHNpdGVJZCkNCnsNCgl2YXIgc29xbFNpdGUgPSAiU2VsZWN0IE5hbWUgZnJvbSBTVk1YQ19fU2l0ZV9fYyAiIDsNCglzb3FsU2l0ZSA9IHNvcWxTaXRlICsgIiBXSEVSRSBJZCA9ICciICsgc2l0ZUlkICsgIiciOw0KCS8vU1ZNWElfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU2l0ZSk7IAkNCgl0cnkNCgkJew0KCQkJdmFyIHFyU2l0ZSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxTaXRlKTsgDQoJCQlpZiAocXJTaXRlLnNpemUgPiAwKSANCgkJCXsgDQoJCQkJdmFyIHJlY3NTaXRlID0gcXJTaXRlLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCXNrU2F2X3ZMb2NhdGlvbiA9IHJlY3NTaXRlWzBdLk5hbWU7IA0KCQkJCXJldHVybiB0cnVlOw0KCQkJfSANCgkJCWVsc2Uge3NrU2F2X3ZMb2NhdGlvbiA9ICIiOyByZXR1cm4gdHJ1ZTt9DQoNCgkJfSANCgkJY2F0Y2goZSkgDQoJCXsJCQkJDQoJCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBlbWFpbFJlc3VsdHMoc2VuZEVtYWlsUmVzdWx0KSANCnsgDQoJaWYgKHNlbmRFbWFpbFJlc3VsdC5sZW5ndGggPiAwKSB7DQoJCWlmIChzZW5kRW1haWxSZXN1bHRbMF0uZ2V0Qm9vbGVhbigic3VjY2VzcyIpKSB7CVNWTVhJX1B1dFByb2Nlc3NMb2coIiIpOyByZXR1cm4gdHJ1ZTt9IC8vTm90aWZpY2F0aW9uIEUtbWFpbCBzZW50DQoJCWVsc2UgewlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDEzIikpOyByZXR1cm4gdHJ1ZTt9IC8vQnkgR00yM0p1bjA4IENoYW5nZWQgRmFsc2UgdG8gVFJVRQ0KCX0gDQoJZWxzZSB7IFNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTMiKSk7CXJldHVybiB0cnVlO30gLy9CeSBHTTIzSnVuMDggQ2hhbmdlZCBGYWxzZSB0byBUUlVFDQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9QdXRQcm9jZXNzTG9nKE1zZykgDQp7IA0KCWlmIChza1Nhdl9wcm9jZXNzTG9nKSB7IHNrU2F2X3Byb2Nlc3NMb2cgKz0gIlxuIjsgfSANCglza1Nhdl9wcm9jZXNzTG9nICs9IE1zZzsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfR2V0RG9jdW1lbnRJZChkb2NOYW1lKQ0Kew0KCXZhciBzb3FsRG9jID0gIlNlbGVjdCBJZCxOYW1lIEZyb20gRG9jdW1lbnQiIDsNCglzb3FsRG9jID0gc29xbERvYyArICIgV2hlcmUgTmFtZSA9ICciICsgZG9jTmFtZSArICInIjsNCgl2YXIgcXJEb2MgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsRG9jKTsgDQoJaWYgKHFyRG9jLnNpemUgPiAwKSANCgl7IA0KCQkJdmFyIHJlY3MgPSBxckRvYy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCXJldHVybiByZWNzWzBdLklkOyANCgl9IA0KCWVsc2UgeyByZXR1cm4gIiI7IH0NCn0NCg0KdmFyIEFwaVNlc3Npb25JZDsNCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFNlcmlhbCBOdW1iZXIgU2VsZWN0aW9uID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCnZhciBzU2VsX1Byb2RRdHlBcjsgLy9BcnJheSBoYXMsIFByb2QsIFF0eSwgRnJvbVNpdGUsIFNyb21TdGF0dXMsIFRvU2l0ZSxUbyBTdGF0dXMNCnZhciBzU2VsX1RyYW5zYWN0aW9uVHlwZTsNCnZhciBzU2VsX1RyYW5zYWN0aW9uTnVtYmVyOyANCnZhciBzU2VsX1VzZXJJZCA7DQp2YXIgc1NlbF9Eb2NJZDsNCnZhciBzU2VsX29wZW5XaW5IZGw7DQp2YXIgc1NlbF9Nc2dMaXN0ID0gbmV3IEFycmF5KCk7DQoNCi8vIENhbGxpbmcgTWV0aG9kIC0gVGhpcyB3aWxsIExhdW5jaCBHZW5lcmljIFV0aWxpdHkgZm9yIFNlcmlhbCBOdW1iZXIgc2VsZWN0aW9uDQpmdW5jdGlvbiBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihjUHJvZFF0eUFyLCBjVHJhbnNhY3Rpb25UeXBlLCBjVHJhbnNhY3Rpb25OdW1iZXIsIGNVc2VySWQsIGNBcGlTZXNzaW9uSWQpDQp7DQoJc1NlbF9Eb2NJZCA9ICBTVk1YSV9HZXREb2N1bWVudElkKCJTVk1YSV9TZXJpYWxfU2VsZWN0aW9uX1V0aWxpdHkiKSA7IA0KCXNTZWxfUHJvZFF0eUFyID0gY1Byb2RRdHlBcjsNCglzU2VsX1RyYW5zYWN0aW9uVHlwZSA9IGNUcmFuc2FjdGlvblR5cGU7DQoJc1NlbF9UcmFuc2FjdGlvbk51bWJlciA9Y1RyYW5zYWN0aW9uTnVtYmVyOyANCglzU2VsX1VzZXJJZCA9Y1VzZXJJZDsNCglBcGlTZXNzaW9uSWQgPSBjQXBpU2Vzc2lvbklkOw0KCVNWTVhJX3NTZWxfSW5pdE1lc3NhZ2VMaXN0KCJTU0VMU0MxIik7DQoJU1ZNWElfc1NlbF9Qcm9jZXNzU2VyaWFsU2VsZWN0aW9uKHNTZWxfUHJvZFF0eUFyLCBzU2VsX1RyYW5zYWN0aW9uVHlwZSwgc1NlbF9UcmFuc2FjdGlvbk51bWJlciwgc1NlbF9Vc2VySWQpIA0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9zU2VsX1NlcmlhbFNlbGVjdGlvblJlc3VsdHMocmVzdWx0QXIsIHRyYW5zVHlwZSkNCnsNCgkvLyBDYWxsYmFjayBGdW5jdGlvbiwgd291bGQgYmUgY2FsbGVkIG9uIFN1Ym1pdC9jYW5jZWwgaW4gc2VyaWFsLVNlbGVjdGlvbiANCgkvL0Jhc2VkIG9uIHRyYW5zYWN0aW9uIHR5cGUsIFJlc3VsdCB3aWxsIGJlIEZvcndhZGVkDQoJLy90cmFuc1R5cGU6IFJNQSwgU2hpcG1lbnQsIFNWTyBSZWNlaXB0LCBTVk8gVXNhZ2UsIFBhcnRzIFJlY2VpcHQsIFN0b2NrIFRyYW5zZmVyLCBTdG9jayBBZGp1c3RtZW50KQ0KCS8vcmVzdWx0QXJbMF06IHRydWUvZmFsc2U7IHJlc3VsdEFyWzFdOlJlY29yZENvdW50OyByZXN1bHRBclsyXTogUHJvZEFycmF5DQoJaWYgKHNTZWxfb3BlbldpbkhkbCkge3NTZWxfb3BlbldpbkhkbC5jbG9zZSgpO30NCglzd2l0Y2godHJhbnNUeXBlKQ0KCQl7DQoJCWNhc2UgIlJNQSI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1BSUmVjZWlwdHMocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiUk1BIFJlY2VpcHQiOg0KCQkgIFNWTVhJX0NhbGxiYWNrX1Byb2Nlc3NSTUFSZWNlaXB0cyhyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJTaGlwbWVudCI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1NoaXBtZW50KHJlc3VsdEFyWzBdLHJlc3VsdEFyWzFdLHJlc3VsdEFyWzJdKTsNCgkJICBicmVhazsgICAgDQoJCWNhc2UgIlNWTyBSZWNlaXB0IjoNCgkJICBTVk1YSV9DYWxsYmFja19Qcm9jZXNzU1ZPUmVjZWlwdHMocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiU1ZPIFVzYWdlIjoNCgkJICBTVk1YSV9DYWxsYmFja19Qb3N0U1ZPVXNhZ2UocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiUGFydHMgUmVjZWlwdCI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1BSUmVjZWlwdHMocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiU3RvY2sgVHJhbnNmZXIiOg0KCQkgIFNWTVhJX0NhbGxiYWNrX1N0b2NrVHJhbnNmZXIocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiU3RvY2sgQWRqdXN0bWVudCI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfU3RvY2tBZGp1c3RtZW50KHJlc3VsdEFyWzBdLHJlc3VsdEFyWzFdLHJlc3VsdEFyWzJdKTsNCgkJICBicmVhazsgICAgDQoJCWRlZmF1bHQ6DQoJCX0NCn0NCi8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vDQp2YXIgc1NlbF9wcm9jZXNzTG9nID0gIiI7DQp2YXIgdlByb2RRdHlBcjsNCnZhciB2VXNlcjsgLy8gU3RvcmVzIFVzZXIgTmFtZS9kZWFpbHMgDQp2YXIgdlByb2Q7IC8vIFN0b3JlcyBwcm9kdWN0IE5hbWUvZGVhaWxzIA0KdmFyIHZUcmFuc2FjdGlvblR5cGU7IC8vKFJNQSwgU2hpcG1lbnQsIFNWTyBSZWNlaXB0LCBTVk8gVXNhZ2UsIFBhcnRzIFJlY2VpcHQsIFN0b2NrIFRyYW5zZmVyLCBTdG9jayBBZGp1c3RtZW50KQ0KdmFyIHZUcmFuc2FjdGlvbk51bWJlcjsgDQp2YXIgdlVzZXJJZDsNCnZhciB2Y3VycmRhdGU7IA0KdmFyIHJlc0RldGFpbEFyID0gbmV3IEFycmF5KCk7IC8vIFRoaXMgd291bGQgYmUgb25lIG9mIHRoZSByZXR1cm4gaXRlbSBpbiByZXN1bHQgYXJyYXkNCnZhciByZXNBcnJheSA9IG5ldyBBcnJheSg0KTsgLy9SZXN1bHQgQXJyYXkgKE91dHB1dCkgLCB0aGlzIHdvdWxkIGJlIG9uZSByZXR1cm4gb2JqZWN0IHRvIGNhbGxpbmcgbWV0aG9kDQp2YXIgdkVuSW52ZW50b3J5OyAvLyB0byBzdG9yZSBJTlZFTlRPUlkgTU9EVUxFIGlzIEVuYWJsZWQgb3IgTk9UDQp2YXIgdkVuU2VyaWFsVHJhY2tpbmc7IC8vIHRvIHN0b3JlIFNlcmlhbCBObyBUcmFja2luZyBpcyBFbmFibGVkIG9yIE5vdA0KdmFyIHZFblNlcmlhbFVuaXF1ZW5lc3M7IC8vIFRvIHN0b3JlOiBUeXBlIG9mIFNlcmlhbCBObyBVbmlxdWVuZXNzIGVuZm9yY2VkIA0KdmFyIHJlc1N0YXR1cyA9IGZhbHNlOw0KdmFyIHZSZWNDb3VudDsNCnZhciB2YWxpZFByb2RBcjsgLy9BcnJheSBvZiBWYWxpZCBTZXJpYWxpemUgUHJkdWN0cyAtRmlsbGVkIGluIHJ1bi10aW1lDQp2YXIgYXRsZWFzdE9uZVZhbGlkUHJvZEZvdW5kOyANCnZhcglzZWxQcm9kSWQ7IC8vIHRvIHN0b3JlIHNlbGVjdGVkIHByb2QNCnZhciBzZWxQcm9kUXR5OyAvLyBUbyBzdG9yZSBzZWwgcHJvZHVjdCBxdHkNCnZhciBzZWxGcm9tU2l0ZUlEOw0KdmFyIHNlbEZyb21TdGF0dXM7DQp2YXIgc2VsRnJvbVBTSUQgPSIiOyAvL0ZpbmQgYW5kIHN0b3JlIFMgaWQgaW4gdGhpcyB2YXIsIFVzZWQgd2hpbGUgcmV0dXJuaW5nIHJlc3VsdHMNCnZhciBzZWxUb1NpdGVJRDsNCnZhciBzZWxUb1N0YXR1czsNCnZhciBzZWxUb1BTSUQgPSIiOyAvL0ZpbmQgYW5kIFN0b3JlIGluIHRoaXMgVmFyLCBVc2VkIHdoaWxlIHJldHVybmluZyByZXN1bHRzDQp2YXIgZnJvbVNlcmlhbHM7DQp2YXIgdG9TZXJpYWxzOw0KdmFyIHNlbFZhbGlkUHJvZEluZGV4OyAvL3RvIHN0b3JlIHRoZSBJbmRleCBvZiBEaXNwbGF5ZWQgUHJvZHVjdA0KdmFyIGV4Y1F0eUVyckRpc3BsYXllZCA9IGZhbHNlOyAvLyBUbyBUcmFjayBlcnIgc2hvdWxkIGJlIGRpc3BsYXkgb25seSBvbmNlIG9uIG11bHRpcGxlIE1vdmVzLyBxdWljay1BZGQgb2YgU04gDQp2YXIgdkVyciA9IiI7IC8vdG8gU3RvcmUgdGhlIEVyciBNc2cgb24gU2VyaWFsIE5vIFVuaXF1ZW5lc3MNCnZhciB2RXJyTGlzdCA9IiI7IC8vdG8gU3RvcmUgZGV0YWlscyBvZiBMaW5lIEl0ZW1zIChTbm8gLUR1cGxpY2F0ZXMpDQp2YXIgdlF0eUVyciA9IiI7DQp2YXIgdlF0eUVyckxpc3QgPSAiIjsNCnZhciB0b3RTTnJlcSA9IDA7DQp2YXIgbGFzdERyYXduSW5kZXg7DQp2YXIgdkFwaVNlc3Npb25JZDsNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfUHJvY2Vzc1NlcmlhbFNlbGVjdGlvbihjUHJvZFF0eUFyLCBjVHJhbnNhY3Rpb25UeXBlLCBjVHJhbnNhY3Rpb25OdW1iZXIsIGNVc2VySWQpIA0Kew0KICAgIHZjdXJyZGF0ZSA9IG5ldyBEYXRlKCk7IA0KICAgIHZQcm9kUXR5QXIgPSBjUHJvZFF0eUFyOw0KICAgIHZUcmFuc2FjdGlvblR5cGUgPSBjVHJhbnNhY3Rpb25UeXBlOw0KICAgIHZUcmFuc2FjdGlvbk51bWJlciA9IGNUcmFuc2FjdGlvbk51bWJlcjsgDQogICAgdlVzZXJJZCA9Y1VzZXJJZDsNCiAgICB0b3RTTnJlcSA9IDA7DQogICAgLy9sb29wIElucHV0IEFycmF5IGFuZCBjYWxjIHRvdGFsIFNOIHJlcS4NCiAgICBmb3IgKHZhciBhPTA7IGE8dlByb2RRdHlBci5sZW5ndGg7IGErKykNCiAgICB7DQoJICAgIGlmICh2UHJvZFF0eUFyW2FdWzFdKSB7CXRvdFNOcmVxICs9ICAgcGFyc2VJbnQodlByb2RRdHlBclthXVsxXSk7fQ0KICAgIH0NCiAgICB0b1NlcmlhbHMgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkocGFyc2VJbnQodG90U05yZXEpLDMpOw0KICAgIGlzRmlyc3RUaW1lRHJhd24gPSBmYWxzZTsNCg0KDQogICAgaWYgKFNWTVhJX3NTZWxfZ2V0U2VydmljZU1heFNldHRpbmdzKCkgPT0gdHJ1ZSkNCgl7DQoJaWYgKCB2RW5JbnZlbnRvcnkgPT0gImZhbHNlIiB8fCB2RW5TZXJpYWxUcmFja2luZyA9PSAiZmFsc2UiICkgLy9DaGVjayBpZiBJbnZlbnRvcnkgTW9kdWxlICYgU2VyaWFsVHJhY2tpbmcgaXMgZW5hYmxlZA0KCSAgICB7CQkJCQkNCgkgICAgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCSAgICBTVk1YSV9zU2VsX2J1aWxkUmVzdWx0QXJyYXkoZmFsc2UpOw0KCSAgICAvL3JldHVybiB0cnVlOw0KCSAgICB9DQoJZWxzZSAvL0luaXRpYXRlIFNlcmlhbCBTZWxlY3Rpb24NCgkgICAgew0KCSAgICBpZiAoIFNWTVhJX3NTZWxfdmFsaWRhdGVJbnB1dHMoKSA9PSB0cnVlKQ0KCQl7DQoJCWlmIChhdGxlYXN0T25lVmFsaWRQcm9kRm91bmQgPT0gZmFsc2UpIA0KCQkgICAgeyAJCQkJCQkNCgkJICAgIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCgkJICAgIFNWTVhJX3NTZWxfYnVpbGRSZXN1bHRBcnJheShmYWxzZSk7IA0KCQkgICAgfQ0KCQllbHNlIA0KCQkgICAgew0KCQkgICAgdmFyIGxlbkZyb21TTiA9MDsgLy9EZWZpbmluZyBTaXplIG9mIEZyb20gU2VyaWFsDQoJCSAgICBmb3IgKHZhciB6PTA7IHo8dmFsaWRQcm9kQXIubGVuZ3RoO3orKykNCgkJCXsJCQkJDQoJCQlpZih2YWxpZFByb2RBclt6XVswXSAhPSAiIikNCgkJCSAgICB7DQoJCQkgICAgbGVuRnJvbVNOICs9IHBhcnNlSW50KFNWTVhJX3NTZWxfZ2V0RnJvbVNOY291bnQodmFsaWRQcm9kQXJbel1bMF0sdmFsaWRQcm9kQXJbel1bM10sdmFsaWRQcm9kQXJbel1bMl0pKTsgDQoJCQkgICAgfQ0KCQkJfQ0KCQkJZnJvbVNlcmlhbHMgPSAgU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KGxlbkZyb21TTiwyKTsJCQkJCQkNCgkJCS8vLy8gRXh0cmFjdCBzZXJpYWwgTm9zIGZvciBBbGwgUHJvZHVjdHMgaW4gVmFsaWRBcnJheSBhbmQgRHJhdyBwYWdlLg0KCQkJZm9yICh2YXIgej0wOyB6PHZhbGlkUHJvZEFyLmxlbmd0aDt6KyspDQoJCQkgICAgew0KCQkJICAgIHNlbFByb2RJZCA9IHZhbGlkUHJvZEFyW3pdWzBdOyAvL1Byb2R1Y3QgaW4gVmFsaWQgQXJyYXkgDQoJCQkgICAgc2VsUHJvZFF0eSA9IHZhbGlkUHJvZEFyW3pdWzFdOyAvL1Byb2R1Y3QncyBRdWFudGl0eSBpbiBWYWxpZCBBcnJheSANCgkJCSAgICBzZWxGcm9tU2l0ZUlEID0gdmFsaWRQcm9kQXJbel1bMl07DQoJCQkgICAgc2VsRnJvbVN0YXR1cyA9IHZhbGlkUHJvZEFyW3pdWzNdOw0KCQkJICAgIHNlbFRvU2l0ZUlEID0gdmFsaWRQcm9kQXJbel1bNF07DQoJCQkgICAgc2VsVG9TdGF0dXMgPSB2YWxpZFByb2RBclt6XVs1XTsJCQkJCQkNCgkJCSAgICBpZiAodmFsaWRQcm9kQXJbel1bMF0gIT0gIiIpDQoJCQkJew0KCQkJCVNWTVhJX3NTZWxfY2hlY2tJZkV4aXN0SW5QUyh2YWxpZFByb2RBclt6XVswXSx2YWxpZFByb2RBclt6XVszXSx2YWxpZFByb2RBclt6XVsyXSkgLy8oc2VsUHJvZElkLHNlbEZyb21TdGF0dXMsc2VsRnJvbVNpdGVJRCk7IAkJLy8vL2dldCBjdXJyZW50IHN0b2NrIGluIEZyb20gU2l0ZSBhbmQgRnJvbSBTdGF0dXMgKFNWTVhDX19RdWFudGl0eTJfX2MgZnJvbSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYykuIA0KCQkJCX0NCgkJCSAgICB9DQoJCQlzZWxWYWxpZFByb2RJbmRleCA9IDA7DQoJCQlzZWxQcm9kSWQgPSB2YWxpZFByb2RBcltzZWxWYWxpZFByb2RJbmRleF1bMF07IC8vUHJvZHVjdCBpbiBWYWxpZCBBcnJheSANCgkJCXNlbFByb2RRdHkgPSB2YWxpZFByb2RBcltzZWxWYWxpZFByb2RJbmRleF1bMV07IC8vUHJvZHVjdCdzIFF1YW50aXR5IGluIFZhbGlkIEFycmF5IA0KCQkJc2VsRnJvbVNpdGVJRCA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVsyXTsNCgkJCXNlbEZyb21TdGF0dXMgPSB2YWxpZFByb2RBcltzZWxWYWxpZFByb2RJbmRleF1bM107DQoJCQlzZWxUb1NpdGVJRCA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVs0XTsNCgkJCXNlbFRvU3RhdHVzID0gdmFsaWRQcm9kQXJbc2VsVmFsaWRQcm9kSW5kZXhdWzVdOw0KCQkJaXNGaXJzdFRpbWVEcmF3biA9IHRydWU7CQkJCQkJDQoJCQlpZiAodG90U05yZXEgPiAwKSAvL0xhdW5jaCBOZXcgV2luZG93IC0gaWYgcmVxIFNOIGNvdW50IGFyZSBtb3JlIHRoYW4gWkVSTw0KCQkJICAgIHsNCgkJCSAgICBzU2VsX29wZW5XaW5IZGwgPSB3aW5kb3cub3BlbiAoIi9zZXJ2bGV0L3NlcnZsZXQuRmlsZURvd25sb2FkP2ZpbGU9IiArIHNTZWxfRG9jSWQgLCJzZWxzZXJpYWwiLCJzdGF0dXM9eWVzLCBsb2NhdGlvbj1ubywgdG9vbGJhcj1ubywgZGlyZWN0b3JpZXM9bm8sIHJlc2l6YWJsZT15ZXMsIHdpZHRoPTY1MCwgaGVpZ2h0PTYwMCwgc2Nyb2xsYmFycz15ZXMiKTsNCgkJCSAgICB9DQoJCQllbHNlIHtTVk1YSV9zU2VsX2J1aWxkUmVzdWx0QXJyYXkoZmFsc2UpO30NCgkJICAgIH0NCgkJfQ0KCSAgICBlbHNlIA0KCQl7IA0KCQkvL1NWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiRXJyb3IgaW4gR2l2ZW4gSW5wdXQgUGFyYW1ldGVycyEiKTsgDQoJCVNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCgkJU1ZNWElfc1NlbF9idWlsZFJlc3VsdEFycmF5KGZhbHNlKTsNCgkJfQkJDQoJICAgIH0NCgl9DQogICAgZWxzZSANCgl7IAkJCQ0KCVNWTVhJX3NTZWxfYnVpbGRSZXN1bHRBcnJheShmYWxzZSk7DQoJfQkJDQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2dldEZyb21TTmNvdW50KHByb2RJZCwgc3QsIHNpdGUpDQp7DQoJdmFyIHNvcWwgPSAiU2VsZWN0IElkLCBOYW1lLCBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyAgIiA7DQoJc29xbCA9IHNvcWwgKyAiIEZyb20gU1ZNWENfX1Byb2R1Y3RfU2VyaWFsX19jICI7DQoJc29xbCA9IHNvcWwgKyAiIFdIRVJFIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19yLlNWTVhDX19TdGF0dXNfX2MgPSAnIiArIHN0ICsgIiciOw0KCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX3IuU1ZNWENfX1Byb2R1Y3RfX2MgPSAnIiArIHByb2RJZCArICInIjsNCglzb3FsID0gc29xbCArICIgQW5kIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19yLlNWTVhDX19Mb2NhdGlvbl9fYyA9ICciICsgc2l0ZSArICInIjsNCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbCk7IAkNCgl0cnkNCgl7DQoJCXZhciBxclBTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KCQlpZiAocXJQUyAmJiBxclBTLnNpemUgPiAwKSAvLyBQUyBSZWNvcmQgRXhpc3QNCgkJeyANCgkJCXJldHVybiBxclBTLnNpemU7DQoJCX0gDQoJCWVsc2UgeyByZXR1cm4gMDsgfSAvLy8vIFBTIFJlY29yZCBOb3QgRXhpc3QNCgl9IA0KCWNhdGNoKGUpIA0KCXsNCgkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkgc1NlbF9vcGVuV2luSGRsLlNWTVhJX3NTZWxfc2hvd0Vycm9yTG9nKCk7DQoJfQ0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9jaGVja0lmRXhpc3RJblBTKHByb2RJZCwgc3QsIHNpdGUpDQp7DQoJdmFyIHNvcWwgPSAiU2VsZWN0IElkLFNWTVhDX19RdWFudGl0eTJfX2MsICBTVk1YQ19fU3RhdHVzX19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX0xvY2F0aW9uX19jICIgOw0KCXNvcWwgPSBzb3FsICsgIiBGcm9tIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICI7DQoJc29xbCA9IHNvcWwgKyAiIFdIRVJFIFNWTVhDX19TdGF0dXNfX2MgPSAnIiArIHN0ICsgIiciOw0KCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX1Byb2R1Y3RfX2MgPSAnIiArIHByb2RJZCArICInIjsNCglzb3FsID0gc29xbCArICIgQW5kIFNWTVhDX19Mb2NhdGlvbl9fYyA9ICciICsgc2l0ZSArICInIjsNCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbCk7IAkNCgl0cnkNCgl7DQoJCXZhciBxclBTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KCQlpZiAocXJQUyAmJiBxclBTLnNpemUgPiAwKSAvLyBQUyBSZWNvcmQgQWxyZWFkeSBFeGlzdA0KCQl7IA0KCQkJdmFyIHJlY3NQUyA9IHFyUFMuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQlmcm9tUHJvZElkSW5QUyA9IHJlY3NQU1swXS5JZDsgDQoJCQlmcm9tUHJvZEluUFNxdHkgPSByZWNzUFNbMF0uU1ZNWENfX1F1YW50aXR5Ml9fYzsgDQoJCQkvL2lmIChmcm9tUHJvZEluUFNxdHkgPiAwICkgLy8gUmVjb3JkIGZvdW5kIGluIFBTIGFuZCBIYXMgUXR5OiBHZXQgU2VyaWFsIE5vIEFycmF5IEZpbGxlZA0KCQkJLy97DQoJCQkJdmFyIGdldFNOID0gIFNWTVhJX3NTZWxfZ2V0RXhpc3RpbmdTZXJpYWwoZnJvbVByb2RJZEluUFMscHJvZElkKSAvL2Zyb21Qcm9kSWRJblBTOiBJZCBJcyBvZiBjb3JyZXNwb25kaW5nIFJlYyBmb3VuZCBpbiBQUw0KCQkJLy99DQoJCQkvL2lzRnJvbVByb2RFeGlzdEluUFMgPSB0cnVlOw0KCQl9IA0KCX0gDQoJY2F0Y2goZSkgDQoJew0KCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQp2YXIgc25Db3VudCA9IDA7Ly9UbyBTdG9yZSB0b3RhbCBGb3VuZCBTTiBmb3IgYWxsIHZhbGlkIHByb2RzDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2dldEV4aXN0aW5nU2VyaWFsKHBzSWQscHJvZElkKQ0Kew0KCXZhciBzb3FsU04gPSAiU2VsZWN0IE5hbWUgRnJvbSBTVk1YQ19fUHJvZHVjdF9TZXJpYWxfX2MiIDsNCglzb3FsU04gPSBzb3FsU04gKyAiIFdoZXJlIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jID0gJyIgKyBwc0lkICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU04pOyAJDQoJLy9hbGVydChzb3FsU04pOw0KCXRyeQ0KCQl7DQoJCQl2YXIgcXJTTiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxTTik7IA0KCQkJaWYgKHFyU04uc2l6ZSA+IDApIA0KCQkJeyANCgkJCQl2YXIgcmVjc1NOID0gcXJTTi5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCQlmb3IgKHZhciBrPTA7IGsgPCBxclNOLnNpemU7IGsrKykNCgkJCQl7DQoJCQkJCWZyb21TZXJpYWxzW3NuQ291bnRdWzBdID0gcHJvZElkOw0KCQkJCQlmcm9tU2VyaWFsc1tzbkNvdW50XVsxXSA9IHJlY3NTTltrXS5OYW1lOw0KCQkJCQlzbkNvdW50Kys7DQoJCQkJCS8vZnJvbVNlcmlhbHNba11bMl0gPSBwc0lkOw0KCQkJCQkvL2Zyb21TZXJpYWxzLnB1c2gocmVjc1NOW2tdLk5hbWUpOyANCgkJCQl9DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9IA0KCQkJZWxzZSB7cmV0dXJuIHRydWU7fQ0KCQl9IA0KCQljYXRjaChlKSANCgkJewkJCQkgDQoJCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCQkgc1NlbF9vcGVuV2luSGRsLlNWTVhJX3NTZWxfc2hvd0Vycm9yTG9nKCk7DQoJCX0NCg0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9pc1NlcmlhbGl6ZWRQcm9kKHByb2RJZCkNCnsNCgl2YXIgc29xbFByb2QgPSAiU2VsZWN0IE5hbWUsU1ZNWENfX0VuYWJsZV9TZXJpYWxpemVkX1RyYWNraW5nX19jICAgZnJvbSBQcm9kdWN0MiAiIDsNCglzb3FsUHJvZCA9IHNvcWxQcm9kICsgIiBXSEVSRSBJZCA9ICciICsgcHJvZElkICsgIiciOw0KCXNvcWxQcm9kID0gc29xbFByb2QgKyAiIEFuZCBTVk1YQ19fRW5hYmxlX1NlcmlhbGl6ZWRfVHJhY2tpbmdfX2MgPSB0cnVlIjsNCg0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsUHJvZCk7IAkNCgl0cnkNCgl7DQoJCXZhciBxclByb2QgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsUHJvZCk7IA0KCQlpZiAocXJQcm9kLnNpemUgPiAwKSANCgkJeyANCgkJCXJldHVybiB0cnVlOyANCgkJfQ0KCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCX0gDQoJY2F0Y2goZSkgDQoJewkJCSANCgkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkgc1NlbF9vcGVuV2luSGRsLlNWTVhJX3NTZWxfc2hvd0Vycm9yTG9nKCk7DQoJfQ0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KdmFyIHRvU05jb3VudCA9MDsNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfdmFsaWRhdGVTTih2YWwsc25FbnRyeVR5cGUpIC8vTG9naWMgdG8gdmFsaWRhdGUgaGUgZ2l2ZW4gU2VyaWFsIE5vIFVOSVFVRU5FU1MNCnsJDQoJaWYoIFNWTVhJX3NTZWxfaWZFeGNlZWRUaGVRdHkoKSA9PSBmYWxzZSkgLy8gbG9naWMgdG8gdmVyaWZ5IGlmIGV4Y2VzcyBTTiBhcmUgbm90IHNlbGVjdGVkIHRoYW4gcmVxdWlyZWQgZm9yIGVhY2ggcHJvZHVjdCBhbmQgc2FtZSBpcyBub3QgYWRkZWQgVHdpY2UNCgl7DQoJCWlmICggU1ZNWElfc1NlbF91bmlxbmVzc0NoZWNrT25lU04odmFsKSA9PSB0cnVlKQ0KCQl7DQoJCQl0b1NlcmlhbHNbdG9TTmNvdW50XVswXSA9IHNlbFByb2RJZDsJCQkNCgkJCXRvU2VyaWFsc1t0b1NOY291bnRdWzFdID0gdmFsOw0KCQkJdG9TZXJpYWxzW3RvU05jb3VudF1bMl0gPSBzbkVudHJ5VHlwZTsNCgkJCXRvU05jb3VudCsrOw0KCQkJcmV0dXJuIHRydWU7DQoJCX0NCgkJZWxzZSB7cmV0dXJuIGZhbHNlO30NCgl9DQoJZWxzZSBpZiAoZXhjUXR5RXJyRGlzcGxheWVkID09IGZhbHNlKSAvL0ZvciBlYWNoIFByb2Qgb25jZSwgYXMgUXVpY2stQWRkIGNhbiBsYXVuY2ggbXVsdGlsZSBhZGRpdGlvbg0KCQkgew0KCQkJc1NlbF9vcGVuV2luSGRsLmFsZXJ0KFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KCQkJZXhjUXR5RXJyRGlzcGxheWVkID0gdHJ1ZTsNCgkJCXJldHVybiBmYWxzZTsNCgkJIH0gDQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQp2YXIgc1NlbF9Tb2Z0VW5pcUVycjEgPSAiIjsNCnZhciBzU2VsX1NvZnRVbmlxRXJyTGlzdDEgPSAiIjsNCnZhciB2RXJyMSA9ICIiOw0KZnVuY3Rpb24gU1ZNWElfc1NlbF91bmlxbmVzc0NoZWNrT25lU04oc24pIC8vTG9naWMgdG8gdmFsaWRhdGUgdGhlIGdpdmVuIFNlcmlhbCBObyBVTklRVUVORVNTDQp7CQ0KdmFyIHJlc3VsdCA9IHRydWU7DQpmb3IgKHZhciBiPTA7IGI8dG9TZXJpYWxzLmxlbmd0aDtiKyspIC8vbG9vcCB0b1NlcmlhbCBhbmQgcnVuIHVuaXF1ZW5lc3NjaGVjayBmb3IgZWFjaCBzbiANCnsNCglpZiAodG9TZXJpYWxzW2JdWzBdICE9ICIiICYmIHRvU2VyaWFsc1tiXVsxXSAhPSAiIikNCgl7DQoJCXZhciByZXMgPSAgU1ZNWElfc1NlbF9pZkl0ZW1FeGlzdEluQXJyYXkoc24pOw0KCQlpZiAoIHJlcyA9PSBmYWxzZSApIHt9Ly9pZiBEdXBsaWNhdGUgU25vIE5PVCBGb3VuZCBkbyBub3RoaW5nDQoJCWVsc2UgLy9EdXBsaWNhdGUgU25vIEZvdW5kDQoJCXsNCgkJCWlmICh2RW5TZXJpYWxVbmlxdWVuZXNzID09ICJTdHJpY3QiICkgLy9TZXJ2aWNlTWF4IFNldHRpbmdzIGZvciBVbmlxdWVuZXNzIENoZWNrDQoJCQl7DQoJCQkJdkVycjEgPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiI7IA0KCQkJCXZFcnIxICs9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA4IikgKyBzbiArICJcbiI7IC8vICsgIiB7IiArIFNWTVhJX3NTZWxfZ2V0UHJvZHVjdERldGFpbHMoc2VsUHJvZElkKSArICJ9IFxuIjsNCgkJCQlyZXN1bHQgPSBmYWxzZTsJDQoJCQl9DQoJCQlpZiAodkVuU2VyaWFsVW5pcXVlbmVzcyA9PSAiU29mdCIgKQ0KCQkJew0KCQkJCXNTZWxfU29mdFVuaXFFcnIxID0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDkiKSsiXG4iOyANCgkJCQlyZXN1bHQgPSB0cnVlOwkNCgkJCX0NCgkJCQlpZiAodkVuU2VyaWFsVW5pcXVlbmVzcyA9PSAiTm9uZSIgfHwgdkVuU2VyaWFsVW5pcXVlbmVzcyA9PSAiIiB8fCB2RW5TZXJpYWxVbmlxdWVuZXNzID09IG51bGwgfHwgdkVuU2VyaWFsVW5pcXVlbmVzcy5sZW5ndGggPCAxKQ0KCQkJCXsNCgkJCQkJcmVzdWx0ID0gdHJ1ZTsJDQoJCQkJfQ0KCQkJfQ0KCQl9Ly9JZiBDbG9zZSA6dG9TZXJpYWwgQXJyYXkNCgl9Ly9Gb3IgQ2xvc2UgLXRvU2VyaWFsIEFycmF5DQoNCglpZiAodkVycjEubGVuZ3RoID4gMCl7c1NlbF9vcGVuV2luSGRsLmFsZXJ0KHZFcnIxKTt9DQoJcmV0dXJuIHJlc3VsdDsNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfYnVpbGRSZXN1bHRBcnJheShyZXMpIC8vTG9naWMgdG8gdmFsaWRhdGUgdGhlIGdpdmVuIFNlcmlhbCBObyBVTklRVUVORVNTDQp7CQ0KCXZhciByZXN1bHRBciA9IG5ldyBBcnJheSgpOw0KCWlmKHJlcyAhPSBudWxsKQ0KCXsNCgkJcHJvZFJlc3VsdEFyID0gIFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShwYXJzZUludCh0b3RTTnJlcSksOCk7DQoJCXZhciB2YWxpZFJlY0luQXIgPTA7DQoJCWZvciAodmFyIGo9MDsgajx0b1NlcmlhbHMubGVuZ3RoO2orKykgLy9sb29wIHRvU2VyaWFsIGZvciBlYWNoIHZhbGlkIGVudHJ5IGluIGFycmF5DQoJCXsNCgkJCWlmKHRvU2VyaWFsc1tqXVswXSAhPSAiIikNCgkJCXsNCgkJCQl2YWxpZFJlY0luQXIrKw0KCQkJfQ0KCQl9CQkNCgkJdmFyIHBJZCA9ICIiOw0KCQl2YXIgY3VyclBJRCA9IiI7DQoJCXZhciByID0wOyAvL3Jlc3VsdCBDb3VudA0KCQlpZiAocmVzID09IHRydWUpDQoJCXsgDQoJCQlmb3IgKHZhciBqPTA7IGo8dG9TZXJpYWxzLmxlbmd0aDtqKyspIC8vbG9vcCB0b1NlcmlhbCBmb3IgZWFjaCBzZWxlY3RlZCBzbiANCgkJCXsNCgkJCQlpZih0b1NlcmlhbHNbal1bMF0gIT0gIiIgJiYgdG9TZXJpYWxzW2pdWzFdICE9ICIiKQ0KCQkJCXsNCgkJCQkJcElkID0gdG9TZXJpYWxzW2pdWzBdOw0KCQkJCQlpZiAocElkICE9IGN1cnJQSUQpIC8vVG8gZW5mb3JjZSwgUFNJRCByZXRyaXZhbCBzaG91bGQgaGFwcGVuIG9ubHkgT05DRSBmb3IgZWFjaCBwcm9kdWN0IGluIGFycmF5DQoJCQkJCXsJDQoJCQkJCQljdXJyUElEID0gcElkOw0KCQkJCQkJLy9maW5kIGZyb20gJiBUbzogIFNpdGUgLCBTdGF0dXMgZnJvbSB2YWxpZCBwcm9kIGFycg0KCQkJCQkJZm9yICh2YXIgeD0wOyB4PHZhbGlkUHJvZEFyLmxlbmd0aDt4KyspIC8vbG9vcCB0b1NlcmlhbCBmb3IgZWFjaCBzZWxlY3RlZCBzbiANCgkJCQkJCXsNCgkJCQkJCQlpZihjdXJyUElEID09IHZhbGlkUHJvZEFyW3hdWzBdKQ0KCQkJCQkJCXsNCgkJCQkJCQkJc2VsRnJvbVNpdGVJRCA9IHZhbGlkUHJvZEFyW3hdWzJdOw0KCQkJCQkJCQlzZWxGcm9tU3RhdHVzID0gdmFsaWRQcm9kQXJbeF1bM107DQoJCQkJCQkJCXNlbFRvU2l0ZUlEID0gdmFsaWRQcm9kQXJbeF1bNF07DQoJCQkJCQkJCXNlbFRvU3RhdHVzID0gdmFsaWRQcm9kQXJbeF1bNV07DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQkJc2VsRnJvbVBTSUQgPSAgU1ZNWElfc1NlbF9nZXRQU0lESWZFeGlzdChjdXJyUElELHNlbEZyb21TdGF0dXMsc2VsRnJvbVNpdGVJRCk7DQoJCQkJCQlzZWxUb1BTSUQgPSAgU1ZNWElfc1NlbF9nZXRQU0lESWZFeGlzdChjdXJyUElELHNlbFRvU3RhdHVzLHNlbFRvU2l0ZUlEKTsNCgkJCQkJfQ0KCQkJCQlwcm9kUmVzdWx0QXJbcl1bMF0gPSB0b1NlcmlhbHNbal1bMF07IC8vUHJvZHVjdElkDQoJCQkJCXByb2RSZXN1bHRBcltyXVsxXSA9IHNlbEZyb21TaXRlSUQ7IA0KCQkJCQlwcm9kUmVzdWx0QXJbcl1bMl0gPSBzZWxGcm9tU3RhdHVzOyANCgkJCQkJcHJvZFJlc3VsdEFyW3JdWzNdID0gc2VsRnJvbVBTSUQ7DQoJCQkJCXByb2RSZXN1bHRBcltyXVs0XSA9IHNlbFRvU2l0ZUlEOyANCgkJCQkJcHJvZFJlc3VsdEFyW3JdWzVdID0gc2VsVG9TdGF0dXM7IA0KCQkJCQlwcm9kUmVzdWx0QXJbcl1bNl0gPSBzZWxUb1BTSUQ7DQoJCQkJCXByb2RSZXN1bHRBcltyXVs3XSA9IHRvU2VyaWFsc1tqXVsxXTsgLy9zbiBubw0KCQkJCQlyKys7DQoJCQkJfQ0KCQkJfQkJDQoJCQlyZXN1bHRBclswXSA9IHJlczsgLy8gVHJ1ZS9mYWxzZQ0KCQkJcmVzdWx0QXJbMV0gPSB2YWxpZFJlY0luQXI7IC8vUmVjb3JkIGNvdW50IG9mIHRvdGFsIG51bWJlciBvZiBzZXJpYWxzIHNlbGVjdGVkIGZvciBzYXZlCQkJDQoJCQlyZXN1bHRBclsyXSA9IHByb2RSZXN1bHRBcjsNCgkJfQ0KCQllbHNlIC8vIFJldHVybiBUUlVFIHdpdGggY291bnQgWmVybw0KCQl7DQoJCQlyZXN1bHRBclswXSA9IHRydWU7IC8vIFRydWUvZmFsc2UNCgkJCXJlc3VsdEFyWzFdID0gMDsgLy9SZWNvcmQgY291bnQgb2YgdG90YWwgbnVtYmVyIG9mIHNlcmlhbHMgc2VsZWN0ZWQgZm9yIHNhdmUgWkVSTw0KCQkJcmVzdWx0QXJbMl0gPSBzU2VsX3Byb2Nlc3NMb2c7DQoJCX0NCgl9DQoJZWxzZQ0KCXsNCgkJcmVzdWx0QXJbMF0gPSBmYWxzZTsgLy8gVHJ1ZS9mYWxzZSBpZiBXaW5kb3cgQ2FuY2VsZWQgdGhhbiBTZW5kIEZBTFNFDQoJCXJlc3VsdEFyWzFdID0gMDsgLy9SZWNvcmQgY291bnQgb2YgdG90YWwgbnVtYmVyIG9mIHNlcmlhbHMgc2VsZWN0ZWQgZm9yIHNhdmUgWkVSTw0KCQlyZXN1bHRBclsyXSA9ICJDYW5jZWxsZWQiOw0KCX0NCg0KCSBTVk1YSV9zU2VsX1NlcmlhbFNlbGVjdGlvblJlc3VsdHMocmVzdWx0QXIsdlRyYW5zYWN0aW9uVHlwZSk7IC8vIHRoaXMgTWV0aG9kIE1VU1QgYmUgYXZhaWxhYmxlIGluIENhbGxpbmctQ2xpZW50LCBPbiBTdWJtaXQvQ2FuY2VsIGJ0biBjbGljayBpbiBTZXJpYWwtVXRpbGl0IFRISVMgd2lsbCBiZSBjYWxsZWQgDQoJCS8vYWxlcnQoIlJlc3VsdDpcbiIgKyByZXN1bHRBci50b1N0cmluZygpICk7DQoJCS8vd2luZG93LmNsb3NlKCk7DQoJCS8vcmV0dXJuICJTdWNjZXNzIjsNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfdW5pcW5lc3NDaGVja0FsbFNOKCkgLy9Mb2dpYyB0byB2YWxpZGF0ZSBoZSBnaXZlbiBTZXJpYWwgTm8gVU5JUVVFTkVTUw0KewkNCgl2YXIgcmVzdWx0ID0gdHJ1ZTsNCglmb3IgKHZhciBhPTA7IGE8dmFsaWRQcm9kQXIubGVuZ3RoO2ErKykgLy9Mb29wIFZhbGlkIFByb2R1Y3RzIGFycmF5IGFuZCBydW4gVW5pcXVuZXNzIGNoZWNrIGZvciBlYWNoIHByb2QNCgl7DQoJCWlmICh2YWxpZFByb2RBclthXVswXSAhPSAiIikNCgkJew0KCQkJdmFyIHByb2RJZCA9IHZhbGlkUHJvZEFyW2FdWzBdOw0KCQkJZm9yICh2YXIgYj0wOyBiPHRvU2VyaWFscy5sZW5ndGg7YisrKSAvL2xvb3AgdG9TZXJpYWwgYW5kIHJ1biB1bmlxdWVuZXNzY2hlY2sgZm9yIGVhY2ggc24gDQoJCQl7DQoJCQkJaWYgKHRvU2VyaWFsc1tiXVswXSAhPSAiIiAmJiB0b1NlcmlhbHNbYl1bMF0gPT0gcHJvZElkICYmIHRvU2VyaWFsc1tiXVsxXSAhPSAiIikNCgkJCQl7DQoJCQkJCXZhciBzbiA9IHRvU2VyaWFsc1tiXVsxXTsNCgkJCQkJaWYgKFNWTVhJX3NTZWxfaWZTTmlzRHVwbGljYXRlKHNuLHByb2RJZCkpIC8vaWYgRHVwbGljYXRlIFNubyBGb3VuZA0KCQkJCQl7DQoJCQkJCQlpZiAodkVuU2VyaWFsVW5pcXVlbmVzcyA9PSAiU3RyaWN0IiApIC8vU2VydmljZU1heCBTZXR0aW5ncyBmb3IgVW5pcXVlbmVzcyBDaGVjaw0KCQkJCQkJew0KCQkJCQkJCXZFcnIgPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiI7IA0KCQkJCQkJCXZFcnJMaXN0ICs9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA4IikrIHNuICsgIiB7IiArICBTVk1YSV9zU2VsX2dldFByb2R1Y3REZXRhaWxzKHByb2RJZCkgKyAifSBcbiI7DQoJCQkJCQkJcmVzdWx0ID0gZmFsc2U7CQ0KCQkJCQkJfQ0KCQkJCQkJaWYgKHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gIlNvZnQiICkNCgkJCQkJCXsNCgkJCQkJCQl2RXJyID0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDkiKSsiXG4iOyANCgkJCQkJCQl2RXJyTGlzdCArPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwOCIpICsgc24gKyAiIHsiICsgIFNWTVhJX3NTZWxfZ2V0UHJvZHVjdERldGFpbHMocHJvZElkKSArICJ9IFxuIjsNCgkJCQkJCQlyZXN1bHQgPSB0cnVlOwkNCgkJCQkJCX0NCgkJCQkJCWlmICh2RW5TZXJpYWxVbmlxdWVuZXNzID09ICJOb25lIiB8fCB2RW5TZXJpYWxVbmlxdWVuZXNzID09ICIiIHx8IHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gbnVsbCB8fCB2RW5TZXJpYWxVbmlxdWVuZXNzLmxlbmd0aCA8IDEpDQoJCQkJCQl7DQoJCQkJCQkJcmVzdWx0ID0gdHJ1ZTsJDQoJCQkJCQl9DQoJCQkJCX0NCgkJCQl9Ly9JZiBDbG9zZSA6dG9TZXJpYWwgQXJyYXkNCgkJCX0vL0ZvciBDbG9zZSAtdG9TZXJpYWwgQXJyYXkNCgkJfSAvL0lGIENsb3NlIC1WYWxpZCBwcm9kIGFycmF5DQoJfS8vRm9yIGNsb3NlIDogdmFsaWQgcHJvZCBBcnJheQ0KDQoJcmV0dXJuIHJlc3VsdDsNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfaWZTTmlzRHVwbGljYXRlKHNObywgcHJvZElkKQ0Kew0KCS8vQ2hlY2sgaWYgdGhlIGNvbWJpbmF0aW9uIG9mIHNlcmlhbCBudW1iZXIgYW5kIHByb2R1Y3QgbnVtYmVyIGlzIHByZXNlbnQgaW4gU1ZNWElfUHJvZHVjdF9TZXJpYWxfX2Mgb2JqZWN0DQoJdmFyIHNvcWxTTiA9ICJTZWxlY3QgTmFtZSwgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jLCIgOw0KCXNvcWxTTiArPSAiIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19yLlNWTVhDX19Mb2NhdGlvbl9fYyxTVk1YQ19fUHJvZHVjdF9TdG9ja19fci5TVk1YQ19fU3RhdHVzX19jIjsNCglzb3FsU04gKz0gIiBmcm9tIFNWTVhDX19Qcm9kdWN0X1NlcmlhbF9fYyAiIDsNCglzb3FsU04gKz0gIiBXaGVyZSBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcHJvZElkICsgIiciOyANCglzb3FsU04gKz0gIiBBbmQgTmFtZSA9ICciICsgc05vICsgIiciOw0KCXNvcWxTTiArPSAiIEFuZCBTVk1YQ19fUHJvZHVjdF9TdG9ja19fci5TVk1YQ19fU3RhdHVzX19jICE9ICdTY3JhcCcgIjsNCglzb3FsU04gKz0gIiBBbmQgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX3IuU1ZNWENfX0xvY2F0aW9uX19jICE9ICciICsgc2VsRnJvbVNpdGVJRCArICInIjsNCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFNOKTsgCQ0KCXRyeQ0KCQl7DQoJCQl2YXIgcXJTTiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxTTik7IA0KCQkJaWYgKHFyU04uc2l6ZSA+IDApIA0KCQkJeyANCgkJCQkvL0R1cGxpY2F0ZSBmb3VuZCANCgkJCQlyZXR1cm4gdHJ1ZTsgDQoJCQl9DQoJCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCQl9IA0KCQljYXRjaChlKSANCgkJew0KCQkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpKyBlKTsNCgkJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgkJfQ0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF92YWxpZGF0ZVNlbFNOcXR5KCkgLy8gVGhpcyBDaGVja3MgZm9yIEFsbCBwcm9kdWN0cyBpbiBWYWxpZCBBcnJheQ0Kew0KCXZhciByZXN1bHQgPSB0cnVlOw0KCS8vTG9vcCBWYWxpZCBQcm9kdWN0cyBhcnJheSBhbmQgZmluZCBDaGVjayBSZXEgU04gcXR5IGlzIHByb3ZpZGVkDQoJZm9yICh2YXIgYT0wOyBhPHZhbGlkUHJvZEFyLmxlbmd0aDthKyspDQoJew0KCQlpZiAodmFsaWRQcm9kQXJbYV1bMF0gIT0gIiIpDQoJCXsNCgkJCS8vMS5jaGVjayBpZiB0aGUgbnVtYmVyIG9mIHNlcmlhbCBudW1iZXJzIGVudGVyZWQgbWF0Y2hlcyB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkgZm9yIGFsbCBwcm9kdWN0cw0KCQkJdmFyIHByb2QgPSB2YWxpZFByb2RBclthXVswXTsNCgkJCXZhciByZXFTTmNvdW50ICA9IHZhbGlkUHJvZEFyW2FdWzFdOyAvL2ZvciBTZWxlY3QgUHJvZHVjdCANCgkJCXZhciBzZWxTTmNvdW50ID0gMDsNCg0KCQkJZm9yICh2YXIgej0wOyB6PHRvU2VyaWFscy5sZW5ndGg7eisrKQ0KCQkJew0KCQkJCWlmICh0b1NlcmlhbHNbel1bMF0gPT0gcHJvZCAmJiB0b1NlcmlhbHNbel1bMV0gIT0gIiIpeyBzZWxTTmNvdW50Kys7fQ0KCQkJfQ0KCQkJaWYgKHNlbFNOY291bnQgIT0gcmVxU05jb3VudCApIA0KCQkJew0KCQkJCXZRdHlFcnIgPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxMCIpOwkvLyJUaGUgbnVtYmVyIG9mIHNlcmlhbCBudW1iZXJzIHlvdSBlbnRlcmVkIGRvZXMgbm90IG1hdGNoIHRoZSByZWNlaXZlZCBxdWFudGl0eS4iOw0KCQkJCXZRdHlFcnJMaXN0ICs9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDExIikgKyAnICcgKyBTVk1YSV9zU2VsX2dldFByb2R1Y3REZXRhaWxzKHByb2QpICsgIlxuIjsNCgkJCQlyZXN1bHQgPSBmYWxzZTsNCgkJCX0NCgkJfQkJCQ0KCX0JCQ0KCXJldHVybiByZXN1bHQ7DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2lmRXhjZWVkVGhlUXR5KCkgLy9UaGlzIGNoZWNrcyBGb3IgU2VsZWN0ZWQgcHJvZHVjdCBPTkxZDQp7DQoJLy9BZGQgTG9naWMgdG8gdmVyaWZ5IHRoZSBzZWxlY3RlZCBjb3VudCBvZiBTTiBhZ2FpbnN0IFF0eQ0KCXZhciByZXFTTmNvdW50ICA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVsxXTsgLy9mb3IgU2VsZWN0IFByb2R1Y3QgDQoJdmFyIHNlbFNOY291bnQgPTA7DQoJZm9yICh2YXIgej0wOyB6PHRvU2VyaWFscy5sZW5ndGg7eisrKQ0KCXsNCgkJaWYgKHRvU2VyaWFsc1t6XVswXSA9PSBzZWxQcm9kSWQgJiYgdG9TZXJpYWxzW3pdWzFdICE9ICIiKXsgc2VsU05jb3VudCsrO30NCgl9DQoJaWYgKHNlbFNOY291bnQgPCByZXFTTmNvdW50ICkge3JldHVybiBmYWxzZTt9IC8vTm90IGV4Y2VlZGVkDQoJZWxzZSB7cmV0dXJuIHRydWU7fSAvL2V4Y2VlZCB0aGUgYWxsb3dlZCBsaW1pdA0KfQ0KDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2lmSXRlbUV4aXN0SW5BcnJheSh2YWxUb0ZpbmQpDQp7DQoJdmFyIHJlc3VsdCA9IGZhbHNlOw0KCXZhciBhciA9IHRvU2VyaWFsczsNCglmb3IgKHZhciB6PTA7IHo8YXIubGVuZ3RoO3orKykNCgl7DQoJCWlmIChhclt6XVsxXSA9PSB2YWxUb0ZpbmQgKSAvL2FyW3pdWzBdID09IHNlbFByb2RJZCAmJiANCgkJeyANCgkJcmVzdWx0ID0gdHJ1ZTsNCgkJfQ0KCX0NCglyZXR1cm4gcmVzdWx0Ow0KfQ0KDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX3ZhbGlkYXRlSW5wdXRzKCkNCnsNCglhdGxlYXN0T25lVmFsaWRQcm9kRm91bmQgPSBmYWxzZTsNCgl2YXIgeCA9MDsNCglmb3IgKHZhciBpPTA7IGk8dlByb2RRdHlBci5sZW5ndGg7IGkrKykgDQoJICAgIHsJDQoJICAgIGlmICh2UHJvZFF0eUFyW2ldWzBdLnRvU3RyaW5nKCkgIT0gIiIpDQoJCXsNCgkJaWYgKFNWTVhJX3NTZWxfaXNTZXJpYWxpemVkUHJvZCh2UHJvZFF0eUFyW2ldWzBdKSA9PSB0cnVlKQ0KCQkgICAgew0KCQkgICAgYXRsZWFzdE9uZVZhbGlkUHJvZEZvdW5kID0gdHJ1ZTsNCgkJICAgIHggPSB4KzE7DQoJCSAgICB9DQoJCX0NCgkgICAgfQ0KDQoJCS8vLy9Gb3IgZWFjaCBwcm9kdWN0IGluIHRoZSBpbnB1dCBhcnJheSxjaGVjayBpZiBTVk1YQ19fU2VyaWFsaXplZF9UcmFja2luZ19fYyBpcyB0cnVlIGluIFByb2R1Y3QyIG9iamVjdA0KCXZhbGlkUHJvZEFyID0gIFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheSh4LCA2KTsgDQoJeD0wOw0KCWZvciAodmFyIGk9MDsgaTx2UHJvZFF0eUFyLmxlbmd0aDsgaSsrKSANCgkgICAgew0KCSAgICBpZiAodlByb2RRdHlBcltpXVswXS50b1N0cmluZygpICE9ICIiKQ0KCQl7DQoJCWlmICggU1ZNWElfc1NlbF9pc1NlcmlhbGl6ZWRQcm9kKHZQcm9kUXR5QXJbaV1bMF0pID09IHRydWUpIC8vLy9QdXNoIFZhbGlkIFNlcmlhbGl6ZWQgcHJvZHVjdCB0byBuZXcgYXJyYXkuDQoJCSAgICB7DQoJCSAgICB2YWxpZFByb2RBclt4XVswXSA9IHZQcm9kUXR5QXJbaV1bMF07DQoJCSAgICB2YWxpZFByb2RBclt4XVsxXSA9IHBhcnNlSW50KHZQcm9kUXR5QXJbaV1bMV0pOw0KCQkgICAgdmFsaWRQcm9kQXJbeF1bMl0gPSB2UHJvZFF0eUFyW2ldWzJdOw0KCQkgICAgdmFsaWRQcm9kQXJbeF1bM10gPSB2UHJvZFF0eUFyW2ldWzNdOw0KCQkgICAgdmFsaWRQcm9kQXJbeF1bNF0gPSB2UHJvZFF0eUFyW2ldWzRdOw0KCQkgICAgdmFsaWRQcm9kQXJbeF1bNV0gPSB2UHJvZFF0eUFyW2ldWzVdOw0KCQkgICAgeCA9IHgrMTsNCgkJICAgIH0NCgkJfQ0KCSAgICB9DQoJLy8vLy8gRlJPTSAvL0NoZWNrIGlmIGEgcmVjb3JkIGV4aXN0cyBmb3IgdGhlIGdpdmVuIHByb2R1Y3QsIHRvIHNpdGUgYW5kIHRvIHN0YXR1cyBjb21iaW5hdGlvbiBpbiBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyBvYmplY3QNCgkvL3ZhciB2RnJvbVBTSUQgPSAgU1ZNWElfc1NlbF9nZXRQU0lESWZFeGlzdChwcm9kSWQsdkZyb21TdGF0dXMsdkZyb21TaXRlSUQpOw0KDQoJLy8vLy8gVE8gLy9DaGVjayBpZiBhIHJlY29yZCBleGlzdHMgZm9yIHRoZSBnaXZlbiBwcm9kdWN0LCBmcm9tIHNpdGUgYW5kIGZyb20gc3RhdHVzIGNvbWJpbmF0aW9uIGluIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIG9iamVjdA0KCS8vdmFyIHZUb1BTSUQgPSAgU1ZNWElfc1NlbF9nZXRQU0lESWZFeGlzdChwcm9kSWQsdlRvU3RhdHVzLHZUb1NpdGVJRCk7DQoNCglyZXR1cm4gdHJ1ZTsJCQkNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfZ2V0U2VydmljZU1heFNldHRpbmdzKCkNCnsNCgl2YXIgc29xbFNTID0gIlNlbGVjdCBTVk1YQ19fRW5hYmxlX0ludmVudG9yeV9Nb2R1bGVfX2MsIFNWTVhDX19FbmFibGVfU2VyaWFsX1RyYWNraW5nX19jLFNWTVhDX19DaGVja19TZXJpYWxfVW5pcXVlbmVzc19fYyAgICIgOw0KCXNvcWxTUyA9IHNvcWxTUyArICIgRnJvbSBTVk1YQ19fU2VydmljZU1heF9TZXR0aW5nc19fYyAgIjsNCgkJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxTUyk7IAkNCgkJdHJ5DQoJCXsNCgkJCXZhciBxclNTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFNTKTsgDQoJCQlpZiAocXJTUy5zaXplID4gMCkgLy8gU2V0dGluZ3MgRm91bmQNCgkJCXsgDQoJCQkJdmFyIHJlY3NTUyA9IHFyU1MuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQkJdkVuSW52ZW50b3J5ID0gcmVjc1NTWzBdLlNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYzsgDQoJCQkJdkVuU2VyaWFsVHJhY2tpbmcgPSByZWNzU1NbMF0uU1ZNWENfX0VuYWJsZV9TZXJpYWxfVHJhY2tpbmdfX2M7DQoJCQkJdkVuU2VyaWFsVW5pcXVlbmVzcyA9IHJlY3NTU1swXS5TVk1YQ19fQ2hlY2tfU2VyaWFsX1VuaXF1ZW5lc3NfX2M7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9IA0KCQkJZWxzZSB7dkVuSW52ZW50b3J5ID0gZmFsc2U7IHZFblNlcmlhbFRyYWNraW5nID0gZmFsc2U7IHZFblNlcmlhbFVuaXF1ZW5lc3MgPSBmYWxzZTsgcmV0dXJuIHRydWU7fQ0KCQl9DQoJCWNhdGNoKGUpIA0KCQl7DQoJCQlTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgkJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfaXNTTkluRnJvbUxpc3QobmV3U04pIC8vVGhpcyBjaGVja3MgRm9yIFNlbGVjdCBwcm9kdWN0IE9OTFkNCnsNCgl2YXIgcmVzdWx0ID0gZmFsc2U7DQoJZm9yICh2YXIgej0wOyB6PGZyb21TZXJpYWxzLmxlbmd0aDt6KyspDQoJew0KCQlpZiAoKGZyb21TZXJpYWxzW3pdWzFdID09IG5ld1NOKSAmJiAoZnJvbVNlcmlhbHNbel1bMF0gIT0gIiIpICYmIChmcm9tU2VyaWFsc1t6XVsxXSAhPSAiIikpDQoJCXsgDQoJCQlyZXN1bHQgPSB0cnVlOyAvL25ld1NOIGFscmVhZHkgZXhpc3RzIGluIEZyb21TZXJpYWxzIExpc3QNCgkJfQ0KCX0NCglyZXR1cm4gcmVzdWx0OyANCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfZ2V0UFNJRElmRXhpc3QocHJvZElkLCBzdCwgc2l0ZSkNCnsNCgl2YXIgc29xbCA9ICJTZWxlY3QgSWQsU1ZNWENfX1F1YW50aXR5Ml9fYywgIFNWTVhDX19TdGF0dXNfX2MsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fTG9jYXRpb25fX2MgIiA7DQoJc29xbCA9IHNvcWwgKyAiIEZyb20gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIjsNCglzb3FsID0gc29xbCArICIgV0hFUkUgU1ZNWENfX1N0YXR1c19fYyA9ICciICsgc3QgKyAiJyI7DQoJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcHJvZElkICsgIiciOw0KCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX0xvY2F0aW9uX19jID0gJyIgKyBzaXRlICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsKTsgCQ0KCXZhciByZXN1bHQgPSAiIjsNCgl0cnkNCgl7DQoJCXZhciBxclBTID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KCQlpZiAocXJQUyAmJiBxclBTLnNpemUgPiAwKSAvLyBQUyBSZWNvcmQgQWxyZWFkeSBFeGlzdA0KCQl7IA0KCQkJdmFyIHJlY3NQUyA9IHFyUFMuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQlyZXN1bHQgPSByZWNzUFNbMF0uSWQ7IA0KCQl9IA0KCQllbHNlIHsgcmVzdWx0ID0gIiI7IH0gLy8vLyBQUyBSZWNvcmQgTm90IEV4aXN0DQoJcmV0dXJuIHJlc3VsdDsNCgl9IA0KCWNhdGNoKGUpIA0KCXsNCgkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpKyBlKTsgDQoJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2dldFByb2R1Y3REZXRhaWxzKHByb2RJZCkNCnsNCgl2YXIgc29xbFByb2QgPSAiU2VsZWN0IE5hbWUgZnJvbSBQcm9kdWN0MiAiIDsNCglzb3FsUHJvZCA9IHNvcWxQcm9kICsgIiBXSEVSRSBJZCA9ICciICsgcHJvZElkICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsUHJvZCk7IAkNCgl0cnkNCgkJew0KCQkJdmFyIHFyUHJvZCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxQcm9kKTsgDQoJCQlpZiAocXJQcm9kLnNpemUgPiAwKSANCgkJCXsgDQoJCQkJdmFyIHJlY3NQcm9kID0gcXJQcm9kLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCXZQcm9kID0gcmVjc1Byb2RbMF0uTmFtZTsgDQoJCQkJcmV0dXJuIHZQcm9kOw0KCQkJfSANCgkJCWVsc2Uge3ZQcm9kID0gIiI7cmV0dXJuIHZQcm9kO30NCgkJfSANCgkJY2F0Y2goZSkgDQoJCXsNCgkJCSBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKSArIGUpOw0KCQkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCQl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9nZXRTaXRlRGV0YWlscyhzaXRlSWQpDQp7DQoJdmFyIHNvcWxTaXRlID0gIlNlbGVjdCBOYW1lIGZyb20gU1ZNWENfX1NpdGVfX2MgIiA7DQoJc29xbFNpdGUgPSBzb3FsU2l0ZSArICIgV0hFUkUgSWQgPSAnIiArIHNpdGVJZCArICInIjsNCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFNpdGUpOyAJDQoJdHJ5DQoJCXsNCgkJCXZhciBxclNpdGUgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsU2l0ZSk7IA0KCQkJaWYgKHFyU2l0ZS5zaXplID4gMCkgDQoJCQl7IA0KCQkJCXZhciByZWNzU2l0ZSA9IHFyU2l0ZS5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCQl2YXIgdkxvY2F0aW9uID0gcmVjc1NpdGVbMF0uTmFtZTsgDQoJCQkJcmV0dXJuIHZMb2NhdGlvbjsNCgkJCX0gDQoJCQllbHNlIHt2TG9jYXRpb24gPSAiIjsgcmV0dXJuIHZMb2NhdGlvbjt9DQoNCgkJfSANCgkJY2F0Y2goZSkgDQoJCXsNCgkJCSBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKSArIGUpOw0KCQkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCQl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vDQpmdW5jdGlvbiBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoaVJvd3MsaUNvbHMpIA0KeyANCgkvL2FsZXJ0KGlSb3dzICsgIjoiICtpQ29scyk7DQoJdmFyIGk7IA0KCXZhciBqOyANCgl2YXIgYSA9IG5ldyBBcnJheShpUm93cyk7IA0KCWZvciAoaT0wOyBpIDwgaVJvd3M7IGkrKykgDQoJeyANCgkJYVtpXSA9IG5ldyBBcnJheShpQ29scyk7IA0KCQlmb3IgKGo9MDsgaiA8IGlDb2xzOyBqKyspIA0KCQl7IA0KICAgICAgICAgICBhW2ldW2pdID0gIiI7IA0KCQl9IA0KCX0gDQogICByZXR1cm4oYSk7IA0KfSANCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhNc2cpIA0KeyANCglpZiAoc1NlbF9wcm9jZXNzTG9nKSB7IHNTZWxfcHJvY2Vzc0xvZyArPSAgIlxuIjsgfSANCglzU2VsX3Byb2Nlc3NMb2cgKz0gTXNnOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9zU2VsX0luaXRNZXNzYWdlTGlzdChzdWJtb2R1bGVpZCkNCnsNCiAgICB2YXIgZm91bmQgPSBmYWxzZTsNCg0KICAgIHZhciBMYW5nTGlzdCA9IG5ldyBBcnJheSgpOw0KDQogICAgCQkvLyBIYXNoIChNYXApIG9mIFNGREMgbGFuZ3VhZ2UgSVNPIGNvZGUgdG8gTGFuZ3VhZ2UgcGlja2xpc3QgaW4gU2VydmljZU1heCB0YWdzIG9iamVjdA0KICAgIExhbmdMaXN0WyJlbl9VUyJdID0gIkVuZ2xpc2giOw0KICAgIExhbmdMaXN0WyJkZSJdID0gIkdlcm1hbiI7DQogICAgTGFuZ0xpc3RbImVzIl0gPSAiU3BhbmlzaCI7DQogICAgTGFuZ0xpc3RbImZyIl0gPSAiRnJlbmNoIjsNCiAgICBMYW5nTGlzdFsiaXQiXSA9ICJJdGFsaWFuIjsNCiAgICBMYW5nTGlzdFsiamEiXSA9ICJKYXBhbmVzZSI7DQogICAgTGFuZ0xpc3RbInN2Il0gPSAiU3dlZGlzaCI7DQogICAgTGFuZ0xpc3RbImtvIl0gPSAiS29yZWFuIjsNCiAgICBMYW5nTGlzdFsiemhfVFciXSA9ICJDaGluZXNlIChUcmFkaXRpb25hbCkiOw0KICAgIExhbmdMaXN0WyJ6aF9DTiJdID0gIkNoaW5lc2UgKFNpbXBsaWZpZWQpIjsNCiAgICBMYW5nTGlzdFsicHRfQlIiXSA9ICJQb3J0dWd1ZXNlIChCcmF6aWxpYW4pIjsNCiAgICBMYW5nTGlzdFsibmxfTkwiXSA9ICJEdXRjaCI7DQogICAgTGFuZ0xpc3RbImRhIl0gPSAiRGFuaXNoIjsNCiAgICBMYW5nTGlzdFsidGgiXSA9ICJUaGFpIjsNCiAgICBMYW5nTGlzdFsiZmkiXSA9ICJGaW5uaXNoIjsNCiAgICBMYW5nTGlzdFsicnUiXSA9ICJSdXNzaWFuIjsNCg0KICAgIHZhciBVc2VyTGFuZyA9IHNmb3JjZS5jb25uZWN0aW9uLmdldFVzZXJJbmZvKCkudXNlckxhbmd1YWdlOwkvLyBJU08gY29kZSBvZiB0aGUgdXNlcidzIGxhbmd1YWdlDQoNCiAgICBpZiAoIUxhbmdMaXN0W1VzZXJMYW5nXSkgeyBVc2VyTGFuZyA9ICJFbmdsaXNoIjsgfQkJLy8gaWYgdXNlcidzIGxhbmd1YWdlIGlzIG5vdCBmb3VuZCwgZGVmYXVsdCBpdCB0byBFbmdsaXNoDQogICAgZWxzZSB7IFVzZXJMYW5nID0gTGFuZ0xpc3RbVXNlckxhbmddOyB9DQoNCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQsIE5hbWUsIFNWTVhDX19UYWdfVGV4dF9fYywgU1ZNWENfX0xhbmd1YWdlX19jICIgKw0KICAgIAkJIkZST00gU1ZNWENfX1NlcnZpY2VNYXhfVGFnc19fYyAiICsNCgkJIldIRVJFIFNWTVhDX19TdWJtb2R1bGVJRF9fYyA9ICciICsgc3VibW9kdWxlaWQgKyAiJyAiICsNCgkJIkFORCBTVk1YQ19fTGFuZ3VhZ2VfX2MgSU4gKCdNYXN0ZXInLCAnIiArIFVzZXJMYW5nICsgIicpIjsNCiAgICB2YXIgcXIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsNCiAgICB2YXIgdGFncmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcik7DQogICAgd2hpbGUgKHRhZ3JlY3MuaGFzTmV4dCgpKQ0KICAgIAl7DQogICAgICAgIHZhciB0YWdyZWMgPSB0YWdyZWNzLm5leHQoKTsNCgl2YXIgVGFnSWQgPSB0YWdyZWMuTmFtZTsNCgl2YXIgVGFnVGV4dCA9IHRhZ3JlYy5TVk1YQ19fVGFnX1RleHRfX2M7DQoJdmFyIExhbmcgPSB0YWdyZWMuU1ZNWENfX0xhbmd1YWdlX19jOw0KCWlmIChMYW5nID09ICJNYXN0ZXIiICYmICFzU2VsX01zZ0xpc3RbVGFnSWRdKQ0KCSAgICBzU2VsX01zZ0xpc3RbVGFnSWRdID0gVGFnVGV4dDsNCgllbHNlIGlmIChMYW5nID09IFVzZXJMYW5nICYmIFRhZ1RleHQgJiYgVGFnVGV4dC5sZW5ndGggPiAwKQkvLyBUcmFuc2xhdGlvbiBhdmFpbGFibGUgaW4gdGhlIHNwZWNpZmljIGxhbmd1YWdlDQoJICAgIHNTZWxfTXNnTGlzdFtUYWdJZF0gPSBUYWdUZXh0Ow0KDQoJZm91bmQgPSB0cnVlOw0KCX0NCg0KICAgIGlmICghZm91bmQpDQoJew0KCXNTZWxfTXNnTGlzdFsnTEFCMDAwJ10gPSAnU2VydmljZU1heDogU2VyaWFsIFNlbGVjdGlvbic7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDEnXSA9ICdTZXJpYWwgTnVtYmVyIFNlbGVjdGlvbic7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDInXSA9ICdBZGQnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDUnXSA9ICc8ICAgUHJldic7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDYnXSA9ICdOZXh0ICA+JzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1aWNrIEFkZCc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDgnXSA9ICdUcmFuc2FjdGlvbiBUeXBlOiAgJzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwOSddID0gJ1Byb2R1Y3Q6ICAnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDEwJ10gPSAnUmVxdWlyZWQgUXVhbnRpdHk6ICAnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDExJ10gPSAnICAgICAgIC0tTm9uZS0tICAgICAgICAnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDEyJ10gPSAnRnJvbSBMb2NhdGlvbjonOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDEzJ10gPSAnVG8gTG9jYXRpb246JzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAxNCddID0gJ1N0YXR1czonOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDE1J10gPSAnUmVtb3ZlJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDAzJ10gPSAnSW52ZW50b3J5IE1vZHVsZSBvciBTZXJpYWxpemVkIFRyYWNraW5nIG9mIGludmVudG9yeSBpcyBub3QgZW5hYmxlZCBpbiB5b3VyIG9yZ2FuaXphdGlvbic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFNlcnZpY2VNYXggdHJhbnNhY3Rpb24gZGlkIG5vdCBoYXZlIGFueSBzZXJpYWxpemVkIHByb2R1Y3RzIHRvIHByb2Nlc3MuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwNSddID0gJ1RoZXJlIHdhcyBhbiBpbnRlcm5hbCBlcnJvciBpbiBkYXRhIHNlbnQgZnJvbSB0aGUgcGFyZW50IFNlcnZpY2VNYXggdHJhbnNhY3Rpb24uIFBsZWFzZSByZXBvcnQgdGhpcyB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwNiddID0gJ1lvdSBoYXZlIGFscmVhZHkgZW50ZXJlZCB0aGUgcmVxdWlyZWQgbnVtYmVyIG9mIHNlcmlhbHMgb3IgdG9vIG1hbnkgc2VyaWFsIG51bWJlcnMgc2VsZWN0ZWQuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwNyddID0gJ0R1cGxpY2F0ZSBzZXJpYWwgbnVtYmVycyBhcmUgbm90IGFsbG93ZWQuIFBsZWFzZSBjb3JyZWN0IHlvdXIgZW50cmllcyBhbmQgY2xpY2sgU3VibWl0IGFnYWluLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMDgnXSA9ICdEdXBsaWNhdGUgU2VyaWFsIE51bWJlcjonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDA5J10gPSAnRHVwbGljYXRlIHNlcmlhbCBudW1iZXJzIGZvdW5kLiBUaGlzIGlzIG5vdCBhbiBlcnJvci4gSG93ZXZlciwgcGxlYXNlIHZlcmlmeSBhbmQgY29uZmlybSB5b3VyIGVudHJpZXMgYXJlIGFjY3VyYXRlIGFuZCBjbGljayBTdWJtaXQgYWdhaW4uJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxMCddID0gJ1RoZSBudW1iZXIgb2Ygc2VyaWFsIG51bWJlcnMgeW91IGVudGVyZWQgZG9lcyBub3QgbWF0Y2ggdGhlIHJlY2VpdmVkIHF1YW50aXR5Lic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTEnXSA9ICdOb3QgZW5vdWdoIHNlcmlhbCBudW1iZXJzIHNlbGVjdGVkIGZvciB0aGlzIHByb2R1Y3Q6ICc7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTInXSA9ICdUaGUgZm9sbG93aW5nIHRyYW5zYWN0aW9uIGhhcyByZXN1bHRlZCBpbiBhIG5lZ2F0aXZlIHN0b2NrIHF1YW50aXR5LiBQbGVhc2UgdmVyaWZ5IHRoYXQgeW91ciBvcmdhbml6YXRpb24gZm9sbG93cyB0aGUgbmVjZXNzYXJ5IHByb2Nlc3NlcyB0byBtYWludGFpbiBpbnRlZ3JpdHkgb2Ygc3RvY2sgaW5mb3JtYXRpb24gaW4gU2VydmljZU1heC4gSWYgeW91ciBvcmdhbml6YXRpb24gaXMgZnVsbHkgY29tcGxpYW50IHdpdGggdGhlIHByb2Nlc3MgcmVxdWlyZW1lbnRzLCByZXBvcnQgdGhpcyBpc3N1ZSB0byBTZXJ2aWNlTWF4IHN1cHBvcnQgaW1tZWRpYXRlbHkuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxMyddID0gJ0FuIG9jY3VycmVkIHdoZW4gc2VuZGluZyBlbWFpbCBhYm91dCBuZWdhdGl2ZSBzdG9jay4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDE0J10gPSAnRW1haWwgYWJvdXQgbmVnYXRpdmUgc3RvY2sgY291bGQgbm90IGJlIHNlbnQgZHVlIHRvIGluc3VmZmljaWVudCBpbmZvcm1hdGlvbi4gUGxlYXNlIHJlcG9ydCB0aGlzIHRvIHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTUnXSA9ICdUcmFuc2FjdGlvbiBUeXBlOiAgJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxNiddID0gJ1RyYW5zYWN0aW9uIE51bWJlcjonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDE3J10gPSAnUHJvZHVjdDogICc7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTgnXSA9ICdMb2NhdGlvbjonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDE5J10gPSAnU3RhdHVzOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjAnXSA9ICdRdWFudGl0eSBCZWZvcmU6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyMSddID0gJ1RyYW5zYWN0aW9uIFF1YW50aXR5Oic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjInXSA9ICdRdWFudGl0eSBBZnRlcjonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDIzJ10gPSAnU2VydmljZU1heCBVc2VyOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjQnXSA9ICdEYXRlL1RpbWU6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyNSddID0gJ0Vycm9yOiBJbnZhbGlkIERhdGEuPGJyLz5SZXZpZXcgYWxsIGVycm9yIG1lc3NhZ2VzIGJlbG93IHRvIGNvcnJlY3QgeW91ciBkYXRhLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjYnXSA9ICdUaGlzIGlzIHRoZSBGaXJzdCBSZWNvcmQnOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDI3J10gPSAnVGhpcyBpcyB0aGUgTGFzdCBSZWNvcmQnOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDI4J10gPSAnUGxlYXNlIGVudGVyIGEgdmFsaWQgbmV3IHNlcmlhbCBudW1iZXIsIFByb3ZpZGVkIHNlcmlhbCBudW1iZXIgYWxyZWFkeSBleGlzdHMgb24gdGhlIGxpc3QuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyOSddID0gJ1BsZWFzZSBlbnRlciBhIHZhbGlkIHNlcmlhbCBudW1iZXIgYW5kIG51bWJlciBvZiBzZXJpYWxzIGZpcnN0Lic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMzAnXSA9ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBzZXJpYWwgbnVtYmVyJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAzMSddID0gJ0Vycm9yOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMzInXSA9ICdQbGVhc2Ugc2VsZWN0IG9uZSBvciBtb3JlIHNlcmlhbCBudW1iZXJzLic7DQoJc1NlbF9Nc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX3NTZWxfR2V0TWVzc2FnZShNc2dOdW0pDQp7DQogICAgaWYgKCFzU2VsX01zZ0xpc3RbTXNnTnVtXSkNCglyZXR1cm4gIk1lc3NhZ2UgZGVmaW5pdGlvbiBmb3IgIiArIE1zZ051bSArICIgbm90IGZvdW5kLiBUaGlzIGlzIGEgc2V0dXAgaXNzdWUuXG5QbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuIjsNCg0KICAgIHJldHVybiBzU2VsX01zZ0xpc3RbTXNnTnVtXTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0K</fileContent>
    <fileName>SVMXC_Library.js</fileName>
    <name>SVMXC_StockLookupSVO</name>
    <supportsCaching>true</supportsCaching>
</Scontrol>
